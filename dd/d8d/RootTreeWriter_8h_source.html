<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Project: /home/travis/build/AliceO2Group/AliceO2/Framework/Utils/include/DPLUtils/RootTreeWriter.h Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../o2_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('dd/d8d/RootTreeWriter_8h_source.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">RootTreeWriter.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../dd/d8d/RootTreeWriter_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Copyright CERN and copyright holders of ALICE O2. This software is</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// distributed under the terms of the GNU General Public License v3 (GPL</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Version 3), copied verbatim in the file &quot;COPYING&quot;.</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// See http://alice-o2.web.cern.ch/license for full licensing information.</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// In applying this license CERN does not waive the privileges and immunities</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// granted to it by virtue of its status as an Intergovernmental Organization</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// or submit itself to any jurisdiction.</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#ifndef FRAMEWORK_ROOTTREEWRITER_H</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#define FRAMEWORK_ROOTTREEWRITER_H</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/dff/RootSerializationSupport_8h.html">Framework/RootSerializationSupport.h</a>&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d6/d5c/InputRecord_8h.html">Framework/InputRecord.h</a>&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/dfb/DataRef_8h.html">Framework/DataRef.h</a>&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;TFile.h&gt;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;TTree.h&gt;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;TBranch.h&gt;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;TClass.h&gt;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;functional&gt;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;stdexcept&gt;</span> <span class="comment">// std::runtime_error</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &lt;type_traits&gt;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &lt;typeinfo&gt;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span>     <span class="comment">// std::make_unique</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &lt;functional&gt;</span> <span class="comment">// std::function</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;utility&gt;</span>    <span class="comment">// std::forward</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span>  <span class="comment">// std::generate</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &lt;variant&gt;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="keyword">namespace </span><a class="code" href="../../d4/d7c/namespaceo2.html">o2</a></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;{</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">namespace </span>framework</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;{</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html">   85</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html">RootTreeWriter</a></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;{</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="comment">// use string as input binding to be used with DPL input API</span></div><div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a629fed161d843ac97804dbca898432da">   89</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a629fed161d843ac97804dbca898432da">key_type</a> = std::string;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="comment">// extract the branch index from DataRef, ~(size_t)) indicates &quot;no data&quot;, then nothing</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="comment">// is extracted from input and writing is skipped</span></div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a8063d0b4bf02205274f1e36ed67c7424">   92</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a8063d0b4bf02205274f1e36ed67c7424">IndexExtractor</a> = std::function&lt;size_t(o2::framework::DataRef const&amp;)&gt;;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="comment">// mapper between branch name and base/index</span></div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a328cb80f5570a55bb8a3f9edf8fbae35">   94</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a328cb80f5570a55bb8a3f9edf8fbae35">BranchNameMapper</a> = std::function&lt;std::string(std::string, size_t)&gt;;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="comment">// a custom callback to close the writer</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="comment">// writing of tree and closing of file need to be implemented, but the pointers</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="comment">// remain owned by the tool</span></div><div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a491e4ddf3c92c927b570e437fe611c5b">   98</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a491e4ddf3c92c927b570e437fe611c5b">CustomClose</a> = std::function&lt;void(TFile* file, TTree* tree)&gt;;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="../../d7/d85/structo2_1_1framework_1_1RootTreeWriter_1_1DefaultKeyExtractor.html">  102</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="../../d7/d85/structo2_1_1framework_1_1RootTreeWriter_1_1DefaultKeyExtractor.html">DefaultKeyExtractor</a> {</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="../../d7/d85/structo2_1_1framework_1_1RootTreeWriter_1_1DefaultKeyExtractor.html#a3144ab6b9292888265d05fabd2d9d2b6">  104</a></span>&#160;    <span class="keyword">static</span> <a class="code" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a629fed161d843ac97804dbca898432da">key_type</a> <a class="code" href="../../d7/d85/structo2_1_1framework_1_1RootTreeWriter_1_1DefaultKeyExtractor.html#a3144ab6b9292888265d05fabd2d9d2b6">asString</a>(<a class="code" href="../../d1/def/classT.html">T</a> <span class="keyword">const</span>&amp; arg)</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    {</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <span class="keywordflow">return</span> arg;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    }</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  };</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#aa5239804b66cf8c8e1a5d890aa2bd3cb">  110</a></span>&#160;  <span class="keyword">enum struct</span> <a class="code" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#aa5239804b66cf8c8e1a5d890aa2bd3cb">BranchVerbosity</a> {</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    Quiet,</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    Medium,</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    High,</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  };</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> KeyType = key_type, <span class="keyword">typename</span> KeyExtractor = DefaultKeyExtractor&gt;</div><div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html">  147</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html">BranchDef</a> {</div><div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#a38bd6ba3407423b67eb1e32b721f09fc">  148</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="../../d1/def/classT.html">type</a> = <a class="code" href="../../d1/def/classT.html">T</a>;</div><div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#a6624d13ad6185aac9c4844bd457efccc">  149</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="../../da/d96/structo2_1_1framework_1_1InputSpec.html">key_type</a> = KeyType;</div><div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#ac4d1f2a676e4ca0bc666eb047d8e7d38">  150</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#ac4d1f2a676e4ca0bc666eb047d8e7d38">key_extractor</a> = KeyExtractor;</div><div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#ab6c78c5f3aaf2bf6dd11f2efc9c406d1">  151</a></span>&#160;    std::vector&lt;key_type&gt; <a class="code" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#ab6c78c5f3aaf2bf6dd11f2efc9c406d1">keys</a>;</div><div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#a11176f3e4f282124c79dcd3a276d8b08">  152</a></span>&#160;    std::string <a class="code" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#a11176f3e4f282124c79dcd3a276d8b08">branchName</a>;</div><div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#ab76d205edf83ffc890459f560129463f">  154</a></span>&#160;    <span class="keywordtype">size_t</span> nofBranches = 1;</div><div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#ab3971632106a28658a2b8e075040f94b">  156</a></span>&#160;    <a class="code" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a8063d0b4bf02205274f1e36ed67c7424">IndexExtractor</a> <a class="code" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#ab3971632106a28658a2b8e075040f94b">getIndex</a>; <span class="comment">// = [](o2::framework::DataRef const&amp;) {return 0;}</span></div><div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#a705715003a53820dd3d40b8c1e86000b">  158</a></span>&#160;<span class="comment"></span>    <a class="code" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a328cb80f5570a55bb8a3f9edf8fbae35">BranchNameMapper</a> <a class="code" href="../../d9/df7/ConfigurableParamHelper_8cxx.html#a82d3ab4ac5e230e789bbfccc18d62a90">getName</a> = [](std::string base, <span class="keywordtype">size_t</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>) { <span class="keywordflow">return</span> base + <span class="stringliteral">&quot;_&quot;</span> + std::to_string(<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>); };</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#a72b5aa72217180808f933cf564f104e5">  160</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#a72b5aa72217180808f933cf564f104e5">Fill</a> = std::function&lt;void(TBranch&amp; branch, T const&amp;)&gt;;</div><div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#aa9034d7906f72070d15982ffa90207bb">  161</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#aa9034d7906f72070d15982ffa90207bb">FillExt</a> = std::function&lt;void(TBranch&amp; branch, T const&amp;, DataRef const&amp;)&gt;;</div><div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#ab1ca95e696f31fffa5b84e0980da4fa1">  162</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#ab1ca95e696f31fffa5b84e0980da4fa1">Spectator</a> = std::function&lt;void(T const&amp;)&gt;;</div><div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#a3a6ce7e65b7c7d13e3e41e05e9e035aa">  163</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#a3a6ce7e65b7c7d13e3e41e05e9e035aa">SpectatorExt</a> = std::function&lt;void(T const&amp;, DataRef const&amp;)&gt;;</div><div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#a61d7205863a03a900d70f413e9dba2b7">  164</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#a61d7205863a03a900d70f413e9dba2b7">BranchCallback</a> = std::variant&lt;std::monostate, Fill, FillExt, Spectator, SpectatorExt&gt;;</div><div class="line"><a name="l00165"></a><span class="lineno"><a class="line" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#ae5388722dc2ccdd990e85b321b9c905e">  165</a></span>&#160;    <a class="code" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#a61d7205863a03a900d70f413e9dba2b7">BranchCallback</a> <a class="code" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#ae5388722dc2ccdd990e85b321b9c905e">callback</a>;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#a6e59e4399a5f35aeb571b68ef013ec20">  172</a></span>&#160;    <a class="code" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#a6e59e4399a5f35aeb571b68ef013ec20">BranchDef</a>(<a class="code" href="../../da/d96/structo2_1_1framework_1_1InputSpec.html">key_type</a> key, std::string _branchName, <span class="keywordtype">size_t</span> _nofBranches = 1) : keys({key}), branchName(_branchName), nofBranches(_nofBranches) {}</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span>... Args&gt;</div><div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#a4d2a4d83c290a6517652f97108ccc555">  185</a></span>&#160;    <a class="code" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#a4d2a4d83c290a6517652f97108ccc555">BranchDef</a>(<a class="code" href="../../da/d96/structo2_1_1framework_1_1InputSpec.html">key_type</a> key, std::string _branchName, <span class="keywordtype">size_t</span> _nofBranches, Args&amp;&amp;... args) : keys({key}), branchName(_branchName), nofBranches(_nofBranches)</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    {</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <a class="code" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a6e0b07ea151d37e244b02a9679e16693">init</a>(std::forward&lt;Args&gt;(args)...);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    }</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span>... Args&gt;</div><div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#a0cd17d3f727ab880519fe62570ec143b">  201</a></span>&#160;    <a class="code" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#a0cd17d3f727ab880519fe62570ec143b">BranchDef</a>(std::vector&lt;key_type&gt; vec, std::string _branchName, <span class="keywordtype">size_t</span> _nofBranches, Args&amp;&amp;... args) : keys(vec), branchName(_branchName), nofBranches(_nofBranches)</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    {</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <a class="code" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a6e0b07ea151d37e244b02a9679e16693">init</a>(std::forward&lt;Args&gt;(args)...);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    }</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Arg, <span class="keyword">typename</span>... Args&gt;</div><div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#ae059de16ddd6f18ce68ea62992d5b928">  208</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#ae059de16ddd6f18ce68ea62992d5b928">init</a>(Arg&amp;&amp; arg, Args&amp;&amp;... args)</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    {</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="keyword">using</span> <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a7cb47c18c663b616974d65febeaa1790">Type</a> = std::decay_t&lt;Arg&gt;;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="keywordflow">if</span> constexpr (<a class="code" href="../../dc/da1/structo2_1_1framework_1_1can__assign.html">can_assign&lt;Type, IndexExtractor&gt;::value</a>) {</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        getIndex = arg;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> constexpr (<a class="code" href="../../dc/da1/structo2_1_1framework_1_1can__assign.html">can_assign&lt;Type, BranchNameMapper&gt;::value</a>) {</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        getName = arg;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> constexpr (<a class="code" href="../../dc/da1/structo2_1_1framework_1_1can__assign.html">can_assign&lt;Type, Fill&gt;::value</a>) {</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        callback = arg;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> constexpr (<a class="code" href="../../dc/da1/structo2_1_1framework_1_1can__assign.html">can_assign&lt;Type, FillExt&gt;::value</a>) {</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        callback = arg;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> constexpr (<a class="code" href="../../dc/da1/structo2_1_1framework_1_1can__assign.html">can_assign&lt;Type, Spectator&gt;::value</a>) {</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        callback = arg;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> constexpr (<a class="code" href="../../dc/da1/structo2_1_1framework_1_1can__assign.html">can_assign&lt;Type, SpectatorExt&gt;::value</a>) {</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        callback = arg;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        assertNoMatchingType(std::forward&lt;Arg&gt;(arg));</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      <span class="keywordflow">if</span> constexpr (<span class="keyword">sizeof</span>...(args) &gt; 0) {</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <a class="code" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a6e0b07ea151d37e244b02a9679e16693">init</a>(std::forward&lt;Args&gt;(args)...);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      }</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    }</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">// wrap the non matching type assert into a function to better see type of argument</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">// in the compiler error</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Arg&gt;</div><div class="line"><a name="l00234"></a><span class="lineno"><a class="line" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#ad5d97d8415323be5b5bf799df1e5fd89">  234</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#ad5d97d8415323be5b5bf799df1e5fd89">assertNoMatchingType</a>(Arg&amp;&amp; arg)</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    {</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      static_assert(always_static_assert_v&lt;Arg&gt;, <span class="stringliteral">&quot;no matching function signature for passed object. Please check:\n- Is it a callable object?\n- Does it have correct parameters and return type?\n- Are all type correctly qualified&quot;</span>);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    }</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  };</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <a class="code" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a9ec0c11c34b562c2c4cbcc5cc0c58f3e">RootTreeWriter</a>() = <span class="keyword">delete</span>;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span>... Args&gt;</div><div class="line"><a name="l00248"></a><span class="lineno"><a class="line" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a2d493ee9cfe998ad0fa57b769aadaa14">  248</a></span>&#160;  <a class="code" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a2d493ee9cfe998ad0fa57b769aadaa14">RootTreeWriter</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* filename, <span class="comment">// file name</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                 <span class="keyword">const</span> <span class="keywordtype">char</span>* treename, <span class="comment">// name of the tree to write to</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                 Args&amp;&amp;... args)       <span class="comment">// followed by branch definition</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  {</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    parseConstructorArgs(std::forward&lt;Args&gt;(args)...);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">if</span> (!mTreeStructure) {</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      std::runtime_error(<span class="stringliteral">&quot;Failed to create the branch configuration&quot;</span>);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    }</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">if</span> (filename &amp;&amp; treename) {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <a class="code" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a6e0b07ea151d37e244b02a9679e16693">init</a>(filename, treename);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    }</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  }</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno"><a class="line" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a6e0b07ea151d37e244b02a9679e16693">  267</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a6e0b07ea151d37e244b02a9679e16693">init</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* filename, <span class="keyword">const</span> <span class="keywordtype">char</span>* treename)</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  {</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    mFile = std::make_unique&lt;TFile&gt;(filename, <span class="stringliteral">&quot;RECREATE&quot;</span>);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    mTree = std::make_unique&lt;TTree&gt;(treename, treename);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    mTreeStructure-&gt;setup(mBranchSpecs, mTree.get());</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  }</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno"><a class="line" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#adbca06ba7d2010331d632926d2ae8057">  280</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#adbca06ba7d2010331d632926d2ae8057">setBranchName</a>(<span class="keywordtype">size_t</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a57f14e05b1900f16a2da82ade47d0c6d">index</a>, <span class="keyword">const</span> <span class="keywordtype">char</span>* branchName)</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  {</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keyword">auto</span>&amp; spec = mBranchSpecs.at(index);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordflow">if</span> (spec.names.size() &gt; 1 &amp;&amp; spec.getName) {</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <span class="comment">// set the branch names for this group</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      <span class="keywordtype">size_t</span> idx = 0;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      <a class="code" href="../../d9/d33/namespaceo2_1_1vertexing.html#a39341a4d0a4b5fa9301ff9da8018e177">std::generate</a>(spec.names.begin(), spec.names.end(), [&amp;]() { <span class="keywordflow">return</span> spec.getName(branchName, idx++); });</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      <span class="comment">// single branch for this definition</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      spec.names.at(0) = branchName;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    }</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  }</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ContextType&gt;</div><div class="line"><a name="l00298"></a><span class="lineno"><a class="line" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a0693e202752a97bfb85e45ab1e505fcf">  298</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a0693e202752a97bfb85e45ab1e505fcf">operator()</a>(ContextType&amp;&amp; context)</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  {</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">if</span> (!mTree || !mFile || mFile-&gt;IsZombie()) {</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Writer is invalid state, probably closed previously&quot;</span>);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    }</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="comment">// execute tree structure handlers and fill the individual branches</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    mTreeStructure-&gt;exec(std::forward&lt;ContextType&gt;(context), mBranchSpecs);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">// Note: number of entries will be set when closing the writer</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  }</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno"><a class="line" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#adb8f1fcd217895fcc545d58cb477d0a3">  310</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#adb8f1fcd217895fcc545d58cb477d0a3">close</a>()</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  {</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    mIsClosed = <span class="keyword">true</span>;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">if</span> (!mFile) {</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    }</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordflow">if</span> (mCustomClose) {</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      mCustomClose(mFile.get(), mTree.get());</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <span class="comment">// set the number of elements according to branch content and write tree</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      mTree-&gt;SetEntries();</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      mTree-&gt;Write();</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      mFile-&gt;Close();</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    }</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="comment">// this is a feature of ROOT, the tree belongs to the file and will be deleted</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="comment">// automatically</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    mTree.release();</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    mFile.reset(<span class="keyword">nullptr</span>);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  }</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno"><a class="line" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a05ffdab01163306ee020e0c7b6ee58dc">  330</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a05ffdab01163306ee020e0c7b6ee58dc">isClosed</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">return</span> mIsClosed;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  }</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno"><a class="line" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#ae183f6fa85671d2deb2c6d7ce610348f">  335</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#ae183f6fa85671d2deb2c6d7ce610348f">getStoreSize</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">return</span> (mTreeStructure != <span class="keyword">nullptr</span> ? mTreeStructure-&gt;size() : 0);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  }</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keyword">struct </span>BranchSpec {</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    std::vector&lt;key_type&gt; keys;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    std::vector&lt;std::string&gt; names;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    std::vector&lt;TBranch*&gt; branches;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    TClass* classinfo = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <a class="code" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a8063d0b4bf02205274f1e36ed67c7424">IndexExtractor</a> getIndex;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <a class="code" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a328cb80f5570a55bb8a3f9edf8fbae35">BranchNameMapper</a> <a class="code" href="../../d9/df7/ConfigurableParamHelper_8cxx.html#a82d3ab4ac5e230e789bbfccc18d62a90">getName</a>;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  };</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keyword">using</span> <a class="code" href="../../df/d24/classo2_1_1framework_1_1InputRecord.html">InputContext</a> = <a class="code" href="../../df/d24/classo2_1_1framework_1_1InputRecord.html">InputRecord</a>;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keyword">class </span>TreeStructureInterface</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  {</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;   <span class="keyword">public</span>:</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> STAGE = 0;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    TreeStructureInterface() = <span class="keywordflow">default</span>;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keyword">virtual</span> ~TreeStructureInterface() = <span class="keywordflow">default</span>;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> setup(std::vector&lt;BranchSpec&gt;&amp;, TTree*) {}</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> exec(<a class="code" href="../../df/d24/classo2_1_1framework_1_1InputRecord.html">InputContext</a>&amp;, std::vector&lt;BranchSpec&gt;&amp;) {}</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">size_t</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a3d1e3edfcf61ca2d831883e1afbad89e">size</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> STAGE; }</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="comment">// a dummy method called in the recursive processing</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keywordtype">void</span> setupInstance(std::vector&lt;BranchSpec&gt;&amp;, TTree*) {}</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="comment">// a dummy method called in the recursive processing</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a6fdb9be6f8d9beb8e9275650e658422c">process</a>(<a class="code" href="../../df/d24/classo2_1_1framework_1_1InputRecord.html">InputContext</a>&amp;, std::vector&lt;BranchSpec&gt;&amp;) {}</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  };</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T = <span class="keywordtype">char</span>&gt;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="keyword">using</span> BinaryBranchStoreType = std::tuple&lt;std::vector&lt;T&gt;, TBranch*, <span class="keywordtype">size_t</span>&gt;;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="comment">// type trait to determine the type of the storage</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="comment">// the storage type is different depending on the type, because</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="comment">// - binary branches are supported</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="comment">// - the ROOT TTree API makes a difference between fundamental types where the pointer to variable is</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="comment">//   passed and complex objects with dictionary where the pointer to a pointer variable needs to be</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="comment">//   passed. The former case will allways include a copy of the value, the latter uses the deserialized</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="comment">//   object by pointer</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="comment">// It appears, that also vectors of fundamental and also messageable tyapes can be treated in the same</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="comment">// way as fundamental types, as long as there is a corresponding TClass implementation. ROOT creates those</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="comment">// for vectors of fundamental types, for all other types, ClassDefNV macro is needed in the class</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="comment">// declaration together with entry in LinkDef.</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> _ = <span class="keywordtype">void</span>&gt;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="keyword">struct </span>StructureElementTypeTrait {</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  };</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="keyword">using</span> BinaryBranchSpecialization = std::integral_constant&lt;char, 0&gt;;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="keyword">using</span> MessageableTypeSpecialization = std::integral_constant&lt;char, 1&gt;;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="keyword">using</span> MessageableVectorSpecialization = std::integral_constant&lt;char, 2&gt;;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="keyword">using</span> ROOTTypeSpecialization = std::integral_constant&lt;char, 3&gt;;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="comment">// the binary branch format is chosen for const char*</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="comment">// using internally a vector&lt;char&gt;, this involves for the moment a copy, investigate if ROOT</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="comment">// can write a simple array of chars and use a pointer</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="keyword">struct </span>StructureElementTypeTrait&lt;T, std::<a class="code" href="../../dc/df0/namespacenlohmann_1_1detail.html#a02bcbc878bee413f25b985ada771aa9c">enable_if_t</a>&lt;std::is_same&lt;T, const char*&gt;::value&gt;&gt; {</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keyword">using</span> value_type = T;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keyword">using</span> store_type = BinaryBranchStoreType&lt;char&gt;;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keyword">using</span> specialization_id = BinaryBranchSpecialization;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  };</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="comment">// all messageable types</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="comment">// using an internal variable of the given type, involves a copy</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keyword">struct </span>StructureElementTypeTrait&lt;T, std::<a class="code" href="../../dc/df0/namespacenlohmann_1_1detail.html#a02bcbc878bee413f25b985ada771aa9c">enable_if_t</a>&lt;is_messageable&lt;T&gt;::value&gt;&gt; {</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keyword">using</span> value_type = T;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keyword">using</span> store_type = value_type;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keyword">using</span> specialization_id = MessageableTypeSpecialization;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  };</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="comment">// vectors of messageable types</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="keyword">struct </span>StructureElementTypeTrait&lt;T, std::<a class="code" href="../../dc/df0/namespacenlohmann_1_1detail.html#a02bcbc878bee413f25b985ada771aa9c">enable_if_t</a>&lt;has_messageable_value_type&lt;T&gt;::value &amp;&amp;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                                                       is_specialization&lt;T, std::vector&gt;::value&gt;&gt; {</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keyword">using</span> value_type = T;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keyword">using</span> store_type = value_type*;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keyword">using</span> specialization_id = MessageableVectorSpecialization;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  };</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="comment">// types with root dictionary but non-messageable and not vectors of messageable type</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="keyword">struct </span>StructureElementTypeTrait&lt;T, std::<a class="code" href="../../dc/df0/namespacenlohmann_1_1detail.html#a02bcbc878bee413f25b985ada771aa9c">enable_if_t</a>&lt;has_root_dictionary&lt;T&gt;::value &amp;&amp;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                                                       is_messageable&lt;T&gt;::value == false &amp;&amp;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                                                       has_messageable_value_type&lt;T&gt;::value == false&gt;&gt; {</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keyword">using</span> value_type = T;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keyword">using</span> store_type = value_type*;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keyword">using</span> specialization_id = ROOTTypeSpecialization;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  };</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="comment">// types marked as ROOT serialized</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <span class="keyword">struct </span>StructureElementTypeTrait&lt;T, std::<a class="code" href="../../dc/df0/namespacenlohmann_1_1detail.html#a02bcbc878bee413f25b985ada771aa9c">enable_if_t</a>&lt;is_specialization&lt;T, ROOTSerialized&gt;::value == true&gt;&gt; {</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keyword">using</span> value_type = <span class="keyword">typename</span> T::wrapped_type;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keyword">using</span> store_type = value_type*;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keyword">using</span> specialization_id = ROOTTypeSpecialization;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  };</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DataT, <span class="keyword">typename</span> BASE&gt;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="keyword">class </span>TreeStructureElement : <span class="keyword">public</span> <a class="code" href="../../df/dcb/classBASE.html">BASE</a></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  {</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;   <span class="keyword">public</span>:</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keyword">using</span> PrevT = <a class="code" href="../../df/dcb/classBASE.html">BASE</a>;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keyword">using</span> value_type = <span class="keyword">typename</span> StructureElementTypeTrait&lt;DataT&gt;::value_type;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keyword">using</span> store_type = <span class="keyword">typename</span> StructureElementTypeTrait&lt;DataT&gt;::store_type;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keyword">using</span> specialization_id = <span class="keyword">typename</span> StructureElementTypeTrait&lt;DataT&gt;::specialization_id;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> STAGE = BASE::STAGE + 1;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    TreeStructureElement() = <span class="keywordflow">default</span>;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    ~TreeStructureElement() <span class="keyword">override</span> = <span class="keywordflow">default</span>;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keywordtype">void</span> setup(std::vector&lt;BranchSpec&gt;&amp; specs, TTree* tree)<span class="keyword"> override</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      setupInstance(specs, tree);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    }</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="comment">// this is the polymorphic entry point for processing of branch specs</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="comment">// recursive processing starting from the highest instance</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordtype">void</span> exec(<a class="code" href="../../df/d24/classo2_1_1framework_1_1InputRecord.html">InputContext</a>&amp; context, std::vector&lt;BranchSpec&gt;&amp; specs)<span class="keyword"> override</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a6fdb9be6f8d9beb8e9275650e658422c">process</a>(context, specs);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    }</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a3d1e3edfcf61ca2d831883e1afbad89e">size</a>()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> STAGE; }</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="comment">// the default method creates branch using address to store variable</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="comment">// Note: the type of the store variable is pointer to object for objects with a ROOT TClass</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="comment">// interface, or plain type for all others</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="comment">// specialized on specialization_id</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <a class="code" href="../../dc/da3/glcorearb_8h.html#af5ef68ee1b33850ea6254115a25d0a85">template &lt;typename S, typename std::enable_if_t&lt;!std::is_same&lt;S, BinaryBranchSpecialization&gt;::value</a>, <span class="keywordtype">int</span>&gt; = 0&gt;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    TBranch* createBranch(TTree* tree, <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="../../dc/da3/glcorearb_8h.html#a5c4947d4516dd7cfa3505ce3a648a4ef">name</a>, <span class="keywordtype">size_t</span> branchIdx)</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    {</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="keywordflow">return</span> tree-&gt;Branch(name, &amp;(mStore.at(branchIdx)));</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    }</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="comment">// specialization for binary buffers indicated by const char*</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="comment">// a variable binary data branch is written, the size of each entry is stored in a size branch</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="comment">// specialized on specialization_id</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <a class="code" href="../../dc/da3/glcorearb_8h.html#af5ef68ee1b33850ea6254115a25d0a85">template &lt;typename S, typename std::enable_if_t&lt;std::is_same&lt;S, BinaryBranchSpecialization&gt;::value</a>, <span class="keywordtype">int</span>&gt; = 0&gt;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    TBranch* createBranch(TTree* tree, <span class="keyword">const</span> <span class="keywordtype">char</span>* name, <span class="keywordtype">size_t</span> branchIdx)</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    {</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      <span class="comment">// size variable to write the size of the data branch</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      std::get&lt;2&gt;(mStore.at(branchIdx)) = 1;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <span class="comment">// branch name of the size branch</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      std::string sizeBranchName = std::string(name) + <span class="stringliteral">&quot;Size&quot;</span>;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      <span class="comment">// leaf list: one leaf of type unsinged int</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      std::string leafList = sizeBranchName + <span class="stringliteral">&quot;/i&quot;</span>;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      std::get&lt;1&gt;(mStore.at(branchIdx)) = tree-&gt;Branch(sizeBranchName.c_str(), &amp;(std::get&lt;2&gt;(mStore.at(branchIdx))), leafList.c_str());</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <span class="keywordflow">return</span> tree-&gt;Branch(name, &amp;(std::get&lt;0&gt;(mStore.at(branchIdx))));</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    }</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordtype">void</span> setupInstance(std::vector&lt;BranchSpec&gt;&amp; specs, TTree* tree)</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    {</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <span class="comment">// recursing through the tree structure by simply using method of the previous type,</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <span class="comment">// i.e. the base class method.</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      PrevT::setupInstance(specs, tree);</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      constexpr <span class="keywordtype">size_t</span> SpecIndex = STAGE - 1;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      <span class="keywordflow">if</span> (specs[SpecIndex].branches.size() == 0) {</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <span class="comment">// this definition is disabled</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      }</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      specs[SpecIndex].classinfo = TClass::GetClass(<span class="keyword">typeid</span>(value_type));</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/da3/glcorearb_8h.html#af5ef68ee1b33850ea6254115a25d0a85">std::is_same&lt;value_type, const char*&gt;::value</a> == <span class="keyword">false</span> &amp;&amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#af5ef68ee1b33850ea6254115a25d0a85">std::is_fundamental&lt;value_type&gt;::value</a> == <span class="keyword">false</span> &amp;&amp;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;          specs[SpecIndex].classinfo == <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="comment">// for all non-fundamental types but the special case for binary chunks, a dictionary is required</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="comment">// FIXME: find a reliable way to check that the type has been specified in the LinkDef</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <span class="comment">// Only then the required functionality for streaming the type to the branch is available.</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <span class="comment">// If e.g. a standard container of some ROOT serializable type has not been specified in</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="comment">// LinkDef, the functionality is not available and the attempt to stream will simply crash.</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <span class="comment">// Unfortunately, a class info object can be extracted for the type, so this check does not help</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="keywordflow">throw</span> std::runtime_error(std::to_string(SpecIndex) + <span class="stringliteral">&quot;: no dictionary available for non-fundamental type &quot;</span> + <span class="keyword">typeid</span>(value_type).<a class="code" href="../../dc/da3/glcorearb_8h.html#a5c4947d4516dd7cfa3505ce3a648a4ef">name</a>());</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      }</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      <span class="keywordtype">size_t</span> branchIdx = 0;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      mStore.resize(specs[SpecIndex].names.size());</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; name : specs[SpecIndex].names) {</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        specs[SpecIndex].branches.at(branchIdx) = createBranch&lt;specialization_id&gt;(tree, name.c_str(), branchIdx);</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <span class="keywordflow">if</span> (specs[SpecIndex].branches.at(branchIdx) == <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;          <span class="keywordflow">throw</span> std::runtime_error(std::to_string(SpecIndex) + <span class="stringliteral">&quot;: can not create branch &quot;</span> + name + <span class="stringliteral">&quot; for type &quot;</span> + <span class="keyword">typeid</span>(value_type).<a class="code" href="../../dc/da3/glcorearb_8h.html#a5c4947d4516dd7cfa3505ce3a648a4ef">name</a>() + <span class="stringliteral">&quot; - LinkDef entry missing?&quot;</span>);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        }</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(INFO) &lt;&lt; SpecIndex &lt;&lt; <span class="stringliteral">&quot;: branch  &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; set up&quot;</span>;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        branchIdx++;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      }</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    }</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DataType&gt;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keywordtype">bool</span> runCallback(TBranch* branch, <a class="code" href="../../d3/d28/namespaceo2_1_1tpc_1_1rawreader.html#a44ae0b14f44563124b01abb4e10a119f">DataType</a> <span class="keyword">const</span>&amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>, <a class="code" href="../../d3/da6/structo2_1_1framework_1_1DataRef.html">DataRef</a> <span class="keyword">const</span>&amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#ad32bdec748ba376f6c0d2df39ab9a95b">ref</a>)</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    {</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      <span class="keywordflow">if</span> (std::holds_alternative&lt;<span class="keyword">typename</span> <a class="code" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html">BranchDef&lt;value_type&gt;::Spectator</a>&gt;(mCallback)) {</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        std::get&lt;typename BranchDef&lt;value_type&gt;::Spectator&gt;(mCallback)(data);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      }</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      <span class="keywordflow">if</span> (std::holds_alternative&lt;<span class="keyword">typename</span> <a class="code" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html">BranchDef&lt;value_type&gt;::SpectatorExt</a>&gt;(mCallback)) {</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        std::get&lt;typename BranchDef&lt;value_type&gt;::SpectatorExt&gt;(mCallback)(data, ref);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      }</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;      <span class="keywordflow">if</span> (std::holds_alternative&lt;<span class="keyword">typename</span> <a class="code" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html">BranchDef&lt;value_type&gt;::Fill</a>&gt;(mCallback)) {</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        std::get&lt;typename BranchDef&lt;value_type&gt;::Fill&gt;(mCallback)(*branch, data);</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      }</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      <span class="keywordflow">if</span> (std::holds_alternative&lt;<span class="keyword">typename</span> <a class="code" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html">BranchDef&lt;value_type&gt;::FillExt</a>&gt;(mCallback)) {</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        std::get&lt;typename BranchDef&lt;value_type&gt;::FillExt&gt;(mCallback)(*branch, data, ref);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      }</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    }</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="comment">// specialization for trivial structs or serialized objects without a TClass interface</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="comment">// the extracted object is copied to store variable</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <a class="code" href="../../dc/da3/glcorearb_8h.html#af5ef68ee1b33850ea6254115a25d0a85">template &lt;typename S, typename std::enable_if_t&lt;std::is_same&lt;S, MessageableTypeSpecialization&gt;::value</a>, <span class="keywordtype">int</span>&gt; = 0&gt;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keywordtype">void</span> fillData(<a class="code" href="../../df/d24/classo2_1_1framework_1_1InputRecord.html">InputContext</a>&amp; context, <a class="code" href="../../d3/da6/structo2_1_1framework_1_1DataRef.html">DataRef</a> <span class="keyword">const</span>&amp; ref, TBranch* branch, <span class="keywordtype">size_t</span> branchIdx)</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    {</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      <span class="keyword">auto</span> data = context.<a class="code" href="../../df/d24/classo2_1_1framework_1_1InputRecord.html#a1c777bf7e242f8ba17b89275446a1225">get</a>&lt;value_type&gt;(<a class="code" href="../../dc/da3/glcorearb_8h.html#ad32bdec748ba376f6c0d2df39ab9a95b">ref</a>);</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      <span class="keywordflow">if</span> (!runCallback(branch, data, ref)) {</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        mStore[branchIdx] = <a class="code" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        branch-&gt;Fill();</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      }</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    }</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="comment">// specialization for non-messageable types with ROOT dictionary</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="comment">// for non-trivial structs, the address of the pointer to the objects needs to be used</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="comment">// in order to directly use the pointer to extracted object</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="comment">// store is a pointer to object</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <a class="code" href="../../dc/da3/glcorearb_8h.html#af5ef68ee1b33850ea6254115a25d0a85">template &lt;typename S, typename std::enable_if_t&lt;std::is_same&lt;S, ROOTTypeSpecialization&gt;::value</a>, <span class="keywordtype">int</span>&gt; = 0&gt;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordtype">void</span> fillData(<a class="code" href="../../df/d24/classo2_1_1framework_1_1InputRecord.html">InputContext</a>&amp; context, <a class="code" href="../../d3/da6/structo2_1_1framework_1_1DataRef.html">DataRef</a> <span class="keyword">const</span>&amp; ref, TBranch* branch, <span class="keywordtype">size_t</span> branchIdx)</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    {</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <span class="keyword">auto</span> data = context.<a class="code" href="../../df/d24/classo2_1_1framework_1_1InputRecord.html#a1c777bf7e242f8ba17b89275446a1225">get</a>&lt;<span class="keyword">typename</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a7d05960f4f1c1b11f3177dc963a45d86">std::add_pointer&lt;value_type&gt;::type</a>&gt;(<a class="code" href="../../dc/da3/glcorearb_8h.html#ad32bdec748ba376f6c0d2df39ab9a95b">ref</a>);</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      <span class="keywordflow">if</span> (!runCallback(branch, *data, ref)) {</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="comment">// this is ugly but necessary because of the TTree API does not allow a const</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <span class="comment">// object as input. Have to rely on that ROOT treats the object as const</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        mStore[branchIdx] = <span class="keyword">const_cast&lt;</span>value_type*<span class="keyword">&gt;</span>(data.get());</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        branch-&gt;Fill();</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      }</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    }</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="comment">// specialization for binary buffers using const char*</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="comment">// this writes both the data branch and a size branch</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <a class="code" href="../../dc/da3/glcorearb_8h.html#af5ef68ee1b33850ea6254115a25d0a85">template &lt;typename S, typename std::enable_if_t&lt;std::is_same&lt;S, BinaryBranchSpecialization&gt;::value</a>, <span class="keywordtype">int</span>&gt; = 0&gt;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordtype">void</span> fillData(<a class="code" href="../../df/d24/classo2_1_1framework_1_1InputRecord.html">InputContext</a>&amp; context, <a class="code" href="../../d3/da6/structo2_1_1framework_1_1DataRef.html">DataRef</a> <span class="keyword">const</span>&amp; ref, TBranch* branch, <span class="keywordtype">size_t</span> branchIdx)</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    {</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      <span class="keyword">auto</span> data = context.<a class="code" href="../../df/d24/classo2_1_1framework_1_1InputRecord.html#a1c777bf7e242f8ba17b89275446a1225">get</a>&lt;gsl::span&lt;char&gt;&gt;(<a class="code" href="../../dc/da3/glcorearb_8h.html#ad32bdec748ba376f6c0d2df39ab9a95b">ref</a>);</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      std::get&lt;2&gt;(mStore.at(branchIdx)) = data.size();</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      std::get&lt;1&gt;(mStore.at(branchIdx))-&gt;Fill();</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      std::get&lt;0&gt;(mStore.at(branchIdx)).resize(data.size());</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      memcpy(std::get&lt;0&gt;(mStore.at(branchIdx)).<a class="code" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>(), data.data(), data.size());</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      branch-&gt;Fill();</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    }</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="comment">// specialization for vectors of messageable types</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <a class="code" href="../../dc/da3/glcorearb_8h.html#af5ef68ee1b33850ea6254115a25d0a85">template &lt;typename S, typename std::enable_if_t&lt;std::is_same&lt;S, MessageableVectorSpecialization&gt;::value</a>, <span class="keywordtype">int</span>&gt; = 0&gt;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="keywordtype">void</span> fillData(<a class="code" href="../../df/d24/classo2_1_1framework_1_1InputRecord.html">InputContext</a>&amp; context, <a class="code" href="../../d3/da6/structo2_1_1framework_1_1DataRef.html">DataRef</a> <span class="keyword">const</span>&amp; ref, TBranch* branch, <span class="keywordtype">size_t</span> branchIdx)</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    {</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      <span class="keyword">using</span> ValueType = <span class="keyword">typename</span> value_type::value_type;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      static_assert(<a class="code" href="../../de/de6/structo2_1_1framework_1_1is__messageable.html">is_messageable&lt;ValueType&gt;::value</a>, <span class="stringliteral">&quot;logical error: should be correctly selected by StructureElementTypeTrait&quot;</span>);</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      <span class="comment">// if the value type is messagable and has a ROOT dictionary, two serialization methods are possible</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      <span class="comment">// for the moment, the InputRecord API can not handle both with the same call</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      <span class="keywordflow">try</span> {</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="comment">// try extracting from message with serialization method NONE, throw runtime error</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <span class="comment">// if message is serialized</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <span class="keyword">auto</span> data = context.<a class="code" href="../../df/d24/classo2_1_1framework_1_1InputRecord.html#a1c777bf7e242f8ba17b89275446a1225">get</a>&lt;gsl::span&lt;ValueType&gt;&gt;(<a class="code" href="../../dc/da3/glcorearb_8h.html#ad32bdec748ba376f6c0d2df39ab9a95b">ref</a>);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        value_type clone(data.begin(), data.end());</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        <span class="keywordflow">if</span> (!runCallback(branch, clone, ref)) {</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;          mStore[branchIdx] = &amp;clone;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;          branch-&gt;Fill();</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        }</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::runtime_error&amp; <a class="code" href="../../d8/de9/qconfigoptions_8h.html#acc2760558000045ec0803d60d4d01c98">e</a>) {</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <span class="keywordflow">if</span> constexpr (<a class="code" href="../../d3/de1/structo2_1_1framework_1_1has__root__dictionary.html">has_root_dictionary&lt;value_type&gt;::value</a> == <span class="keyword">true</span>) {</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;          <span class="comment">// try extracting from message with serialization method ROOT</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;          <span class="keyword">auto</span> data = context.<a class="code" href="../../df/d24/classo2_1_1framework_1_1InputRecord.html#a1c777bf7e242f8ba17b89275446a1225">get</a>&lt;<span class="keyword">typename</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a7d05960f4f1c1b11f3177dc963a45d86">std::add_pointer&lt;value_type&gt;::type</a>&gt;(<a class="code" href="../../dc/da3/glcorearb_8h.html#ad32bdec748ba376f6c0d2df39ab9a95b">ref</a>);</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;          <span class="keywordflow">if</span> (!runCallback(branch, *data, ref)) {</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            mStore[branchIdx] = <span class="keyword">const_cast&lt;</span>value_type*<span class="keyword">&gt;</span>(data.get());</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            branch-&gt;Fill();</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;          }</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;          <span class="comment">// the type has no ROOT dictionary, re-throw exception</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;          <span class="keywordflow">throw</span> <a class="code" href="../../d8/de9/qconfigoptions_8h.html#acc2760558000045ec0803d60d4d01c98">e</a>;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        }</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      }</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    }</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="comment">// process previous stage and this stage</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a6fdb9be6f8d9beb8e9275650e658422c">process</a>(<a class="code" href="../../df/d24/classo2_1_1framework_1_1InputRecord.html">InputContext</a>&amp; context, std::vector&lt;BranchSpec&gt;&amp; specs)</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    {</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      <span class="comment">// recursing through the tree structure by simply using method of the previous type,</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      <span class="comment">// i.e. the base class method.</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a6fdb9be6f8d9beb8e9275650e658422c">PrevT::process</a>(context, specs);</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      constexpr <span class="keywordtype">size_t</span> SpecIndex = STAGE - 1;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      BranchSpec <span class="keyword">const</span>&amp; spec = specs[SpecIndex];</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      <span class="keywordflow">if</span> (spec.branches.size() == 0) {</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        <span class="comment">// this definition is disabled</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      }</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      <span class="comment">// loop over all defined inputs</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; key : spec.keys) {</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <span class="keyword">auto</span> keypos = context.<a class="code" href="../../df/d24/classo2_1_1framework_1_1InputRecord.html#a047e93fed801ae8312a075f71cb514b4">getPos</a>(key.c_str());</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        <span class="keyword">auto</span> parts = context.<a class="code" href="../../df/d24/classo2_1_1framework_1_1InputRecord.html#ad08e5b2b9d6233133106273ac4accd7f">getNofParts</a>(keypos);</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        <span class="keywordflow">for</span> (decltype(parts) part = 0; part &lt; parts; part++) {</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;          <span class="keyword">auto</span> dataref = context.<a class="code" href="../../df/d24/classo2_1_1framework_1_1InputRecord.html#a1c777bf7e242f8ba17b89275446a1225">get</a>(key.c_str(), part);</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;          <span class="keywordtype">size_t</span> branchIdx = 0;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;          <span class="keywordflow">if</span> (spec.getIndex) {</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            branchIdx = spec.getIndex(dataref);</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            <span class="keywordflow">if</span> (branchIdx == ~(<span class="keywordtype">size_t</span>)0) {</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;              <span class="comment">// this indicates skipping</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;              <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            }</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;          }</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;          fillData&lt;specialization_id&gt;(context, dataref, spec.branches.at(branchIdx), branchIdx);</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        }</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      }</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    }</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="comment">// helper function to get Nth argument from the argument pack</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="keyword">template</span> &lt;<span class="keywordtype">size_t</span> <a class="code" href="../../d4/d54/GPUReconstructionKernels_8h.html#ab0127665b2e65e79a1e2523951eb0dbd">N</a>, <span class="keyword">typename</span> Arg, <span class="keyword">typename</span>... Args&gt;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="keyword">auto</span> getArg(Arg&amp;&amp; arg, Args&amp;&amp;... args)</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    {</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      <span class="keywordflow">if</span> constexpr (N == 0) {</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        <span class="keywordflow">return</span> arg;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> constexpr (<span class="keyword">sizeof</span>...(Args) &gt; 0) {</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        <span class="keywordflow">return</span> getArg&lt;N - 1&gt;(std::forward&lt;Args&gt;(args)...);</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      }</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    }</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="comment">// recursively set optional callback from argument pack and recurse to all folded types</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span>... Args&gt;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordtype">void</span> setCallback(Args&amp;&amp;... args)</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    {</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      <span class="comment">// recursing through the tree structure by simply using method of the previous type,</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      <span class="comment">// i.e. the base class method.</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      <span class="keywordflow">if</span> constexpr (STAGE &gt; 1) {</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        PrevT::setCallback(std::forward&lt;Args&gt;(args)...);</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      }</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      <span class="comment">// now set this instance, the argument position is determined by the STAGE counter</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      <span class="keyword">auto</span> arg = getArg&lt;STAGE - 1&gt;(std::forward&lt;Args&gt;(args)...);</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      <span class="keywordflow">if</span> constexpr (std::is_same&lt;value_type, <span class="keyword">typename</span> decltype(arg)::<a class="code" href="../../dc/da3/glcorearb_8h.html#a7d05960f4f1c1b11f3177dc963a45d86">type</a>&gt;::<a class="code" href="../../dc/da3/glcorearb_8h.html#af5ef68ee1b33850ea6254115a25d0a85">value</a>) {</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        <span class="keywordflow">if</span> (not std::holds_alternative&lt;std::monostate&gt;(arg.callback)) {</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;          mCallback = std::move(arg.callback);</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        }</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      }</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    }</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;   <span class="keyword">private</span>:</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    std::vector&lt;store_type&gt; mStore;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keyword">typename</span> <a class="code" href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html">BranchDef&lt;value_type&gt;::BranchCallback</a> mCallback;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  };</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Arg, <span class="keyword">typename</span>... Args&gt;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <span class="keywordtype">void</span> parseConstructorArgs(Arg&amp;&amp; arg, Args&amp;&amp;... args)</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  {</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="keyword">using</span> <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a7cb47c18c663b616974d65febeaa1790">Type</a> = std::decay_t&lt;Arg&gt;;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keywordflow">if</span> constexpr (<a class="code" href="../../dc/da1/structo2_1_1framework_1_1can__assign.html">can_assign&lt;Type, CustomClose&gt;::value</a>) {</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      mCustomClose = arg;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      mTreeStructure = createTreeStructure&lt;0, TreeStructureInterface&gt;(std::forward&lt;Arg&gt;(arg), std::forward&lt;Args&gt;(args)...);</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    }</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="keywordflow">if</span> constexpr (<span class="keyword">sizeof</span>...(Args) &gt; 1) {</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      parseConstructorArgs(std::forward&lt;Args&gt;(args)...);</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    }</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  }</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">size_t</span> <a class="code" href="../../d4/d54/GPUReconstructionKernels_8h.html#ab0127665b2e65e79a1e2523951eb0dbd">N</a>, <span class="keyword">typename</span> <a class="code" href="../../df/dcb/classBASE.html">BASE</a>, <span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  <span class="keyword">auto</span> createTreeStructure(T&amp;&amp; <a class="code" href="../../d8/de9/qconfigoptions_8h.html#ac64ec43bdf1e32385e52082c0474861f">def</a>, Args&amp;&amp;... args)</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  {</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="comment">// Note: a branch definition can be disabled by setting nofBranches to zero</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="comment">// an entry of the definition is kept in the registry, but the branches vector</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="comment">// is of size zero, which will make the writer to always skip this definition</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    mBranchSpecs.push_back({{}, {<a class="code" href="../../d8/de9/qconfigoptions_8h.html#ac64ec43bdf1e32385e52082c0474861f">def</a>.branchName}});</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="keyword">auto</span>&amp; spec = mBranchSpecs.back();</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="comment">// extract the internal keys for the list of provided input definitions</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keywordtype">size_t</span> idx = 0;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    spec.keys.resize(<a class="code" href="../../d8/de9/qconfigoptions_8h.html#ac64ec43bdf1e32385e52082c0474861f">def</a>.keys.size());</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <a class="code" href="../../d9/d33/namespaceo2_1_1vertexing.html#a39341a4d0a4b5fa9301ff9da8018e177">std::generate</a>(spec.keys.begin(), spec.keys.end(), [&amp;<a class="code" href="../../d8/de9/qconfigoptions_8h.html#ac64ec43bdf1e32385e52082c0474861f">def</a>, &amp;idx] { <span class="keywordflow">return</span> <a class="code" href="../../d9/df7/ConfigurableParamHelper_8cxx.html#a513e489498bde75117aca1622cb2eb41">T::key_extractor::asString</a>(<a class="code" href="../../d8/de9/qconfigoptions_8h.html#ac64ec43bdf1e32385e52082c0474861f">def</a>.keys[idx++]); });</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    mBranchSpecs.back().branches.resize(<a class="code" href="../../d8/de9/qconfigoptions_8h.html#ac64ec43bdf1e32385e52082c0474861f">def</a>.nofBranches, <span class="keyword">nullptr</span>);</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="comment">// a branch definition might be disabled by setting number of branches to 0; if enabled,</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="comment">// the number of branches has to match the number of inputs but can be larger depending</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="comment">// on the exact functionality provided with the getIndex callback. In any case, the</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="comment">// callbacks only need to be propagated if multiple branches are defined</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <a class="code" href="../../d7/d94/GPUReconstructionIncludes_8h.html#a287eedb5aeb3e2204ded2924050fb641">assert</a>(<a class="code" href="../../d8/de9/qconfigoptions_8h.html#ac64ec43bdf1e32385e52082c0474861f">def</a>.nofBranches == 0 || <a class="code" href="../../d8/de9/qconfigoptions_8h.html#ac64ec43bdf1e32385e52082c0474861f">def</a>.nofBranches &gt;= spec.keys.size());</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="comment">// a getIndex function makes only sense if there are multiple branches</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <a class="code" href="../../d7/d94/GPUReconstructionIncludes_8h.html#a287eedb5aeb3e2204ded2924050fb641">assert</a>(<a class="code" href="../../d8/de9/qconfigoptions_8h.html#ac64ec43bdf1e32385e52082c0474861f">def</a>.nofBranches &lt;= 1 || <a class="code" href="../../d8/de9/qconfigoptions_8h.html#ac64ec43bdf1e32385e52082c0474861f">def</a>.getIndex);</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/de9/qconfigoptions_8h.html#ac64ec43bdf1e32385e52082c0474861f">def</a>.nofBranches &gt; 1) {</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      <a class="code" href="../../d7/d94/GPUReconstructionIncludes_8h.html#a287eedb5aeb3e2204ded2924050fb641">assert</a>(<a class="code" href="../../d8/de9/qconfigoptions_8h.html#ac64ec43bdf1e32385e52082c0474861f">def</a>.getIndex &amp;&amp; <a class="code" href="../../d8/de9/qconfigoptions_8h.html#ac64ec43bdf1e32385e52082c0474861f">def</a>.getName);</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      mBranchSpecs.back().getIndex = <a class="code" href="../../d8/de9/qconfigoptions_8h.html#ac64ec43bdf1e32385e52082c0474861f">def</a>.getIndex;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      mBranchSpecs.back().getName = <a class="code" href="../../d8/de9/qconfigoptions_8h.html#ac64ec43bdf1e32385e52082c0474861f">def</a>.getName;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      mBranchSpecs.back().names.resize(<a class="code" href="../../d8/de9/qconfigoptions_8h.html#ac64ec43bdf1e32385e52082c0474861f">def</a>.nofBranches);</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      <span class="comment">// fill the branch names by calling the getName callback</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;      idx = 0;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      <a class="code" href="../../d9/d33/namespaceo2_1_1vertexing.html#a39341a4d0a4b5fa9301ff9da8018e177">std::generate</a>(mBranchSpecs.back().names.begin(), mBranchSpecs.back().names.end(),</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                    [&amp;<a class="code" href="../../d8/de9/qconfigoptions_8h.html#ac64ec43bdf1e32385e52082c0474861f">def</a>, &amp;idx]() { <span class="keywordflow">return</span> <a class="code" href="../../d8/de9/qconfigoptions_8h.html#ac64ec43bdf1e32385e52082c0474861f">def</a>.getName(<a class="code" href="../../d8/de9/qconfigoptions_8h.html#ac64ec43bdf1e32385e52082c0474861f">def</a>.branchName, idx++); });</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    }</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="keyword">using</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a7d05960f4f1c1b11f3177dc963a45d86">type</a> = TreeStructureElement&lt;typename T::type, BASE&gt;;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="keywordflow">if</span> constexpr (N == 0) {</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      <span class="comment">// in the upper most call we have the concrete type of the mixin object</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      <span class="comment">// and call its method to set the callbacks from the argument pack, it</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      <span class="comment">// recurses to all folded types</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      <span class="keyword">auto</span> instance = createTreeStructure&lt;N + 1, type&gt;(std::forward&lt;Args&gt;(args)...);</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      instance-&gt;setCallback(std::move(<a class="code" href="../../d8/de9/qconfigoptions_8h.html#ac64ec43bdf1e32385e52082c0474861f">def</a>), std::forward&lt;Args&gt;(args)...);</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      <span class="comment">// the upper most call returns the unique pointer of the virtual interface</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      std::unique_ptr&lt;TreeStructureInterface&gt; ret(instance.release());</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      <span class="keywordflow">return</span> std::move(createTreeStructure&lt;N + 1, type&gt;(std::forward&lt;Args&gt;(args)...));</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    }</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  }</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <span class="comment">// last iteration, returning unique pointer of the concrete mixin</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">size_t</span> N, <span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  std::unique_ptr&lt;T&gt; createTreeStructure()</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  {</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    static_assert(N &gt; 0, <span class="stringliteral">&quot;The writer does not make sense without branch definitions&quot;</span>);</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keywordflow">return</span> std::make_unique&lt;T&gt;();</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  }</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  std::unique_ptr&lt;TFile&gt; mFile;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  std::unique_ptr&lt;TTree&gt; mTree;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  std::vector&lt;BranchSpec&gt; mBranchSpecs;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  std::unique_ptr&lt;TreeStructureInterface&gt; mTreeStructure;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  <span class="keywordtype">bool</span> mIsClosed = <span class="keyword">false</span>;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  <a class="code" href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a491e4ddf3c92c927b570e437fe611c5b">CustomClose</a> mCustomClose;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;};</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;} <span class="comment">// namespace framework</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;} <span class="comment">// namespace o2</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="structo2_1_1framework_1_1has__root__dictionary_html"><div class="ttname"><a href="../../d3/de1/structo2_1_1framework_1_1has__root__dictionary.html">o2::framework::has_root_dictionary</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/TypeTraits_8h_source.html#l00116">TypeTraits.h:116</a></div></div>
<div class="ttc" id="namespaceo2_html"><div class="ttname"><a href="../../d4/d7c/namespaceo2.html">o2</a></div><div class="ttdoc">information complementary to a CCDB object (path, metadata, startTimeValidity, endTimeValidity etc) ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d24/BitstreamReader_8h_source.html#l00022">BitstreamReader.h:22</a></div></div>
<div class="ttc" id="GPUReconstructionIncludes_8h_html_a287eedb5aeb3e2204ded2924050fb641"><div class="ttname"><a href="../../d7/d94/GPUReconstructionIncludes_8h.html#a287eedb5aeb3e2204ded2924050fb641">assert</a></div><div class="ttdeci">#define assert(param)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d94/GPUReconstructionIncludes_8h_source.html#l00021">GPUReconstructionIncludes.h:21</a></div></div>
<div class="ttc" id="structo2_1_1framework_1_1RootTreeWriter_1_1DefaultKeyExtractor_html"><div class="ttname"><a href="../../d7/d85/structo2_1_1framework_1_1RootTreeWriter_1_1DefaultKeyExtractor.html">o2::framework::RootTreeWriter::DefaultKeyExtractor</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00102">RootTreeWriter.h:102</a></div></div>
<div class="ttc" id="GPUCommonLogger_8h_html_aea3d0edfe28fc0325c636b2b33f0527a"><div class="ttname"><a href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a></div><div class="ttdeci">#define LOG(type)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d5b/GPUCommonLogger_8h_source.html#l00028">GPUCommonLogger.h:28</a></div></div>
<div class="ttc" id="structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef_html_ab3971632106a28658a2b8e075040f94b"><div class="ttname"><a href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#ab3971632106a28658a2b8e075040f94b">o2::framework::RootTreeWriter::BranchDef::getIndex</a></div><div class="ttdeci">IndexExtractor getIndex</div><div class="ttdoc">extractor function for the index for parallel branches </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00156">RootTreeWriter.h:156</a></div></div>
<div class="ttc" id="structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef_html_a11176f3e4f282124c79dcd3a276d8b08"><div class="ttname"><a href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#a11176f3e4f282124c79dcd3a276d8b08">o2::framework::RootTreeWriter::BranchDef::branchName</a></div><div class="ttdeci">std::string branchName</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00152">RootTreeWriter.h:152</a></div></div>
<div class="ttc" id="structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef_html_a0cd17d3f727ab880519fe62570ec143b"><div class="ttname"><a href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#a0cd17d3f727ab880519fe62570ec143b">o2::framework::RootTreeWriter::BranchDef::BranchDef</a></div><div class="ttdeci">BranchDef(std::vector&lt; key_type &gt; vec, std::string _branchName, size_t _nofBranches, Args &amp;&amp;... args)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00201">RootTreeWriter.h:201</a></div></div>
<div class="ttc" id="classo2_1_1framework_1_1InputRecord_html"><div class="ttname"><a href="../../df/d24/classo2_1_1framework_1_1InputRecord.html">o2::framework::InputRecord</a></div><div class="ttdoc">The input API of the Data Processing Layer This class holds the inputs which are valid for processing...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d5c/InputRecord_8h_source.html#l00096">InputRecord.h:96</a></div></div>
<div class="ttc" id="namespaceo2_1_1tpc_1_1rawreader_html_a44ae0b14f44563124b01abb4e10a119f"><div class="ttname"><a href="../../d3/d28/namespaceo2_1_1tpc_1_1rawreader.html#a44ae0b14f44563124b01abb4e10a119f">o2::tpc::rawreader::DataType</a></div><div class="ttdeci">DataType</div><div class="ttdoc">data type </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d86/RawReaderCRU_8h_source.html#l00057">RawReaderCRU.h:57</a></div></div>
<div class="ttc" id="classo2_1_1framework_1_1RootTreeWriter_html_a8063d0b4bf02205274f1e36ed67c7424"><div class="ttname"><a href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a8063d0b4bf02205274f1e36ed67c7424">o2::framework::RootTreeWriter::IndexExtractor</a></div><div class="ttdeci">std::function&lt; size_t(o2::framework::DataRef const  &amp;)&gt; IndexExtractor</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00092">RootTreeWriter.h:92</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a5c4947d4516dd7cfa3505ce3a648a4ef"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a5c4947d4516dd7cfa3505ce3a648a4ef">name</a></div><div class="ttdeci">GLuint const GLchar * name</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00781">glcorearb.h:781</a></div></div>
<div class="ttc" id="structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef_html_ac4d1f2a676e4ca0bc666eb047d8e7d38"><div class="ttname"><a href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#ac4d1f2a676e4ca0bc666eb047d8e7d38">o2::framework::RootTreeWriter::BranchDef&lt; T, InputSpec, KeyExtractor &gt;::key_extractor</a></div><div class="ttdeci">KeyExtractor key_extractor</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00150">RootTreeWriter.h:150</a></div></div>
<div class="ttc" id="qconfigoptions_8h_html_a7cb47c18c663b616974d65febeaa1790"><div class="ttname"><a href="../../d8/de9/qconfigoptions_8h.html#a7cb47c18c663b616974d65febeaa1790">Type</a></div><div class="ttdeci">Visualize clusters only Timeframe settings Average distance in cm of events merged into Randomize distance around average distance of merged events Simulate correct bunch interactions instead of placing only the average number of events A value [n] sets TFlen for [n] collisions in Number of bunches per train Number of bunch trains Instantaneous interaction rate Do not simulate border Total number of collisions to be placed in the interior of all time Do not select random but walk over array of events in stride steps h QA settings const char Legend entries for data from comparison histogram files const char Store histograms in output root Do not run but just create PDFs from input root files Set cut for Q Compute the efficiency including impure tracks with fake contamination Maxmimum Create resolution histograms in the native fit Filter for Filter for Particle Type(0 Electron, 1 Muon, 2 Pion, 3 Kaon, 4 Proton)&quot;) AddOption(writeMCLabels</div></div>
<div class="ttc" id="classo2_1_1framework_1_1RootTreeWriter_html_a0693e202752a97bfb85e45ab1e505fcf"><div class="ttname"><a href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a0693e202752a97bfb85e45ab1e505fcf">o2::framework::RootTreeWriter::operator()</a></div><div class="ttdeci">void operator()(ContextType &amp;&amp;context)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00298">RootTreeWriter.h:298</a></div></div>
<div class="ttc" id="classo2_1_1framework_1_1RootTreeWriter_html_a328cb80f5570a55bb8a3f9edf8fbae35"><div class="ttname"><a href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a328cb80f5570a55bb8a3f9edf8fbae35">o2::framework::RootTreeWriter::BranchNameMapper</a></div><div class="ttdeci">std::function&lt; std::string(std::string, size_t)&gt; BranchNameMapper</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00094">RootTreeWriter.h:94</a></div></div>
<div class="ttc" id="classo2_1_1framework_1_1InputRecord_html_a1c777bf7e242f8ba17b89275446a1225"><div class="ttname"><a href="../../df/d24/classo2_1_1framework_1_1InputRecord.html#a1c777bf7e242f8ba17b89275446a1225">o2::framework::InputRecord::get</a></div><div class="ttdeci">decltype(auto) get(R binding, int part=0) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d5c/InputRecord_8h_source.html#l00216">InputRecord.h:216</a></div></div>
<div class="ttc" id="namespaceo2_1_1vertexing_html_a39341a4d0a4b5fa9301ff9da8018e177"><div class="ttname"><a href="../../d9/d33/namespaceo2_1_1vertexing.html#a39341a4d0a4b5fa9301ff9da8018e177">o2::vertexing::generate</a></div><div class="ttdeci">TLorentzVector generate(Vec3D &amp;vtx, std::vector&lt; o2::track::TrackParCov &gt; &amp;vctr, float bz, TGenPhaseSpace &amp;genPHS, double parMass, const std::vector&lt; double &gt; &amp;dtMass, std::vector&lt; int &gt; forceQ)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de2/testDCAFitterN_8cxx_source.html#l00064">testDCAFitterN.cxx:64</a></div></div>
<div class="ttc" id="structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef_html_a4d2a4d83c290a6517652f97108ccc555"><div class="ttname"><a href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#a4d2a4d83c290a6517652f97108ccc555">o2::framework::RootTreeWriter::BranchDef::BranchDef</a></div><div class="ttdeci">BranchDef(key_type key, std::string _branchName, size_t _nofBranches, Args &amp;&amp;... args)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00185">RootTreeWriter.h:185</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a3d1e3edfcf61ca2d831883e1afbad89e"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a3d1e3edfcf61ca2d831883e1afbad89e">size</a></div><div class="ttdeci">GLsizeiptr size</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00659">glcorearb.h:659</a></div></div>
<div class="ttc" id="structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef_html_ae059de16ddd6f18ce68ea62992d5b928"><div class="ttname"><a href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#ae059de16ddd6f18ce68ea62992d5b928">o2::framework::RootTreeWriter::BranchDef::init</a></div><div class="ttdeci">void init(Arg &amp;&amp;arg, Args &amp;&amp;... args)</div><div class="ttdoc">recursively init member variables from parameter pack </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00208">RootTreeWriter.h:208</a></div></div>
<div class="ttc" id="classo2_1_1framework_1_1RootTreeWriter_html_aa5239804b66cf8c8e1a5d890aa2bd3cb"><div class="ttname"><a href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#aa5239804b66cf8c8e1a5d890aa2bd3cb">o2::framework::RootTreeWriter::BranchVerbosity</a></div><div class="ttdeci">BranchVerbosity</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00110">RootTreeWriter.h:110</a></div></div>
<div class="ttc" id="classo2_1_1framework_1_1RootTreeWriter_html_a491e4ddf3c92c927b570e437fe611c5b"><div class="ttname"><a href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a491e4ddf3c92c927b570e437fe611c5b">o2::framework::RootTreeWriter::CustomClose</a></div><div class="ttdeci">std::function&lt; void(TFile *file, TTree *tree)&gt; CustomClose</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00098">RootTreeWriter.h:98</a></div></div>
<div class="ttc" id="classo2_1_1framework_1_1RootTreeWriter_html_adbca06ba7d2010331d632926d2ae8057"><div class="ttname"><a href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#adbca06ba7d2010331d632926d2ae8057">o2::framework::RootTreeWriter::setBranchName</a></div><div class="ttdeci">void setBranchName(size_t index, const char *branchName)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00280">RootTreeWriter.h:280</a></div></div>
<div class="ttc" id="ConfigurableParamHelper_8cxx_html_a513e489498bde75117aca1622cb2eb41"><div class="ttname"><a href="../../d9/df7/ConfigurableParamHelper_8cxx.html#a513e489498bde75117aca1622cb2eb41">asString</a></div><div class="ttdeci">const char * asString(TDataMember const &amp;dm, char *pointer)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df7/ConfigurableParamHelper_8cxx_source.html#l00123">ConfigurableParamHelper.cxx:123</a></div></div>
<div class="ttc" id="glcorearb_8h_html_ad32bdec748ba376f6c0d2df39ab9a95b"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#ad32bdec748ba376f6c0d2df39ab9a95b">ref</a></div><div class="ttdeci">GLint ref</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00291">glcorearb.h:291</a></div></div>
<div class="ttc" id="structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef_html_ab1ca95e696f31fffa5b84e0980da4fa1"><div class="ttname"><a href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#ab1ca95e696f31fffa5b84e0980da4fa1">o2::framework::RootTreeWriter::BranchDef&lt; T, InputSpec, KeyExtractor &gt;::Spectator</a></div><div class="ttdeci">std::function&lt; void(T const &amp;)&gt; Spectator</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00162">RootTreeWriter.h:162</a></div></div>
<div class="ttc" id="structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef_html_a61d7205863a03a900d70f413e9dba2b7"><div class="ttname"><a href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#a61d7205863a03a900d70f413e9dba2b7">o2::framework::RootTreeWriter::BranchDef&lt; T, InputSpec, KeyExtractor &gt;::BranchCallback</a></div><div class="ttdeci">std::variant&lt; std::monostate, Fill, FillExt, Spectator, SpectatorExt &gt; BranchCallback</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00164">RootTreeWriter.h:164</a></div></div>
<div class="ttc" id="structo2_1_1framework_1_1is__messageable_html"><div class="ttname"><a href="../../de/de6/structo2_1_1framework_1_1is__messageable.html">o2::framework::is_messageable</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d62/DataFormats_2Detectors_2ITSMFT_2common_2include_2DataFormatsITSMFT_2Cluster_8h_source.html#l00201">Cluster.h:201</a></div></div>
<div class="ttc" id="namespacenlohmann_1_1detail_html_a02bcbc878bee413f25b985ada771aa9c"><div class="ttname"><a href="../../dc/df0/namespacenlohmann_1_1detail.html#a02bcbc878bee413f25b985ada771aa9c">nlohmann::detail::enable_if_t</a></div><div class="ttdeci">typename std::enable_if&lt; B, T &gt;::type enable_if_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d05/json_8h_source.html#l00280">json.h:280</a></div></div>
<div class="ttc" id="RootSerializationSupport_8h_html"><div class="ttname"><a href="../../db/dff/RootSerializationSupport_8h.html">RootSerializationSupport.h</a></div></div>
<div class="ttc" id="InputRecord_8h_html"><div class="ttname"><a href="../../d6/d5c/InputRecord_8h.html">InputRecord.h</a></div></div>
<div class="ttc" id="classo2_1_1framework_1_1InputRecord_html_a047e93fed801ae8312a075f71cb514b4"><div class="ttname"><a href="../../df/d24/classo2_1_1framework_1_1InputRecord.html#a047e93fed801ae8312a075f71cb514b4">o2::framework::InputRecord::getPos</a></div><div class="ttdeci">int getPos(const char *name) const</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d8e/InputRecord_8cxx_source.html#l00041">InputRecord.cxx:41</a></div></div>
<div class="ttc" id="structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef_html_a6e59e4399a5f35aeb571b68ef013ec20"><div class="ttname"><a href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#a6e59e4399a5f35aeb571b68ef013ec20">o2::framework::RootTreeWriter::BranchDef::BranchDef</a></div><div class="ttdeci">BranchDef(key_type key, std::string _branchName, size_t _nofBranches=1)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00172">RootTreeWriter.h:172</a></div></div>
<div class="ttc" id="classT_html"><div class="ttname"><a href="../../d1/def/classT.html">T</a></div></div>
<div class="ttc" id="structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef_html_ab6c78c5f3aaf2bf6dd11f2efc9c406d1"><div class="ttname"><a href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#ab6c78c5f3aaf2bf6dd11f2efc9c406d1">o2::framework::RootTreeWriter::BranchDef::keys</a></div><div class="ttdeci">std::vector&lt; key_type &gt; keys</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00151">RootTreeWriter.h:151</a></div></div>
<div class="ttc" id="structo2_1_1framework_1_1RootTreeWriter_1_1DefaultKeyExtractor_html_a3144ab6b9292888265d05fabd2d9d2b6"><div class="ttname"><a href="../../d7/d85/structo2_1_1framework_1_1RootTreeWriter_1_1DefaultKeyExtractor.html#a3144ab6b9292888265d05fabd2d9d2b6">o2::framework::RootTreeWriter::DefaultKeyExtractor::asString</a></div><div class="ttdeci">static key_type asString(T const &amp;arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00104">RootTreeWriter.h:104</a></div></div>
<div class="ttc" id="classo2_1_1framework_1_1RootTreeWriter_html_a629fed161d843ac97804dbca898432da"><div class="ttname"><a href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a629fed161d843ac97804dbca898432da">o2::framework::RootTreeWriter::key_type</a></div><div class="ttdeci">std::string key_type</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00089">RootTreeWriter.h:89</a></div></div>
<div class="ttc" id="classo2_1_1framework_1_1RootTreeWriter_html"><div class="ttname"><a href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html">o2::framework::RootTreeWriter</a></div><div class="ttdoc">A generic writer interface for ROOT TTree objects. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00085">RootTreeWriter.h:85</a></div></div>
<div class="ttc" id="qconfigoptions_8h_html_ac64ec43bdf1e32385e52082c0474861f"><div class="ttname"><a href="../../d8/de9/qconfigoptions_8h.html#ac64ec43bdf1e32385e52082c0474861f">def</a></div><div class="ttdeci">Visualize clusters only Timeframe settings Average distance in cm of events merged into Randomize distance around average distance of merged events Simulate correct bunch interactions instead of placing only the average number of events A value [n] sets TFlen for [n] collisions in Number of bunches per train Number of bunch trains Instantaneous interaction rate Do not simulate border def(1)) AddOption(nTotalInTFEvents</div></div>
<div class="ttc" id="structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef_html_aa9034d7906f72070d15982ffa90207bb"><div class="ttname"><a href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#aa9034d7906f72070d15982ffa90207bb">o2::framework::RootTreeWriter::BranchDef&lt; T, InputSpec, KeyExtractor &gt;::FillExt</a></div><div class="ttdeci">std::function&lt; void(TBranch &amp;branch, T const &amp;, DataRef const &amp;)&gt; FillExt</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00161">RootTreeWriter.h:161</a></div></div>
<div class="ttc" id="qconfigoptions_8h_html_acc2760558000045ec0803d60d4d01c98"><div class="ttname"><a href="../../d8/de9/qconfigoptions_8h.html#acc2760558000045ec0803d60d4d01c98">e</a></div><div class="ttdeci">Run track merging Number of iterations to Number of iterations to Number of initial iterations excluded from const char e</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/de9/qconfigoptions_8h_source.html#l00140">qconfigoptions.h:140</a></div></div>
<div class="ttc" id="classo2_1_1framework_1_1RootTreeWriter_html_a05ffdab01163306ee020e0c7b6ee58dc"><div class="ttname"><a href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a05ffdab01163306ee020e0c7b6ee58dc">o2::framework::RootTreeWriter::isClosed</a></div><div class="ttdeci">bool isClosed() const</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00330">RootTreeWriter.h:330</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a57f14e05b1900f16a2da82ade47d0c6d"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a57f14e05b1900f16a2da82ade47d0c6d">index</a></div><div class="ttdeci">GLuint index</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00781">glcorearb.h:781</a></div></div>
<div class="ttc" id="glcorearb_8h_html_af5ef68ee1b33850ea6254115a25d0a85"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#af5ef68ee1b33850ea6254115a25d0a85">value</a></div><div class="ttdeci">GLsizei const GLfloat * value</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00819">glcorearb.h:819</a></div></div>
<div class="ttc" id="classo2_1_1framework_1_1InputRecord_html_ad08e5b2b9d6233133106273ac4accd7f"><div class="ttname"><a href="../../df/d24/classo2_1_1framework_1_1InputRecord.html#ad08e5b2b9d6233133106273ac4accd7f">o2::framework::InputRecord::getNofParts</a></div><div class="ttdeci">size_t getNofParts(int pos) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d5c/InputRecord_8h_source.html#l00196">InputRecord.h:196</a></div></div>
<div class="ttc" id="classo2_1_1framework_1_1RootTreeWriter_html_a9ec0c11c34b562c2c4cbcc5cc0c58f3e"><div class="ttname"><a href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a9ec0c11c34b562c2c4cbcc5cc0c58f3e">o2::framework::RootTreeWriter::RootTreeWriter</a></div><div class="ttdeci">RootTreeWriter()=delete</div><div class="ttdoc">default constructor forbidden </div></div>
<div class="ttc" id="qconfigoptions_8h_html_a6fdb9be6f8d9beb8e9275650e658422c"><div class="ttname"><a href="../../d8/de9/qconfigoptions_8h.html#a6fdb9be6f8d9beb8e9275650e658422c">process</a></div><div class="ttdeci">Run track merging Number of iterations to Number of iterations to Number of initial iterations excluded from const char Directory with events to process</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/de9/qconfigoptions_8h_source.html#l00140">qconfigoptions.h:140</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a7d05960f4f1c1b11f3177dc963a45d86"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a7d05960f4f1c1b11f3177dc963a45d86">type</a></div><div class="ttdeci">GLint GLint GLsizei GLint GLenum GLenum type</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00275">glcorearb.h:275</a></div></div>
<div class="ttc" id="structo2_1_1framework_1_1DataRef_html"><div class="ttname"><a href="../../d3/da6/structo2_1_1framework_1_1DataRef.html">o2::framework::DataRef</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dfb/DataRef_8h_source.html#l00020">DataRef.h:20</a></div></div>
<div class="ttc" id="structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef_html"><div class="ttname"><a href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html">o2::framework::RootTreeWriter::BranchDef</a></div><div class="ttdoc">BranchDef is used to define the mapping between inputs and branches. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00147">RootTreeWriter.h:147</a></div></div>
<div class="ttc" id="ConfigurableParamHelper_8cxx_html_a82d3ab4ac5e230e789bbfccc18d62a90"><div class="ttname"><a href="../../d9/df7/ConfigurableParamHelper_8cxx.html#a82d3ab4ac5e230e789bbfccc18d62a90">getName</a></div><div class="ttdeci">std::string getName(const TDataMember *dm, int index, int size)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df7/ConfigurableParamHelper_8cxx_source.html#l00111">ConfigurableParamHelper.cxx:111</a></div></div>
<div class="ttc" id="structo2_1_1framework_1_1can__assign_html"><div class="ttname"><a href="../../dc/da1/structo2_1_1framework_1_1can__assign.html">o2::framework::can_assign</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/TypeTraits_8h_source.html#l00240">TypeTraits.h:240</a></div></div>
<div class="ttc" id="structo2_1_1framework_1_1InputSpec_html"><div class="ttname"><a href="../../da/d96/structo2_1_1framework_1_1InputSpec.html">o2::framework::InputSpec</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3f/InputSpec_8h_source.html#l00029">InputSpec.h:29</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a8922a680b00df660c57f47c1971d04c5"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a></div><div class="ttdeci">GLboolean * data</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00298">glcorearb.h:298</a></div></div>
<div class="ttc" id="GPUCommonAlgorithm_8h_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d0b/GPUCommonAlgorithm_8h_source.html#l00385">GPUCommonAlgorithm.h:385</a></div></div>
<div class="ttc" id="classo2_1_1framework_1_1RootTreeWriter_html_a6e0b07ea151d37e244b02a9679e16693"><div class="ttname"><a href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a6e0b07ea151d37e244b02a9679e16693">o2::framework::RootTreeWriter::init</a></div><div class="ttdeci">void init(const char *filename, const char *treename)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00267">RootTreeWriter.h:267</a></div></div>
<div class="ttc" id="classo2_1_1framework_1_1RootTreeWriter_html_adb8f1fcd217895fcc545d58cb477d0a3"><div class="ttname"><a href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#adb8f1fcd217895fcc545d58cb477d0a3">o2::framework::RootTreeWriter::close</a></div><div class="ttdeci">void close()</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00310">RootTreeWriter.h:310</a></div></div>
<div class="ttc" id="classBASE_html"><div class="ttname"><a href="../../df/dcb/classBASE.html">BASE</a></div></div>
<div class="ttc" id="GPUReconstructionKernels_8h_html_ab0127665b2e65e79a1e2523951eb0dbd"><div class="ttname"><a href="../../d4/d54/GPUReconstructionKernels_8h.html#ab0127665b2e65e79a1e2523951eb0dbd">N</a></div><div class="ttdeci">unsigned long size int mode int iSlice int iSlice char nOutput int int char useOrigTrackParam int char char mergeMode int N</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d54/GPUReconstructionKernels_8h_source.html#l00046">GPUReconstructionKernels.h:46</a></div></div>
<div class="ttc" id="structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef_html_a3a6ce7e65b7c7d13e3e41e05e9e035aa"><div class="ttname"><a href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#a3a6ce7e65b7c7d13e3e41e05e9e035aa">o2::framework::RootTreeWriter::BranchDef&lt; T, InputSpec, KeyExtractor &gt;::SpectatorExt</a></div><div class="ttdeci">std::function&lt; void(T const &amp;, DataRef const &amp;)&gt; SpectatorExt</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00163">RootTreeWriter.h:163</a></div></div>
<div class="ttc" id="classo2_1_1framework_1_1RootTreeWriter_html_a2d493ee9cfe998ad0fa57b769aadaa14"><div class="ttname"><a href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#a2d493ee9cfe998ad0fa57b769aadaa14">o2::framework::RootTreeWriter::RootTreeWriter</a></div><div class="ttdeci">RootTreeWriter(const char *filename, const char *treename, Args &amp;&amp;... args)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00248">RootTreeWriter.h:248</a></div></div>
<div class="ttc" id="structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef_html_ae5388722dc2ccdd990e85b321b9c905e"><div class="ttname"><a href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#ae5388722dc2ccdd990e85b321b9c905e">o2::framework::RootTreeWriter::BranchDef::callback</a></div><div class="ttdeci">BranchCallback callback</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00165">RootTreeWriter.h:165</a></div></div>
<div class="ttc" id="structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef_html_a72b5aa72217180808f933cf564f104e5"><div class="ttname"><a href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#a72b5aa72217180808f933cf564f104e5">o2::framework::RootTreeWriter::BranchDef&lt; T, InputSpec, KeyExtractor &gt;::Fill</a></div><div class="ttdeci">std::function&lt; void(TBranch &amp;branch, T const &amp;)&gt; Fill</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00160">RootTreeWriter.h:160</a></div></div>
<div class="ttc" id="classo2_1_1framework_1_1RootTreeWriter_html_ae183f6fa85671d2deb2c6d7ce610348f"><div class="ttname"><a href="../../d1/df9/classo2_1_1framework_1_1RootTreeWriter.html#ae183f6fa85671d2deb2c6d7ce610348f">o2::framework::RootTreeWriter::getStoreSize</a></div><div class="ttdeci">size_t getStoreSize() const</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00335">RootTreeWriter.h:335</a></div></div>
<div class="ttc" id="structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef_html_ad5d97d8415323be5b5bf799df1e5fd89"><div class="ttname"><a href="../../d6/d72/structo2_1_1framework_1_1RootTreeWriter_1_1BranchDef.html#ad5d97d8415323be5b5bf799df1e5fd89">o2::framework::RootTreeWriter::BranchDef::assertNoMatchingType</a></div><div class="ttdeci">void assertNoMatchingType(Arg &amp;&amp;arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/RootTreeWriter_8h_source.html#l00234">RootTreeWriter.h:234</a></div></div>
<div class="ttc" id="DataRef_8h_html"><div class="ttname"><a href="../../d5/dfb/DataRef_8h.html">DataRef.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_bcbb2cf9a3d3d83e5515c82071a07177.html">Framework</a></li><li class="navelem"><a class="el" href="../../dir_86f64936653d09622c529b3cc7c8edcd.html">Utils</a></li><li class="navelem"><a class="el" href="../../dir_de9651cf711cd4bea71a7a8d6bfef94c.html">include</a></li><li class="navelem"><a class="el" href="../../dir_7aebe22961b46cd8502bbaccf48f2fdd.html">DPLUtils</a></li><li class="navelem"><a class="el" href="../../dd/d8d/RootTreeWriter_8h.html">RootTreeWriter.h</a></li>
    <li class="footer">Generated on Thu Jun 4 2020 09:30:33 for Project by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
