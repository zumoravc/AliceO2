<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Project: /home/travis/build/AliceO2Group/AliceO2/GPU/GPUTracking/Base/GPUReconstructionConvert.cxx Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../o2_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('dd/d7f/GPUReconstructionConvert_8cxx_source.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">GPUReconstructionConvert.cxx</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../dd/d7f/GPUReconstructionConvert_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Copyright CERN and copyright holders of ALICE O2. This software is</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// distributed under the terms of the GNU General Public License v3 (GPL</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Version 3), copied verbatim in the file &quot;COPYING&quot;.</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// See http://alice-o2.web.cern.ch/license for full licensing information.</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// In applying this license CERN does not waive the privileges and immunities</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// granted to it by virtue of its status as an Intergovernmental Organization</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// or submit itself to any jurisdiction.</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#ifdef GPUCA_O2_LIB</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/dec/HBFUtils_8h.html">DetectorsRaw/HBFUtils.h</a>&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../da/d08/RawFileWriter_8h.html">DetectorsRaw/RawFileWriter.h</a>&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/dd6/Sector_8h.html">TPCBase/Sector.h</a>&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d7d/DataFormats_2Detectors_2TPC_2include_2DataFormatsTPC_2Digit_8h.html">DataFormatsTPC/Digit.h</a>&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/dfa/GPUReconstructionConvert_8h.html">GPUReconstructionConvert.h</a>&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/db1/TPCFastTransform_8h.html">TPCFastTransform.h</a>&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/dde/GPUTPCClusterData_8h.html">GPUTPCClusterData.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d5c/GPUO2DataTypes_8h.html">GPUO2DataTypes.h</a>&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/dc5/GPUDataTypes_8h.html">GPUDataTypes.h</a>&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/d86/AliHLTTPCRawCluster_8h.html">AliHLTTPCRawCluster.h</a>&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d13/GPUParam_8h.html">GPUParam.h</a>&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#ifdef HAVE_O2HEADERS</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/db0/clusterFinderDefs_8h.html">clusterFinderDefs.h</a>&quot;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/d04/ZeroSuppression_8h.html">DataFormatsTPC/ZeroSuppression.h</a>&quot;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d0/dda/DataFormats_2Detectors_2TPC_2include_2DataFormatsTPC_2Constants_8h.html">DataFormatsTPC/Constants.h</a>&quot;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/dbe/GPURawData_8h.html">GPURawData.h</a>&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/dc6/LHCConstants_8h.html">CommonConstants/LHCConstants.h</a>&quot;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d7d/DataFormats_2Detectors_2TPC_2include_2DataFormatsTPC_2Digit_8h.html">DataFormatsTPC/Digit.h</a>&quot;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/d0d/TPC_2base_2include_2TPCBase_2RDHUtils_8h.html">TPCBase/RDHUtils.h</a>&quot;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keyword">using namespace </span><a class="code" href="../../d8/dde/namespaceGPUCA__NAMESPACE_1_1gpu.html">GPUCA_NAMESPACE::gpu</a>;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="keyword">using namespace </span><a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html">o2::tpc</a>;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="../../d3/de2/classGPUCA__NAMESPACE_1_1gpu_1_1GPUReconstructionConvert.html#a300978b87042c1274a63e7bf7feb2b47">   44</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/de2/classGPUCA__NAMESPACE_1_1gpu_1_1GPUReconstructionConvert.html#a300978b87042c1274a63e7bf7feb2b47">GPUReconstructionConvert::ConvertNativeToClusterData</a>(<a class="code" href="../../da/d95/structo2_1_1tpc_1_1ClusterNativeAccess.html">o2::tpc::ClusterNativeAccess</a>* native, std::unique_ptr&lt;<a class="code" href="../../de/d16/structGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCClusterData.html">GPUTPCClusterData</a>[]&gt;* <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a00dc28d5db1371df938f63ad9eb450df">clusters</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>* <a class="code" href="../../d2/d12/bench__Clusterizer_8cxx.html#adc2980dd50ea866e70e476f11dca803b">nClusters</a>, <span class="keyword">const</span> <a class="code" href="../../d2/d47/classGPUCA__NAMESPACE_1_1gpu_1_1TPCFastTransform.html">TPCFastTransform</a>* transform, <span class="keywordtype">int</span> continuousMaxTimeBin)</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;{</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#ifdef HAVE_O2HEADERS</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  memset(nClusters, 0, NSLICES * <span class="keyword">sizeof</span>(nClusters[0]));</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a8e8a78e36205bada4146dc581c95f82c">offset</a> = 0;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NSLICES; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nClSlice = 0;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="../../d2/d37/GPUDefConstantsAndSettings_8h.html#afd2e13a07f9d227b8949af90d39812cf">GPUCA_ROW_COUNT</a>; j++) {</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      nClSlice += native-&gt;<a class="code" href="../../da/d95/structo2_1_1tpc_1_1ClusterNativeAccess.html#a7a32e75ccf6192097a3c78e86c6aa036">nClusters</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][j];</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    }</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    nClusters[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = nClSlice;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a00dc28d5db1371df938f63ad9eb450df">clusters</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].reset(<span class="keyword">new</span> <a class="code" href="../../de/d16/structGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCClusterData.html">GPUTPCClusterData</a>[nClSlice]);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    nClSlice = 0;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="../../d2/d37/GPUDefConstantsAndSettings_8h.html#afd2e13a07f9d227b8949af90d39812cf">GPUCA_ROW_COUNT</a>; j++) {</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; native-&gt;<a class="code" href="../../da/d95/structo2_1_1tpc_1_1ClusterNativeAccess.html#a7a32e75ccf6192097a3c78e86c6aa036">nClusters</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][j]; k++) {</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; clin = native-&gt;<a class="code" href="../../da/d95/structo2_1_1tpc_1_1ClusterNativeAccess.html#a9fef936d9bcd36d70bce4d1058642524">clusters</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][j][k];</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keywordtype">float</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a> = 0, <a class="code" href="../../dc/da3/glcorearb_8h.html#a74d80fd479c0f6d0153c709949a089ef">y</a> = 0, <a class="code" href="../../dc/da3/glcorearb_8h.html#aee38b51639b577753f6a92029fb92000">z</a> = 0;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keywordflow">if</span> (continuousMaxTimeBin == 0) {</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;          transform-&gt;Transform(<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, j, clin.getPad(), clin.getTime(), <a class="code" href="../../dc/da3/glcorearb_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a>, <a class="code" href="../../dc/da3/glcorearb_8h.html#a74d80fd479c0f6d0153c709949a089ef">y</a>, <a class="code" href="../../dc/da3/glcorearb_8h.html#aee38b51639b577753f6a92029fb92000">z</a>);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;          transform-&gt;TransformInTimeFrame(<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>, j, clin.getPad(), clin.getTime(), <a class="code" href="../../dc/da3/glcorearb_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a>, <a class="code" href="../../dc/da3/glcorearb_8h.html#a74d80fd479c0f6d0153c709949a089ef">y</a>, <a class="code" href="../../dc/da3/glcorearb_8h.html#aee38b51639b577753f6a92029fb92000">z</a>, continuousMaxTimeBin);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        }</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="keyword">auto</span>&amp; clout = <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a00dc28d5db1371df938f63ad9eb450df">clusters</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].get()[nClSlice];</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        clout.x = <a class="code" href="../../dc/da3/glcorearb_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a>;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        clout.y = <a class="code" href="../../dc/da3/glcorearb_8h.html#a74d80fd479c0f6d0153c709949a089ef">y</a>;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        clout.z = <a class="code" href="../../dc/da3/glcorearb_8h.html#aee38b51639b577753f6a92029fb92000">z</a>;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        clout.row = j;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        clout.amp = clin.qTot;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        clout.flags = clin.getFlags();</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        clout.id = offset + k;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        nClSlice++;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      }</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      native-&gt;<a class="code" href="../../da/d95/structo2_1_1tpc_1_1ClusterNativeAccess.html#a1d0678d105530d43592d904224522814">clusterOffset</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][j] = <a class="code" href="../../dc/da3/glcorearb_8h.html#a8e8a78e36205bada4146dc581c95f82c">offset</a>;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      offset += native-&gt;<a class="code" href="../../da/d95/structo2_1_1tpc_1_1ClusterNativeAccess.html#a7a32e75ccf6192097a3c78e86c6aa036">nClusters</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][j];</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    }</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  }</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;}</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="../../d3/de2/classGPUCA__NAMESPACE_1_1gpu_1_1GPUReconstructionConvert.html#a7493b506019949a8bd4b20770b50b78a">   83</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/de2/classGPUCA__NAMESPACE_1_1gpu_1_1GPUReconstructionConvert.html#a7493b506019949a8bd4b20770b50b78a">GPUReconstructionConvert::ConvertRun2RawToNative</a>(<a class="code" href="../../da/d95/structo2_1_1tpc_1_1ClusterNativeAccess.html">o2::tpc::ClusterNativeAccess</a>&amp; native, std::unique_ptr&lt;<a class="code" href="../../dc/dbc/structo2_1_1tpc_1_1ClusterNative.html">ClusterNative</a>[]&gt;&amp; nativeBuffer, <span class="keyword">const</span> <a class="code" href="../../d1/d6e/structAliHLTTPCRawCluster.html">AliHLTTPCRawCluster</a>** rawClusters, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>* nRawClusters)</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;{</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">#ifdef HAVE_O2HEADERS</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  memset((<span class="keywordtype">void</span>*)&amp;native, 0, <span class="keyword">sizeof</span>(native));</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NSLICES; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; nRawClusters[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]; j++) {</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      native.nClusters[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][rawClusters[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][j].<a class="code" href="../../d1/d6e/structAliHLTTPCRawCluster.html#af1f76318133be0055e60ce5107d89e1a">GetPadRow</a>()]++;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    }</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    native.nClustersTotal += nRawClusters[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  }</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  nativeBuffer.reset(<span class="keyword">new</span> <a class="code" href="../../dc/dbc/structo2_1_1tpc_1_1ClusterNative.html">ClusterNative</a>[native.nClustersTotal]);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  native.clustersLinear = nativeBuffer.get();</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  native.setOffsetPtrs();</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NSLICES; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="../../d2/d37/GPUDefConstantsAndSettings_8h.html#afd2e13a07f9d227b8949af90d39812cf">GPUCA_ROW_COUNT</a>; j++) {</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      native.nClusters[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][j] = 0;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    }</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; nRawClusters[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]; j++) {</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <span class="keyword">const</span> <a class="code" href="../../d1/d6e/structAliHLTTPCRawCluster.html">AliHLTTPCRawCluster</a>&amp; org = rawClusters[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][j];</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="keywordtype">int</span> row = org.<a class="code" href="../../d1/d6e/structAliHLTTPCRawCluster.html#af1f76318133be0055e60ce5107d89e1a">GetPadRow</a>();</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <a class="code" href="../../dc/dbc/structo2_1_1tpc_1_1ClusterNative.html">ClusterNative</a>&amp; c = nativeBuffer[native.clusterOffset[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][row] + native.nClusters[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][row]++];</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      c.setTimeFlags(org.<a class="code" href="../../d1/d6e/structAliHLTTPCRawCluster.html#a8c4752e6c73bb589209c38379356a005">GetTime</a>(), org.<a class="code" href="../../d1/d6e/structAliHLTTPCRawCluster.html#a663a6c02f81797b6bf08d48a17932436">GetFlags</a>());</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      c.setPad(org.<a class="code" href="../../d1/d6e/structAliHLTTPCRawCluster.html#a165e321718fc52f13afa6c6d76729b18">GetPad</a>());</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      c.setSigmaTime(std::sqrt(org.<a class="code" href="../../d1/d6e/structAliHLTTPCRawCluster.html#ab38d65c9758e13569731b9e92b2a9cda">GetSigmaTime2</a>()));</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      c.setSigmaPad(std::sqrt(org.<a class="code" href="../../d1/d6e/structAliHLTTPCRawCluster.html#add6db1f912767970e56c07c5d5af3146">GetSigmaPad2</a>()));</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      c.<a class="code" href="../../dc/dbc/structo2_1_1tpc_1_1ClusterNative.html#a3bf15f414113a6e8754942e8f58d20fa">qMax</a> = org.<a class="code" href="../../d1/d6e/structAliHLTTPCRawCluster.html#a65131359473b5d9b47b6502a4a271afc">GetQMax</a>();</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      c.<a class="code" href="../../dc/dbc/structo2_1_1tpc_1_1ClusterNative.html#a869b47009cff6108aa57d25c6916e623">qTot</a> = org.<a class="code" href="../../d1/d6e/structAliHLTTPCRawCluster.html#a52e03b2c5ee4934f85e81f10b2d6dbcb">GetCharge</a>();</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    }</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  }</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;}</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="../../d3/de2/classGPUCA__NAMESPACE_1_1gpu_1_1GPUReconstructionConvert.html#a99668d6f3f98acb42c9b284b1bb4b6bf">  115</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d3/de2/classGPUCA__NAMESPACE_1_1gpu_1_1GPUReconstructionConvert.html#a99668d6f3f98acb42c9b284b1bb4b6bf">GPUReconstructionConvert::GetMaxTimeBin</a>(<span class="keyword">const</span> <a class="code" href="../../da/d95/structo2_1_1tpc_1_1ClusterNativeAccess.html">ClusterNativeAccess</a>&amp; native)</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;{</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="preprocessor">#ifdef HAVE_O2HEADERS</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordtype">float</span> retVal = 0;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NSLICES; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="../../d2/d37/GPUDefConstantsAndSettings_8h.html#afd2e13a07f9d227b8949af90d39812cf">GPUCA_ROW_COUNT</a>; j++) {</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; native.<a class="code" href="../../da/d95/structo2_1_1tpc_1_1ClusterNativeAccess.html#a7a32e75ccf6192097a3c78e86c6aa036">nClusters</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][j]; k++) {</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordflow">if</span> (native.<a class="code" href="../../da/d95/structo2_1_1tpc_1_1ClusterNativeAccess.html#a9fef936d9bcd36d70bce4d1058642524">clusters</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][j][k].getTime() &gt; retVal) {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;          retVal = native.<a class="code" href="../../da/d95/structo2_1_1tpc_1_1ClusterNativeAccess.html#a9fef936d9bcd36d70bce4d1058642524">clusters</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][j][k].getTime();</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        }</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      }</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  }</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordflow">return</span> ceil(retVal);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;}</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="../../d3/de2/classGPUCA__NAMESPACE_1_1gpu_1_1GPUReconstructionConvert.html#a5260851e0c64d0ae34ce656ea5fc4b6c">  134</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d3/de2/classGPUCA__NAMESPACE_1_1gpu_1_1GPUReconstructionConvert.html#a99668d6f3f98acb42c9b284b1bb4b6bf">GPUReconstructionConvert::GetMaxTimeBin</a>(<span class="keyword">const</span> GPUTrackingInOutDigits&amp; digits)</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;{</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="preprocessor">#ifdef HAVE_O2HEADERS</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordtype">float</span> retVal = 0;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NSLICES; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; digits.nTPCDigits[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]; k++) {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="keywordflow">if</span> (digits.tpcDigits[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][k].getTimeStamp() &gt; retVal) {</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        retVal = digits.tpcDigits[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][k].getTimeStamp();</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    }</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  }</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordflow">return</span> ceil(retVal);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;}</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="../../d3/de2/classGPUCA__NAMESPACE_1_1gpu_1_1GPUReconstructionConvert.html#a4d0c88f55a84e08f0a309b9a1ad0bf28">  151</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d3/de2/classGPUCA__NAMESPACE_1_1gpu_1_1GPUReconstructionConvert.html#a99668d6f3f98acb42c9b284b1bb4b6bf">GPUReconstructionConvert::GetMaxTimeBin</a>(<span class="keyword">const</span> GPUTrackingInOutZS&amp; zspages)</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;{</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="preprocessor">#ifdef HAVE_O2HEADERS</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordtype">float</span> retVal = 0;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NSLICES; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordtype">int</span> firstHBF = zspages.slice[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].count[0] ? o2::raw::RDHUtils::getHeartBeatOrbit(*(<span class="keyword">const</span> <a class="code" href="../../d8/d47/structo2_1_1header_1_1RAWDataHeaderV4.html">o2::header::RAWDataHeader</a>*)zspages.slice[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].zsPtr[0][0]) : 0;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; GPUTrackingInOutZS::NENDPOINTS; j++) {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; zspages.slice[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].count[j]; k++) {</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>* page = (<span class="keyword">const</span> <span class="keywordtype">char</span>*)zspages.slice[i].zsPtr[j][k];</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <a class="code" href="../../d8/df7/BenchCathodeSegmentation_8cxx.html#ad6a7b6b73caa2bc27f897bd23d8740ec">for</a> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> l = 0; l &lt; zspages.slice[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].nZSPtr[j][k]; l++) {</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;          <a class="code" href="../../d8/d47/structo2_1_1header_1_1RAWDataHeaderV4.html">o2::header::RAWDataHeader</a>* rdh = (<a class="code" href="../../d8/d47/structo2_1_1header_1_1RAWDataHeaderV4.html">o2::header::RAWDataHeader</a>*)(page + l * TPCZSHDR::TPC_ZS_PAGE_SIZE);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;          <a class="code" href="../../dc/d83/structo2_1_1tpc_1_1TPCZSHDR.html">TPCZSHDR</a>* hdr = (<a class="code" href="../../dc/d83/structo2_1_1tpc_1_1TPCZSHDR.html">TPCZSHDR</a>*)(page + l * TPCZSHDR::TPC_ZS_PAGE_SIZE + <span class="keyword">sizeof</span>(<a class="code" href="../../d8/d47/structo2_1_1header_1_1RAWDataHeaderV4.html">o2::header::RAWDataHeader</a>));</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> timeBin = (hdr-&gt;<a class="code" href="../../dc/d83/structo2_1_1tpc_1_1TPCZSHDR.html#a70643353af25100617d427a9f044ea43">timeOffset</a> + (o2::raw::RDHUtils::getHeartBeatOrbit(*rdh) - firstHBF) * o2::constants::lhc::LHCMaxBunches) / Constants::LHCBCPERTIMEBIN + hdr-&gt;<a class="code" href="../../dc/d83/structo2_1_1tpc_1_1TPCZSHDR.html#a06ec33001ad93d5aa2fa1e933fdd36f3">nTimeBins</a>;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;          <span class="keywordflow">if</span> (timeBin &gt; retVal) {</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            retVal = timeBin;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;          }</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        }</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      }</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    }</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  }</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keywordflow">return</span> ceil(retVal);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;}</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="keywordtype">void</span> GPUReconstructionConvert::ZSstreamOut(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>* bufIn, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; lenIn, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* bufOut, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&amp; lenOut, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nBits)</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;{</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d7c/namespaceo2.html#a43c0bd48129b9b3448436996f35ffbc5">byte</a> = 0, <a class="code" href="../../dc/da3/glcorearb_8h.html#a8dc2cc80c52413d48ac45732e90d3a66">bits</a> = 0;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#ae1838b9db98fcca9cd79d66954101c9f">mask</a> = (1 &lt;&lt; nBits) - 1;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; lenIn; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    byte |= (bufIn[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] &amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#ae1838b9db98fcca9cd79d66954101c9f">mask</a>) &lt;&lt; <a class="code" href="../../dc/da3/glcorearb_8h.html#a8dc2cc80c52413d48ac45732e90d3a66">bits</a>;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="../../dc/da3/glcorearb_8h.html#a8dc2cc80c52413d48ac45732e90d3a66">bits</a> += nBits;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="../../dc/da3/glcorearb_8h.html#a8dc2cc80c52413d48ac45732e90d3a66">bits</a> &gt;= 8) {</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      bufOut[lenOut++] = (<span class="keywordtype">unsigned</span> char)(byte &amp; 0xFF);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      byte = byte &gt;&gt; 8;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <a class="code" href="../../dc/da3/glcorearb_8h.html#a8dc2cc80c52413d48ac45732e90d3a66">bits</a> -= 8;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    }</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  }</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dc/da3/glcorearb_8h.html#a8dc2cc80c52413d48ac45732e90d3a66">bits</a>) {</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    bufOut[lenOut++] = <a class="code" href="../../d4/d7c/namespaceo2.html#a43c0bd48129b9b3448436996f35ffbc5">byte</a>;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  }</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  lenIn = 0;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;}</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="preprocessor">#ifdef HAVE_O2HEADERS</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="keywordtype">void</span> GPUReconstructionConvert::ZSfillEmpty(<span class="keywordtype">void</span>* ptr, <span class="keywordtype">int</span> shift)</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;{</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <a class="code" href="../../d8/d47/structo2_1_1header_1_1RAWDataHeaderV4.html">o2::header::RAWDataHeader</a>* rdh = (<a class="code" href="../../d8/d47/structo2_1_1header_1_1RAWDataHeaderV4.html">o2::header::RAWDataHeader</a>*)ptr;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <a class="code" href="../../da/d2c/structo2_1_1raw_1_1RDHUtils.html#ae2e5db94ad33a3126cdbb1ba437a8271">o2::raw::RDHUtils::setHeartBeatOrbit</a>(*rdh, 0);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  o2::raw::RDHUtils::setHeartBeatBC(*rdh, shift);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <a class="code" href="../../da/d2c/structo2_1_1raw_1_1RDHUtils.html#aa3f3c16f28a6ea1526d0944b5ed63681">o2::raw::RDHUtils::setMemorySize</a>(*rdh, <span class="keyword">sizeof</span>(<a class="code" href="../../d8/d47/structo2_1_1header_1_1RAWDataHeaderV4.html">o2::header::RAWDataHeader</a>));</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;}</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">auto</span> ZSEncoderGetDigits(<span class="keyword">const</span> GPUTrackingInOutDigits&amp; in, <span class="keywordtype">int</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>) { <span class="keywordflow">return</span> in.tpcDigits[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]; }</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">auto</span> ZSEncoderGetNDigits(<span class="keyword">const</span> GPUTrackingInOutDigits&amp; in, <span class="keywordtype">int</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>) { <span class="keywordflow">return</span> in.nTPCDigits[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]; }</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="keyword">template</span> <span class="keywordtype">void</span> GPUReconstructionConvert::RunZSEncoder&lt;o2::tpc::Digit, GPUTrackingInOutDigits&gt;(<span class="keyword">const</span> GPUTrackingInOutDigits&amp;, std::unique_ptr&lt;unsigned long long int[]&gt;*, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>*, <a class="code" href="../../d0/d0d/classo2_1_1raw_1_1RawFileWriter.html">o2::raw::RawFileWriter</a>*, <span class="keyword">const</span> <a class="code" href="../../d1/d21/structo2_1_1InteractionRecord.html">o2::InteractionRecord</a>*, <span class="keyword">const</span> <a class="code" href="../../da/daf/structGPUCA__NAMESPACE_1_1gpu_1_1GPUParam.html">GPUParam</a>&amp;, <a class="code" href="../../d8/de9/qconfigoptions_8h.html#aa1bc83c2f27c6427080c2ba02be21feb">bool</a>, <a class="code" href="../../d8/de9/qconfigoptions_8h.html#aa1bc83c2f27c6427080c2ba02be21feb">bool</a>, <a class="code" href="../../d8/de9/qconfigoptions_8h.html#af38f59778a92ac6d4aa7b1eeec5c5ed2">float</a>, <a class="code" href="../../d8/de9/qconfigoptions_8h.html#aa1bc83c2f27c6427080c2ba02be21feb">bool</a>);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="preprocessor">#ifdef GPUCA_O2_LIB</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="keyword">using</span> <a class="code" href="../../df/d6c/convertDigitsToRawZS_8cxx.html#a916fcf3a51816de2e63dda5b66a89d48">DigitArray</a> = std::array&lt;gsl::span&lt;const o2::tpc::Digit&gt;, <a class="code" href="../../d0/d0c/classo2_1_1tpc_1_1Sector.html#ac8b33b4c676a81bba75f8c3c5d4dc11e">o2::tpc::Sector::MAXSECTOR</a>&gt;;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="keyword">template</span> <span class="keywordtype">void</span> GPUReconstructionConvert::RunZSEncoder&lt;o2::tpc::Digit, DigitArray&gt;(<span class="keyword">const</span> <a class="code" href="../../df/d6c/convertDigitsToRawZS_8cxx.html#a916fcf3a51816de2e63dda5b66a89d48">DigitArray</a>&amp;, std::unique_ptr&lt;unsigned long long int[]&gt;*, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>*, <a class="code" href="../../d0/d0d/classo2_1_1raw_1_1RawFileWriter.html">o2::raw::RawFileWriter</a>*, <span class="keyword">const</span> <a class="code" href="../../d1/d21/structo2_1_1InteractionRecord.html">o2::InteractionRecord</a>*, <span class="keyword">const</span> <a class="code" href="../../da/daf/structGPUCA__NAMESPACE_1_1gpu_1_1GPUParam.html">GPUParam</a>&amp;, <a class="code" href="../../d8/de9/qconfigoptions_8h.html#aa1bc83c2f27c6427080c2ba02be21feb">bool</a>, <a class="code" href="../../d8/de9/qconfigoptions_8h.html#aa1bc83c2f27c6427080c2ba02be21feb">bool</a>, <a class="code" href="../../d8/de9/qconfigoptions_8h.html#af38f59778a92ac6d4aa7b1eeec5c5ed2">float</a>, <a class="code" href="../../d8/de9/qconfigoptions_8h.html#aa1bc83c2f27c6427080c2ba02be21feb">bool</a>);</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">auto</span> ZSEncoderGetDigits(<span class="keyword">const</span> <a class="code" href="../../df/d6c/convertDigitsToRawZS_8cxx.html#a916fcf3a51816de2e63dda5b66a89d48">DigitArray</a>&amp; in, <span class="keywordtype">int</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>) { <span class="keywordflow">return</span> in[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].data(); }</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">auto</span> ZSEncoderGetNDigits(<span class="keyword">const</span> <a class="code" href="../../df/d6c/convertDigitsToRawZS_8cxx.html#a916fcf3a51816de2e63dda5b66a89d48">DigitArray</a>&amp; in, <span class="keywordtype">int</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>) { <span class="keywordflow">return</span> in[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].size(); }</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">auto</span> ZSEncoderGetTime(<span class="keyword">const</span> <a class="code" href="../../d1/d46/classo2_1_1tpc_1_1Digit.html">o2::tpc::Digit</a> <a class="code" href="../../dc/da3/glcorearb_8h.html#ac8729153468b5dcf13f971b21d84d4e5">a</a>) { <span class="keywordflow">return</span> a.getTimeStamp(); }</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">auto</span> ZSEncoderGetPad(<span class="keyword">const</span> <a class="code" href="../../d1/d46/classo2_1_1tpc_1_1Digit.html">o2::tpc::Digit</a> a) { <span class="keywordflow">return</span> a.getPad(); }</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">auto</span> ZSEncoderGetRow(<span class="keyword">const</span> <a class="code" href="../../d1/d46/classo2_1_1tpc_1_1Digit.html">o2::tpc::Digit</a> a) { <span class="keywordflow">return</span> a.getRow(); }</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">auto</span> ZSEncoderGetCharge(<span class="keyword">const</span> <a class="code" href="../../d1/d46/classo2_1_1tpc_1_1Digit.html">o2::tpc::Digit</a> a) { <span class="keywordflow">return</span> a.getChargeFloat(); }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T, <span class="keyword">class</span> S&gt;</div><div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="../../d3/de2/classGPUCA__NAMESPACE_1_1gpu_1_1GPUReconstructionConvert.html#a3c48646598a6087eb967425434eabc00">  221</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/de2/classGPUCA__NAMESPACE_1_1gpu_1_1GPUReconstructionConvert.html#a3c48646598a6087eb967425434eabc00">GPUReconstructionConvert::RunZSEncoder</a>(<span class="keyword">const</span> <a class="code" href="../../d1/d6a/structS.html">S</a>&amp; in, std::unique_ptr&lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>[]&gt;* outBuffer, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>* outSizes, <a class="code" href="../../d0/d0d/classo2_1_1raw_1_1RawFileWriter.html">o2::raw::RawFileWriter</a>* raw, <span class="keyword">const</span> <a class="code" href="../../d1/d21/structo2_1_1InteractionRecord.html">o2::InteractionRecord</a>* ir, <span class="keyword">const</span> <a class="code" href="../../da/daf/structGPUCA__NAMESPACE_1_1gpu_1_1GPUParam.html">GPUParam</a>&amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>, <span class="keywordtype">bool</span> zs12bit, <span class="keywordtype">bool</span> verify, <span class="keywordtype">float</span> <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a2b8298cdaa115e10085952184e21fa2f">threshold</a>, <span class="keywordtype">bool</span> padding)</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;{</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="comment">// Pass in either outBuffer / outSizes, to fill standalone output buffers, or raw / ir to use RawFileWriter</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="comment">// ir is the interaction record for time bin 0</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keywordflow">if</span> (((outBuffer == <span class="keyword">nullptr</span>) ^ (outSizes == <span class="keyword">nullptr</span>)) || ((raw != <span class="keyword">nullptr</span>) &amp;&amp; (ir == <span class="keyword">nullptr</span>)) || !((outBuffer == <span class="keyword">nullptr</span>) ^ (raw == <span class="keyword">nullptr</span>)) || (raw &amp;&amp; verify) || (threshold &gt; 0.<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a> &amp;&amp; verify)) {</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Invalid parameters&quot;</span>);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  }</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="preprocessor">#ifdef GPUCA_TPC_GEOMETRY_O2</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <a class="code" href="../../dd/d2d/namespaceo2_1_1pmr.html#aeea588f6ab06f06d4131f84d8eea272b">std::vector</a>&lt;std::array&lt;<span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="../../d8/de9/qconfigoptions_8h.html#ad08a37964429d340d966dfa679443e8f">int</a>, TPCZSHDR::TPC_ZS_PAGE_SIZE / <span class="keyword">sizeof</span>(<span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="../../d8/de9/qconfigoptions_8h.html#ad08a37964429d340d966dfa679443e8f">int</a>)&gt;&gt; <a class="code" href="../../dc/da3/glcorearb_8h.html#a3667f558219c90437106b544a3ca00b8">buffer</a>[NSLICES][GPUTrackingInOutZS::NENDPOINTS];</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> totalPages = 0;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keywordtype">size_t</span> nErrors = 0;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keywordtype">int</span> encodeBits = zs12bit ? TPCZSHDR::TPC_ZS_NBITS_V2 : TPCZSHDR::TPC_ZS_NBITS_V1;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> encodeBitsFactor = (1 &lt;&lt; (encodeBits - 10));</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="comment">// clang-format off</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <a class="code" href="../../d6/dff/GPUDefMacros_8h.html#a8f5eec32d1a68364e1f8686a03170527">GPUCA_OPENMP</a>(<a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#a930799bc13c911ce05e376c5b6c8ac09">parallel</a> <span class="keywordflow">for</span> reduction(+ : totalPages) reduction(+ : nErrors))</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="comment">// clang-format on</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NSLICES; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    std::array&lt;<span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="../../d8/de9/qconfigoptions_8h.html#ad08a37964429d340d966dfa679443e8f">int</a>, TPCZSHDR::TPC_ZS_PAGE_SIZE / <span class="keyword">sizeof</span>(<span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="../../d8/de9/qconfigoptions_8h.html#ad08a37964429d340d966dfa679443e8f">int</a>)&gt; singleBuffer;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="preprocessor">#ifdef GPUCA_O2_LIB</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordtype">int</span> rawlnk = rdh_utils::UserLogicLinkID;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordtype">int</span> bcShiftInFirstHBF = ir ? ir-&gt;<a class="code" href="../../d1/d21/structo2_1_1InteractionRecord.html#a4dd7d03ed59d92173589ba61165873ab">bc</a> : 0;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordtype">int</span> bcShiftInFirstHBF = 0;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordtype">int</span> rawcru = 0;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordtype">int</span> rawendpoint = 0;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    (<a class="code" href="../../dc/da3/glcorearb_8h.html#a950fc91edb4504f62f1c577bf4727c29">void</a>)(rawcru + rawendpoint); <span class="comment">// avoid compiler warning</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    std::vector&lt;T&gt; tmpBuffer;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    std::array&lt;unsigned short, TPCZSHDR::TPC_ZS_PAGE_SIZE&gt; streamBuffer;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    std::array&lt;unsigned char, TPCZSHDR::TPC_ZS_PAGE_SIZE&gt; streamBuffer8;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    tmpBuffer.resize(ZSEncoderGetNDigits(in, <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">if</span> (threshold &gt; 0.<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a>) {</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="keyword">auto</span> it = std::copy_if(ZSEncoderGetDigits(in, <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>), ZSEncoderGetDigits(in, <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>) + ZSEncoderGetNDigits(in, <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>), tmpBuffer.begin(), [<a class="code" href="../../d8/de9/qconfigoptions_8h.html#a2b8298cdaa115e10085952184e21fa2f">threshold</a>](<span class="keyword">auto</span>&amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#a4568fc090febc136eed4577a600739ca">v</a>) { <span class="keywordflow">return</span> ZSEncoderGetCharge(<a class="code" href="../../dc/da3/glcorearb_8h.html#a4568fc090febc136eed4577a600739ca">v</a>) &gt;= <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a2b8298cdaa115e10085952184e21fa2f">threshold</a>; });</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      tmpBuffer.resize(<a class="code" href="../../dc/da3/glcorearb_8h.html#a744fbed01658cb96bb8ba7e85a86d1dc">std::distance</a>(tmpBuffer.begin(), it));</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      std::copy(ZSEncoderGetDigits(in, <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>), ZSEncoderGetDigits(in, <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>) + ZSEncoderGetNDigits(in, <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>), tmpBuffer.begin());</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    }</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    std::sort(tmpBuffer.begin(), tmpBuffer.end(), [&amp;<a class="code" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>](<span class="keyword">const</span> <a class="code" href="../../d1/def/classT.html">T</a> <a class="code" href="../../dc/da3/glcorearb_8h.html#ac8729153468b5dcf13f971b21d84d4e5">a</a>, <span class="keyword">const</span> <a class="code" href="../../d1/def/classT.html">T</a> <a class="code" href="../../dc/da3/glcorearb_8h.html#a6eba317e3cf44d6d26c04a5a8f197dcb">b</a>) {</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      <span class="keywordtype">int</span> endpointa = param.<a class="code" href="../../da/daf/structGPUCA__NAMESPACE_1_1gpu_1_1GPUParam.html#a22fe417c0550ad7cc062d0062425c26a">tpcGeometry</a>.GetRegion(ZSEncoderGetRow(a));</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <span class="keywordtype">int</span> endpointb = param.<a class="code" href="../../da/daf/structGPUCA__NAMESPACE_1_1gpu_1_1GPUParam.html#a22fe417c0550ad7cc062d0062425c26a">tpcGeometry</a>.GetRegion(ZSEncoderGetRow(<a class="code" href="../../dc/da3/glcorearb_8h.html#a6eba317e3cf44d6d26c04a5a8f197dcb">b</a>));</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      endpointa = 2 * endpointa + (ZSEncoderGetRow(a) &gt;= param.<a class="code" href="../../da/daf/structGPUCA__NAMESPACE_1_1gpu_1_1GPUParam.html#a22fe417c0550ad7cc062d0062425c26a">tpcGeometry</a>.GetRegionStart(endpointa) + param.<a class="code" href="../../da/daf/structGPUCA__NAMESPACE_1_1gpu_1_1GPUParam.html#a22fe417c0550ad7cc062d0062425c26a">tpcGeometry</a>.GetRegionRows(endpointa) / 2);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      endpointb = 2 * endpointb + (ZSEncoderGetRow(<a class="code" href="../../dc/da3/glcorearb_8h.html#a6eba317e3cf44d6d26c04a5a8f197dcb">b</a>) &gt;= param.<a class="code" href="../../da/daf/structGPUCA__NAMESPACE_1_1gpu_1_1GPUParam.html#a22fe417c0550ad7cc062d0062425c26a">tpcGeometry</a>.GetRegionStart(endpointb) + param.<a class="code" href="../../da/daf/structGPUCA__NAMESPACE_1_1gpu_1_1GPUParam.html#a22fe417c0550ad7cc062d0062425c26a">tpcGeometry</a>.GetRegionRows(endpointb) / 2);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="keywordflow">if</span> (endpointa != endpointb) {</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordflow">return</span> endpointa &lt;= endpointb;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      }</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <span class="keywordflow">if</span> (ZSEncoderGetTime(a) != ZSEncoderGetTime(<a class="code" href="../../dc/da3/glcorearb_8h.html#a6eba317e3cf44d6d26c04a5a8f197dcb">b</a>)) {</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="keywordflow">return</span> ZSEncoderGetTime(a) &lt;= ZSEncoderGetTime(<a class="code" href="../../dc/da3/glcorearb_8h.html#a6eba317e3cf44d6d26c04a5a8f197dcb">b</a>);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      }</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <span class="keywordflow">if</span> (ZSEncoderGetRow(a) != ZSEncoderGetRow(<a class="code" href="../../dc/da3/glcorearb_8h.html#a6eba317e3cf44d6d26c04a5a8f197dcb">b</a>)) {</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keywordflow">return</span> ZSEncoderGetRow(a) &lt;= ZSEncoderGetRow(<a class="code" href="../../dc/da3/glcorearb_8h.html#a6eba317e3cf44d6d26c04a5a8f197dcb">b</a>);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      }</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="keywordflow">return</span> ZSEncoderGetPad(a) &lt;= ZSEncoderGetPad(<a class="code" href="../../dc/da3/glcorearb_8h.html#a6eba317e3cf44d6d26c04a5a8f197dcb">b</a>);</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    });</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordtype">int</span> lastEndpoint = -1, lastRow = <a class="code" href="../../d2/d37/GPUDefConstantsAndSettings_8h.html#afd2e13a07f9d227b8949af90d39812cf">GPUCA_ROW_COUNT</a>, lastTime = -1;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordtype">long</span> hbf = -1, nexthbf = 0;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    std::array&lt;<span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="../../d8/de9/qconfigoptions_8h.html#ad08a37964429d340d966dfa679443e8f">int</a>, TPCZSHDR::TPC_ZS_PAGE_SIZE / <span class="keyword">sizeof</span>(<span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="../../d8/de9/qconfigoptions_8h.html#ad08a37964429d340d966dfa679443e8f">int</a>)&gt;* page = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <a class="code" href="../../dc/d83/structo2_1_1tpc_1_1TPCZSHDR.html">TPCZSHDR</a>* hdr = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <a class="code" href="../../d6/d04/structo2_1_1tpc_1_1TPCZSTBHDR.html">TPCZSTBHDR</a>* tbHdr = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* pagePtr = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* nSeq = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordtype">int</span> nRowsInTB = 0;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordtype">int</span> region = 0, endpoint = 0, endpointStart = 0;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> streamSize = 0, streamSize8 = 0;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt;= tmpBuffer.size(); k++) {</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      <span class="keywordtype">int</span> seqLen = 1;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <span class="keywordflow">if</span> (k &lt; tmpBuffer.size()) {</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="keywordflow">if</span> (lastRow != ZSEncoderGetRow(tmpBuffer[k])) {</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;          region = param.<a class="code" href="../../da/daf/structGPUCA__NAMESPACE_1_1gpu_1_1GPUParam.html#a22fe417c0550ad7cc062d0062425c26a">tpcGeometry</a>.GetRegion(ZSEncoderGetRow(tmpBuffer[k]));</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;          endpointStart = param.<a class="code" href="../../da/daf/structGPUCA__NAMESPACE_1_1gpu_1_1GPUParam.html#a22fe417c0550ad7cc062d0062425c26a">tpcGeometry</a>.GetRegionStart(region);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;          endpoint = region * 2;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;          <span class="keywordflow">if</span> (ZSEncoderGetRow(tmpBuffer[k]) &gt;= endpointStart + param.<a class="code" href="../../da/daf/structGPUCA__NAMESPACE_1_1gpu_1_1GPUParam.html#a22fe417c0550ad7cc062d0062425c26a">tpcGeometry</a>.GetRegionRows(region) / 2) {</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            endpoint++;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            endpointStart += param.<a class="code" href="../../da/daf/structGPUCA__NAMESPACE_1_1gpu_1_1GPUParam.html#a22fe417c0550ad7cc062d0062425c26a">tpcGeometry</a>.GetRegionRows(region) / 2;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;          }</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        }</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> l = k + 1; l &lt; tmpBuffer.size(); l++) {</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;          <span class="keywordflow">if</span> (ZSEncoderGetRow(tmpBuffer[l]) == ZSEncoderGetRow(tmpBuffer[k]) &amp;&amp; ZSEncoderGetTime(tmpBuffer[l]) == ZSEncoderGetTime(tmpBuffer[k]) &amp;&amp; ZSEncoderGetPad(tmpBuffer[l]) == ZSEncoderGetPad(tmpBuffer[l - 1]) + 1) {</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            seqLen++;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;          } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;          }</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        }</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="keywordflow">if</span> (lastTime != -1 &amp;&amp; (<span class="keywordtype">int</span>)hdr-&gt;<a class="code" href="../../dc/d83/structo2_1_1tpc_1_1TPCZSHDR.html#a06ec33001ad93d5aa2fa1e933fdd36f3">nTimeBins</a> + ZSEncoderGetTime(tmpBuffer[k]) - lastTime &gt;= 256) {</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;          lastEndpoint = -1;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        }</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keywordflow">if</span> (ZSEncoderGetTime(tmpBuffer[k]) != lastTime) {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;          nexthbf = ((long)ZSEncoderGetTime(tmpBuffer[k]) * Constants::LHCBCPERTIMEBIN + bcShiftInFirstHBF) / o2::constants::lhc::LHCMaxBunches;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;          <span class="keywordflow">if</span> (hbf != nexthbf) {</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            lastEndpoint = -2;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;          }</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        }</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="keywordflow">if</span> (endpoint == lastEndpoint) {</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sizeChk = (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/de9/qconfigoptions_8h.html#ad08a37964429d340d966dfa679443e8f">int</a>)(pagePtr - reinterpret_cast&lt;unsigned char*&gt;(page));                                              <span class="comment">// already written</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;          sizeChk += 2 * (nRowsInTB + (ZSEncoderGetRow(tmpBuffer[k]) != lastRow &amp;&amp; ZSEncoderGetTime(tmpBuffer[k]) == lastTime));                <span class="comment">// TB HDR</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;          sizeChk += streamSize8;                                                                                                               <span class="comment">// in stream buffer</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;          sizeChk += (lastTime != ZSEncoderGetTime(tmpBuffer[k])) &amp;&amp; ((sizeChk + (streamSize * encodeBits + 7) / 8) &amp; 1);                       <span class="comment">// time bin alignment</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;          sizeChk += (ZSEncoderGetTime(tmpBuffer[k]) != lastTime || ZSEncoderGetRow(tmpBuffer[k]) != lastRow) ? 3 : 0;                          <span class="comment">// new row overhead</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;          sizeChk += (lastTime != -1 &amp;&amp; ZSEncoderGetTime(tmpBuffer[k]) &gt; lastTime) ? ((ZSEncoderGetTime(tmpBuffer[k]) - lastTime - 1) * 2) : 0; <span class="comment">// empty time bins</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;          sizeChk += 2;                                                                                                                         <span class="comment">// sequence metadata</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> streamSizeChkBits = streamSize * encodeBits + ((lastTime != ZSEncoderGetTime(tmpBuffer[k]) &amp;&amp; (streamSize * encodeBits) % 8) ? (8 - (streamSize * encodeBits) % 8) : 0);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;          <span class="keywordflow">if</span> (sizeChk + (encodeBits + streamSizeChkBits + 7) / 8 &gt; TPCZSHDR::TPC_ZS_PAGE_SIZE) {</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            lastEndpoint = -1;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sizeChk + (seqLen * encodeBits + streamSizeChkBits + 7) / 8 &gt; TPCZSHDR::TPC_ZS_PAGE_SIZE) {</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            seqLen = ((TPCZSHDR::TPC_ZS_PAGE_SIZE - sizeChk) * 8 - streamSizeChkBits) / encodeBits;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;          }</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;          <span class="comment">// sizeChk += (seqLen * encodeBits + streamSizeChkBits + 7) / 8;</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;          <span class="comment">// printf(&quot;Endpoint %d (%d), Pos %d, Chk %d, Len %d, rows %d, StreamSize %d %d, time %d (%d), row %d (%d), pad %d\n&quot;, endpoint, lastEndpoint, (int) (pagePtr - reinterpret_cast&lt;unsigned char*&gt;(page)), sizeChk, seqLen, nRowsInTB, streamSize8, streamSize, (int) ZSEncoderGetTime(tmpBuffer[k]), lastTime, (int) ZSEncoderGetRow(tmpBuffer[k]), lastRow, ZSEncoderGetPad(tmpBuffer[k]));</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        }</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      }</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      <span class="keywordflow">if</span> (k &gt;= tmpBuffer.size() || endpoint != lastEndpoint || ZSEncoderGetTime(tmpBuffer[k]) != lastTime) {</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="keywordflow">if</span> (pagePtr != reinterpret_cast&lt;unsigned char*&gt;(page)) {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;          pagePtr += 2 * nRowsInTB;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;          ZSstreamOut(streamBuffer.data(), streamSize, streamBuffer8.data(), streamSize8, encodeBits);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;          pagePtr = std::copy(streamBuffer8.data(), streamBuffer8.data() + streamSize8, pagePtr);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;          <span class="keywordflow">if</span> (pagePtr - reinterpret_cast&lt;unsigned char*&gt;(page) &gt; 8192) {</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;internal error during ZS encoding&quot;</span>);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;          }</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;          streamSize8 = 0;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l = 1; l &lt; nRowsInTB; l++) {</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            tbHdr-&gt;rowAddr1()[l - 1] += 2 * nRowsInTB;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;          }</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        }</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keywordflow">if</span> (page &amp;&amp; (k &gt;= tmpBuffer.size() || endpoint != lastEndpoint)) {</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="preprocessor">#ifdef GPUCA_O2_LIB</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;          <span class="keywordflow">if</span> (raw) {</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            <span class="keyword">const</span> <a class="code" href="../../d3/d5b/namespaceo2_1_1tpc_1_1rdh__utils.html#a42665a9cc0d8132098f2d36794d6923a">rdh_utils::FEEIDType</a> rawfeeid = rdh_utils::getFEEID(rawcru, rawendpoint, rawlnk);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            <span class="keywordtype">size_t</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a3d1e3edfcf61ca2d831883e1afbad89e">size</a> = (padding || lastEndpoint == -1) ? TPCZSHDR::TPC_ZS_PAGE_SIZE : (pagePtr - (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)page);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            size = CAMath::nextMultipleOf&lt;o2::raw::RDHUtils::GBTWord&gt;(<a class="code" href="../../d8/dde/namespaceGPUCA__NAMESPACE_1_1gpu.html#a936e7e1d3f59c6e9a0301dc3b4a1c436">size</a>);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            raw-&gt;<a class="code" href="../../d0/d0d/classo2_1_1raw_1_1RawFileWriter.html#a12043623a0f1b0867628da945ddddadb">addData</a>(rawfeeid, rawcru, rawlnk, rawendpoint, *ir + hbf * o2::constants::lhc::LHCMaxBunches, gsl::span&lt;char&gt;((<span class="keywordtype">char</span>*)page + <span class="keyword">sizeof</span>(<a class="code" href="../../d8/d47/structo2_1_1header_1_1RAWDataHeaderV4.html">o2::header::RAWDataHeader</a>), (<span class="keywordtype">char</span>*)page + size), <span class="keyword">true</span>);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;          } <span class="keywordflow">else</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;          {</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            <a class="code" href="../../d8/d47/structo2_1_1header_1_1RAWDataHeaderV4.html">o2::header::RAWDataHeader</a>* rdh = (<a class="code" href="../../d8/d47/structo2_1_1header_1_1RAWDataHeaderV4.html">o2::header::RAWDataHeader</a>*)page;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            <a class="code" href="../../da/d2c/structo2_1_1raw_1_1RDHUtils.html#ae2e5db94ad33a3126cdbb1ba437a8271">o2::raw::RDHUtils::setHeartBeatOrbit</a>(*rdh, hbf);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            o2::raw::RDHUtils::setHeartBeatBC(*rdh, bcShiftInFirstHBF);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            <a class="code" href="../../da/d2c/structo2_1_1raw_1_1RDHUtils.html#aa3f3c16f28a6ea1526d0944b5ed63681">o2::raw::RDHUtils::setMemorySize</a>(*rdh, TPCZSHDR::TPC_ZS_PAGE_SIZE);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;          }</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        }</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keywordflow">if</span> (k &gt;= tmpBuffer.size()) {</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        }</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      }</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="keywordflow">if</span> (endpoint != lastEndpoint) {</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="keywordflow">if</span> (raw) {</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;          page = &amp;singleBuffer;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dc/da3/glcorearb_8h.html#a3667f558219c90437106b544a3ca00b8">buffer</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][endpoint].<a class="code" href="../../d8/dde/namespaceGPUCA__NAMESPACE_1_1gpu.html#a936e7e1d3f59c6e9a0301dc3b4a1c436">size</a>() == 0 &amp;&amp; nexthbf != 0) {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            <span class="comment">// Emplace empty page with RDH containing beginning of TFgpuDigitsMap</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            <a class="code" href="../../dc/da3/glcorearb_8h.html#a3667f558219c90437106b544a3ca00b8">buffer</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][endpoint].emplace_back();</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            ZSfillEmpty(&amp;<a class="code" href="../../dc/da3/glcorearb_8h.html#a3667f558219c90437106b544a3ca00b8">buffer</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][endpoint].back(), bcShiftInFirstHBF);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            totalPages++;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;          }</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;          <a class="code" href="../../dc/da3/glcorearb_8h.html#a3667f558219c90437106b544a3ca00b8">buffer</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][endpoint].emplace_back();</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;          page = &amp;<a class="code" href="../../dc/da3/glcorearb_8h.html#a3667f558219c90437106b544a3ca00b8">buffer</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][endpoint].back();</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        }</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        hbf = nexthbf;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        pagePtr = <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(page);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        std::fill(page-&gt;begin(), page-&gt;end(), 0);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        pagePtr += <span class="keyword">sizeof</span>(<a class="code" href="../../de/dd4/namespaceo2_1_1header.html#a1382d043a29d3edd8ec00b89e0f89fa6">o2::header::RAWDataHeader</a>);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        hdr = <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="../../dc/d83/structo2_1_1tpc_1_1TPCZSHDR.html">TPCZSHDR</a>*<span class="keyword">&gt;</span>(pagePtr);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        pagePtr += <span class="keyword">sizeof</span>(*hdr);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        hdr-&gt;<a class="code" href="../../dc/d83/structo2_1_1tpc_1_1TPCZSHDR.html#a67b8704cce7b6e0e03b8b8c0ee90c4cc">version</a> = zs12bit ? 2 : 1;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        hdr-&gt;<a class="code" href="../../dc/d83/structo2_1_1tpc_1_1TPCZSHDR.html#a7e8208e4566edfd6ec50cf03b13ae091">cruID</a> = <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> * 10 + region;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        rawcru = <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> * 10 + region;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        rawendpoint = endpoint &amp; 1;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        hdr-&gt;<a class="code" href="../../dc/d83/structo2_1_1tpc_1_1TPCZSHDR.html#a70643353af25100617d427a9f044ea43">timeOffset</a> = ZSEncoderGetTime(tmpBuffer[k]) * Constants::LHCBCPERTIMEBIN - (hbf - 0) * o2::constants::lhc::LHCMaxBunches;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        lastTime = -1;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        tbHdr = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        lastEndpoint = endpoint;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        totalPages++;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      }</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <span class="keywordflow">if</span> (ZSEncoderGetTime(tmpBuffer[k]) != lastTime) {</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="keywordflow">if</span> (lastTime != -1) {</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;          hdr-&gt;<a class="code" href="../../dc/d83/structo2_1_1tpc_1_1TPCZSHDR.html#a06ec33001ad93d5aa2fa1e933fdd36f3">nTimeBins</a> += ZSEncoderGetTime(tmpBuffer[k]) - lastTime - 1;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;          pagePtr += (ZSEncoderGetTime(tmpBuffer[k]) - lastTime - 1) * 2;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        }</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        hdr-&gt;<a class="code" href="../../dc/d83/structo2_1_1tpc_1_1TPCZSHDR.html#a06ec33001ad93d5aa2fa1e933fdd36f3">nTimeBins</a>++;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        lastTime = ZSEncoderGetTime(tmpBuffer[k]);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="keywordflow">if</span> ((pagePtr - reinterpret_cast&lt;unsigned char*&gt;(page)) &amp; 1) {</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;          pagePtr++;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        }</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        tbHdr = <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="../../d6/d04/structo2_1_1tpc_1_1TPCZSTBHDR.html">TPCZSTBHDR</a>*<span class="keyword">&gt;</span>(pagePtr);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        tbHdr-&gt;<a class="code" href="../../d6/d04/structo2_1_1tpc_1_1TPCZSTBHDR.html#abe54e8ff11c4f7a9121531506150d887">rowMask</a> |= (endpoint &amp; 1) &lt;&lt; 15;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        nRowsInTB = 0;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        lastRow = <a class="code" href="../../d2/d37/GPUDefConstantsAndSettings_8h.html#afd2e13a07f9d227b8949af90d39812cf">GPUCA_ROW_COUNT</a>;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      }</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <span class="keywordflow">if</span> (ZSEncoderGetRow(tmpBuffer[k]) != lastRow) {</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        tbHdr-&gt;<a class="code" href="../../d6/d04/structo2_1_1tpc_1_1TPCZSTBHDR.html#abe54e8ff11c4f7a9121531506150d887">rowMask</a> |= 1 &lt;&lt; (ZSEncoderGetRow(tmpBuffer[k]) - endpointStart);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        lastRow = ZSEncoderGetRow(tmpBuffer[k]);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        ZSstreamOut(streamBuffer.data(), streamSize, streamBuffer8.data(), streamSize8, encodeBits);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="keywordflow">if</span> (nRowsInTB) {</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;          tbHdr-&gt;rowAddr1()[nRowsInTB - 1] = (pagePtr - <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(page)) + streamSize8;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        }</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        nRowsInTB++;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        nSeq = streamBuffer8.data() + streamSize8++;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        *nSeq = 0;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      }</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      (*nSeq)++;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      streamBuffer8[streamSize8++] = ZSEncoderGetPad(tmpBuffer[k]);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      streamBuffer8[streamSize8++] = streamSize + seqLen;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      hdr-&gt;<a class="code" href="../../dc/d83/structo2_1_1tpc_1_1TPCZSHDR.html#af23bf9b0cc7cc269c3dacfb06d1c19e8">nADCsamples</a> += seqLen;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l = 0; l &lt; seqLen; l++) {</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        streamBuffer[streamSize++] = (<span class="keywordtype">unsigned</span> <a class="code" href="../../dc/d10/classshort.html">short</a>)(ZSEncoderGetCharge(tmpBuffer[k + l]) * encodeBitsFactor + 0.5f);</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      }</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      k += seqLen - 1;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    }</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">if</span> (!raw) {</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; GPUTrackingInOutZS::NENDPOINTS; j++) {</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dc/da3/glcorearb_8h.html#a3667f558219c90437106b544a3ca00b8">buffer</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][j].<a class="code" href="../../d8/dde/namespaceGPUCA__NAMESPACE_1_1gpu.html#a936e7e1d3f59c6e9a0301dc3b4a1c436">size</a>() == 0) {</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;          <a class="code" href="../../dc/da3/glcorearb_8h.html#a3667f558219c90437106b544a3ca00b8">buffer</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][j].emplace_back();</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;          ZSfillEmpty(&amp;<a class="code" href="../../dc/da3/glcorearb_8h.html#a3667f558219c90437106b544a3ca00b8">buffer</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][j].back(), bcShiftInFirstHBF);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;          totalPages++;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        }</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      }</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    }</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="comment">// Verification</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordflow">if</span> (verify) {</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      std::vector&lt;o2::tpc::Digit&gt; compareBuffer;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      compareBuffer.reserve(tmpBuffer.size());</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; GPUTrackingInOutZS::NENDPOINTS; j++) {</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> firstOrbit = o2::raw::RDHUtils::getHeartBeatOrbit(*(<span class="keyword">const</span> <a class="code" href="../../d8/d47/structo2_1_1header_1_1RAWDataHeaderV4.html">o2::header::RAWDataHeader</a>*)<a class="code" href="../../dc/da3/glcorearb_8h.html#a3667f558219c90437106b544a3ca00b8">buffer</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][j].<a class="code" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>());</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="../../dc/da3/glcorearb_8h.html#a3667f558219c90437106b544a3ca00b8">buffer</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][j].size(); k++) {</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;          page = &amp;<a class="code" href="../../dc/da3/glcorearb_8h.html#a3667f558219c90437106b544a3ca00b8">buffer</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][j][k];</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;          pagePtr = <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(page);</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;          <span class="keyword">const</span> <a class="code" href="../../d8/d47/structo2_1_1header_1_1RAWDataHeaderV4.html">o2::header::RAWDataHeader</a>* rdh = (<span class="keyword">const</span> <a class="code" href="../../d8/d47/structo2_1_1header_1_1RAWDataHeaderV4.html">o2::header::RAWDataHeader</a>*)pagePtr;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;          <span class="keywordflow">if</span> (o2::raw::RDHUtils::getMemorySize(*rdh) == <span class="keyword">sizeof</span>(<a class="code" href="../../de/dd4/namespaceo2_1_1header.html#a1382d043a29d3edd8ec00b89e0f89fa6">o2::header::RAWDataHeader</a>)) {</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;          }</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;          pagePtr += <span class="keyword">sizeof</span>(<a class="code" href="../../de/dd4/namespaceo2_1_1header.html#a1382d043a29d3edd8ec00b89e0f89fa6">o2::header::RAWDataHeader</a>);</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;          hdr = <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="../../dc/d83/structo2_1_1tpc_1_1TPCZSHDR.html">TPCZSHDR</a>*<span class="keyword">&gt;</span>(pagePtr);</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;          pagePtr += <span class="keyword">sizeof</span>(*hdr);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;          <span class="keywordflow">if</span> (hdr-&gt;<a class="code" href="../../dc/d83/structo2_1_1tpc_1_1TPCZSHDR.html#a67b8704cce7b6e0e03b8b8c0ee90c4cc">version</a> != 1 &amp;&amp; hdr-&gt;<a class="code" href="../../dc/d83/structo2_1_1tpc_1_1TPCZSHDR.html#a67b8704cce7b6e0e03b8b8c0ee90c4cc">version</a> != 2) {</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;invalid ZS version&quot;</span>);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;          }</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">bool</span> decode12bit = hdr-&gt;<a class="code" href="../../dc/d83/structo2_1_1tpc_1_1TPCZSHDR.html#a67b8704cce7b6e0e03b8b8c0ee90c4cc">version</a> == 2;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> decodeBits = decode12bit ? TPCZSHDR::TPC_ZS_NBITS_V2 : TPCZSHDR::TPC_ZS_NBITS_V1;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">float</span> decodeBitsFactor = 1.f / (1 &lt;&lt; (decodeBits - 10));</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#ae1838b9db98fcca9cd79d66954101c9f">mask</a> = (1 &lt;&lt; decodeBits) - 1;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;          <span class="keywordtype">int</span> cruid = hdr-&gt;<a class="code" href="../../dc/d83/structo2_1_1tpc_1_1TPCZSHDR.html#a7e8208e4566edfd6ec50cf03b13ae091">cruID</a>;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sector = cruid / 10;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;          <span class="keywordflow">if</span> (sector != <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;invalid TPC sector&quot;</span>);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;          }</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;          region = cruid % 10;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;          <span class="keywordflow">if</span> ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)region != j / 2) {</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;CRU ID / endpoint mismatch&quot;</span>);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;          }</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;          <span class="keywordtype">int</span> nRowsRegion = param.<a class="code" href="../../da/daf/structGPUCA__NAMESPACE_1_1gpu_1_1GPUParam.html#a22fe417c0550ad7cc062d0062425c26a">tpcGeometry</a>.GetRegionRows(region);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;          <span class="keywordtype">int</span> timeBin = (hdr-&gt;<a class="code" href="../../dc/d83/structo2_1_1tpc_1_1TPCZSHDR.html#a70643353af25100617d427a9f044ea43">timeOffset</a> + (o2::raw::RDHUtils::getHeartBeatOrbit(*rdh) - firstOrbit) * o2::constants::lhc::LHCMaxBunches) / Constants::LHCBCPERTIMEBIN;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l = 0; l &lt; hdr-&gt;<a class="code" href="../../dc/d83/structo2_1_1tpc_1_1TPCZSHDR.html#a06ec33001ad93d5aa2fa1e933fdd36f3">nTimeBins</a>; l++) {</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            <span class="keywordflow">if</span> ((pagePtr - reinterpret_cast&lt;unsigned char*&gt;(page)) &amp; 1) {</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;              pagePtr++;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            }</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            tbHdr = <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="../../d6/d04/structo2_1_1tpc_1_1TPCZSTBHDR.html">TPCZSTBHDR</a>*<span class="keyword">&gt;</span>(pagePtr);</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            <span class="keywordtype">bool</span> upperRows = tbHdr-&gt;<a class="code" href="../../d6/d04/structo2_1_1tpc_1_1TPCZSTBHDR.html#abe54e8ff11c4f7a9121531506150d887">rowMask</a> &amp; 0x8000;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            <span class="keywordflow">if</span> (tbHdr-&gt;<a class="code" href="../../d6/d04/structo2_1_1tpc_1_1TPCZSTBHDR.html#abe54e8ff11c4f7a9121531506150d887">rowMask</a> != 0 &amp;&amp; ((upperRows) ^ ((j &amp; 1) != 0))) {</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;              <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;invalid endpoint&quot;</span>);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            }</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> rowOffset = param.<a class="code" href="../../da/daf/structGPUCA__NAMESPACE_1_1gpu_1_1GPUParam.html#a22fe417c0550ad7cc062d0062425c26a">tpcGeometry</a>.GetRegionStart(region) + (upperRows ? (nRowsRegion / 2) : 0);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> nRows = upperRows ? (nRowsRegion - nRowsRegion / 2) : (nRowsRegion / 2);</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> nRowsUsed = __builtin_popcount((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)(tbHdr-&gt;<a class="code" href="../../d6/d04/structo2_1_1tpc_1_1TPCZSTBHDR.html#abe54e8ff11c4f7a9121531506150d887">rowMask</a> &amp; 0x7FFF));</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            pagePtr += nRowsUsed ? (2 * nRowsUsed) : 2;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            <span class="keywordtype">int</span> rowPos = 0;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d4/dc3/classfloat.html">m</a> = 0; <a class="code" href="../../d4/dc3/classfloat.html">m</a> &lt; nRows; <a class="code" href="../../d4/dc3/classfloat.html">m</a>++) {</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;              <span class="keywordflow">if</span> ((tbHdr-&gt;<a class="code" href="../../d6/d04/structo2_1_1tpc_1_1TPCZSTBHDR.html#abe54e8ff11c4f7a9121531506150d887">rowMask</a> &amp; (1 &lt;&lt; <a class="code" href="../../d4/dc3/classfloat.html">m</a>)) == 0) {</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;              }</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;              <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* rowData = rowPos == 0 ? pagePtr : (<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(page) + tbHdr-&gt;rowAddr1()[rowPos - 1]);</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">int</span> nSeqRead = *rowData;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;              <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* adcData = rowData + 2 * nSeqRead + 1;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;              <span class="keywordtype">int</span> nADC = (rowData[2 * nSeqRead] * decodeBits + 7) / 8;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;              pagePtr += 1 + 2 * nSeqRead + nADC;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d7c/namespaceo2.html#a43c0bd48129b9b3448436996f35ffbc5">byte</a> = 0, <a class="code" href="../../dc/da3/glcorearb_8h.html#a8dc2cc80c52413d48ac45732e90d3a66">bits</a> = 0, pos10 = 0;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a0788d3762d0c3c76e4c094d8078b4c27">n</a> = 0; <a class="code" href="../../dc/da3/glcorearb_8h.html#a0788d3762d0c3c76e4c094d8078b4c27">n</a> &lt; nADC; <a class="code" href="../../dc/da3/glcorearb_8h.html#a0788d3762d0c3c76e4c094d8078b4c27">n</a>++) {</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                byte |= *(adcData++) &lt;&lt; <a class="code" href="../../dc/da3/glcorearb_8h.html#a8dc2cc80c52413d48ac45732e90d3a66">bits</a>;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                <a class="code" href="../../dc/da3/glcorearb_8h.html#a8dc2cc80c52413d48ac45732e90d3a66">bits</a> += 8;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                <span class="keywordflow">while</span> (<a class="code" href="../../dc/da3/glcorearb_8h.html#a8dc2cc80c52413d48ac45732e90d3a66">bits</a> &gt;= decodeBits) {</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                  streamBuffer[pos10++] = byte &amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#ae1838b9db98fcca9cd79d66954101c9f">mask</a>;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                  byte = byte &gt;&gt; decodeBits;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                  <a class="code" href="../../dc/da3/glcorearb_8h.html#a8dc2cc80c52413d48ac45732e90d3a66">bits</a> -= decodeBits;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                }</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;              }</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;              pos10 = 0;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a0788d3762d0c3c76e4c094d8078b4c27">n</a> = 0; <a class="code" href="../../dc/da3/glcorearb_8h.html#a0788d3762d0c3c76e4c094d8078b4c27">n</a> &lt; nSeqRead; <a class="code" href="../../dc/da3/glcorearb_8h.html#a0788d3762d0c3c76e4c094d8078b4c27">n</a>++) {</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span> seqLen = rowData[(<a class="code" href="../../dc/da3/glcorearb_8h.html#a0788d3762d0c3c76e4c094d8078b4c27">n</a> + 1) * 2] - (<a class="code" href="../../dc/da3/glcorearb_8h.html#a0788d3762d0c3c76e4c094d8078b4c27">n</a> ? rowData[<a class="code" href="../../dc/da3/glcorearb_8h.html#a0788d3762d0c3c76e4c094d8078b4c27">n</a> * 2] : 0);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0; o &lt; seqLen; o++) {</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                  compareBuffer.emplace_back(<a class="code" href="../../d1/d46/classo2_1_1tpc_1_1Digit.html">o2::tpc::Digit</a>{0, (<a class="code" href="../../d8/de9/qconfigoptions_8h.html#af38f59778a92ac6d4aa7b1eeec5c5ed2">float</a>)streamBuffer[pos10++] * decodeBitsFactor, (<a class="code" href="../../dd/d35/namespaceGPUCA__NAMESPACE_1_1gpu_1_1tpccf.html#ac17ae87a48d065a48250d7991a611728">tpccf::Row</a>)(rowOffset + <a class="code" href="../../dc/da3/glcorearb_8h.html#a11941354c1d09e70ec63bde35fc79d4f">m</a>), (<a class="code" href="../../dd/d35/namespaceGPUCA__NAMESPACE_1_1gpu_1_1tpccf.html#a465ae00813fec747f6aa28b1b208a7e6">tpccf::Pad</a>)(rowData[n * 2 + 1] + o), timeBin + l});</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                }</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;              }</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;              rowPos++;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            }</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;          }</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        }</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      }</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; tmpBuffer.size(); j++) {</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> decodeBits = zs12bit ? TPCZSHDR::TPC_ZS_NBITS_V2 : TPCZSHDR::TPC_ZS_NBITS_V1;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">float</span> decodeBitsFactor = (1 &lt;&lt; (decodeBits - 10));</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">float</span> c = zs12bit ? (<a class="code" href="../../d8/de9/qconfigoptions_8h.html#af38f59778a92ac6d4aa7b1eeec5c5ed2">float</a>)((<span class="keywordtype">int</span>)(ZSEncoderGetCharge(tmpBuffer[j]) * decodeBitsFactor + 0.5f)) / decodeBitsFactor : (<a class="code" href="../../d8/de9/qconfigoptions_8h.html#af38f59778a92ac6d4aa7b1eeec5c5ed2">float</a>)(<span class="keywordtype">int</span>)(ZSEncoderGetCharge(tmpBuffer[j]) + 0.5f);</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="keywordtype">int</span> ok = c == ZSEncoderGetCharge(compareBuffer[j]) &amp;&amp; (<a class="code" href="../../d8/de9/qconfigoptions_8h.html#ad08a37964429d340d966dfa679443e8f">int</a>)ZSEncoderGetTime(tmpBuffer[j]) == (<a class="code" href="../../d8/de9/qconfigoptions_8h.html#ad08a37964429d340d966dfa679443e8f">int</a>)ZSEncoderGetTime(compareBuffer[j]) &amp;&amp; (<a class="code" href="../../d8/de9/qconfigoptions_8h.html#ad08a37964429d340d966dfa679443e8f">int</a>)ZSEncoderGetPad(tmpBuffer[j]) == (<a class="code" href="../../d8/de9/qconfigoptions_8h.html#ad08a37964429d340d966dfa679443e8f">int</a>)ZSEncoderGetPad(compareBuffer[j]) &amp;&amp; (<a class="code" href="../../d8/de9/qconfigoptions_8h.html#ad08a37964429d340d966dfa679443e8f">int</a>)ZSEncoderGetRow(tmpBuffer[j]) == (<a class="code" href="../../d8/de9/qconfigoptions_8h.html#ad08a37964429d340d966dfa679443e8f">int</a>)ZSEncoderGetRow(compareBuffer[j]);</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <span class="keywordflow">if</span> (ok) {</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        }</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        nErrors++;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        printf(<span class="stringliteral">&quot;%4u: OK %d: Charge %3d %3d Time %4d %4d Pad %3d %3d Row %3d %3d\n&quot;</span>, j, ok,</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;               (<span class="keywordtype">int</span>)c, (<span class="keywordtype">int</span>)ZSEncoderGetCharge(compareBuffer[j]), (<span class="keywordtype">int</span>)ZSEncoderGetTime(tmpBuffer[j]), (<span class="keywordtype">int</span>)ZSEncoderGetTime(compareBuffer[j]), (<span class="keywordtype">int</span>)ZSEncoderGetPad(tmpBuffer[j]), (<span class="keywordtype">int</span>)ZSEncoderGetPad(compareBuffer[j]), (<span class="keywordtype">int</span>)ZSEncoderGetRow(tmpBuffer[j]), (<span class="keywordtype">int</span>)ZSEncoderGetRow(compareBuffer[j]));</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      }</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    }</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  }</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="keywordflow">if</span> (outBuffer) {</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    outBuffer-&gt;reset(<span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>[totalPages * TPCZSHDR::TPC_ZS_PAGE_SIZE / <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>)]);</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a8e8a78e36205bada4146dc581c95f82c">offset</a> = 0;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NSLICES; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; GPUTrackingInOutZS::NENDPOINTS; j++) {</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        memcpy((<span class="keywordtype">char</span>*)outBuffer-&gt;get() + <a class="code" href="../../dc/da3/glcorearb_8h.html#a8e8a78e36205bada4146dc581c95f82c">offset</a>, <a class="code" href="../../dc/da3/glcorearb_8h.html#a3667f558219c90437106b544a3ca00b8">buffer</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][j].data(), <a class="code" href="../../dc/da3/glcorearb_8h.html#a3667f558219c90437106b544a3ca00b8">buffer</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][j].size() * TPCZSHDR::TPC_ZS_PAGE_SIZE);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        offset += <a class="code" href="../../dc/da3/glcorearb_8h.html#a3667f558219c90437106b544a3ca00b8">buffer</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][j].size() * TPCZSHDR::TPC_ZS_PAGE_SIZE;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        outSizes[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> * GPUTrackingInOutZS::NENDPOINTS + j] = <a class="code" href="../../dc/da3/glcorearb_8h.html#a3667f558219c90437106b544a3ca00b8">buffer</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][j].size();</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      }</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    }</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  }</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="keywordflow">if</span> (nErrors) {</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    printf(<span class="stringliteral">&quot;%lld ERRORS DURING ZS!&quot;</span>, (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>)nErrors);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  }</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;}</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div><div class="line"><a name="l00550"></a><span class="lineno"><a class="line" href="../../d3/de2/classGPUCA__NAMESPACE_1_1gpu_1_1GPUReconstructionConvert.html#a65bed44605f6269ce848b209a14b7550">  550</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/de2/classGPUCA__NAMESPACE_1_1gpu_1_1GPUReconstructionConvert.html#a65bed44605f6269ce848b209a14b7550">GPUReconstructionConvert::RunZSEncoderCreateMeta</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>* <a class="code" href="../../dc/da3/glcorearb_8h.html#a3667f558219c90437106b544a3ca00b8">buffer</a>, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>* <a class="code" href="../../dc/da3/glcorearb_8h.html#a47de6d08cc8a4fedb70ca3645aa6f72d">sizes</a>, <span class="keywordtype">void</span>** ptrs, GPUTrackingInOutZS* out)</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;{</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a8e8a78e36205bada4146dc581c95f82c">offset</a> = 0;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NSLICES; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; GPUTrackingInOutZS::NENDPOINTS; j++) {</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      ptrs[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> * GPUTrackingInOutZS::NENDPOINTS + j] = (<span class="keywordtype">char</span>*)buffer + offset;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      offset += sizes[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> * GPUTrackingInOutZS::NENDPOINTS + j] * TPCZSHDR::TPC_ZS_PAGE_SIZE;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      out-&gt;slice[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].zsPtr[j] = &amp;ptrs[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> * GPUTrackingInOutZS::NENDPOINTS + j];</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      out-&gt;slice[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].nZSPtr[j] = &amp;sizes[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> * GPUTrackingInOutZS::NENDPOINTS + j];</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      out-&gt;slice[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].count[j] = 1;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    }</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  }</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;}</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div><div class="line"><a name="l00564"></a><span class="lineno"><a class="line" href="../../d3/de2/classGPUCA__NAMESPACE_1_1gpu_1_1GPUReconstructionConvert.html#a3ab2e9a0c4566c51cdc685946602d1a7">  564</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d3/de2/classGPUCA__NAMESPACE_1_1gpu_1_1GPUReconstructionConvert.html#a3ab2e9a0c4566c51cdc685946602d1a7">GPUReconstructionConvert::RunZSFilter</a>(std::unique_ptr&lt;<a class="code" href="../../d1/d46/classo2_1_1tpc_1_1Digit.html">o2::tpc::Digit</a>[]&gt;* <a class="code" href="../../dc/da3/glcorearb_8h.html#af545b4458d07f53f6ffebc73b38814cb">buffers</a>, <span class="keyword">const</span> <a class="code" href="../../d1/d46/classo2_1_1tpc_1_1Digit.html">o2::tpc::Digit</a>* <span class="keyword">const</span>* ptrs, <span class="keywordtype">size_t</span>* nsb, <span class="keyword">const</span> <span class="keywordtype">size_t</span>* ns, <span class="keyword">const</span> <a class="code" href="../../da/daf/structGPUCA__NAMESPACE_1_1gpu_1_1GPUParam.html">GPUParam</a>&amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>, <span class="keywordtype">bool</span> zs12bit)</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;{</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="preprocessor">#ifdef HAVE_O2HEADERS</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; NSLICES; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/da3/glcorearb_8h.html#af545b4458d07f53f6ffebc73b38814cb">buffers</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<span class="keyword">get</span>() != ptrs[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] || nsb != ns) {</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Not owning digits&quot;</span>);</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    }</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> decodeBits = zs12bit ? TPCZSHDR::TPC_ZS_NBITS_V2 : TPCZSHDR::TPC_ZS_NBITS_V1;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> decodeBitsFactor = (1 &lt;&lt; (decodeBits - 10));</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; ns[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]; k++) {</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/da3/glcorearb_8h.html#af545b4458d07f53f6ffebc73b38814cb">buffers</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][k].getChargeFloat() &gt;= param.<a class="code" href="../../da/daf/structGPUCA__NAMESPACE_1_1gpu_1_1GPUParam.html#af02f717a7f3982e9eaf4c9738e44fdb6">rec</a>.<a class="code" href="../../d0/d8d/structGPUCA__NAMESPACE_1_1gpu_1_1GPUSettingsRec.html#a7c3aaf630ec901ce63276ae181b55e00">tpcZSthreshold</a>) {</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <span class="keywordflow">if</span> (k &gt; j) {</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;          <a class="code" href="../../dc/da3/glcorearb_8h.html#af545b4458d07f53f6ffebc73b38814cb">buffers</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][j] = <a class="code" href="../../dc/da3/glcorearb_8h.html#af545b4458d07f53f6ffebc73b38814cb">buffers</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][k];</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        }</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="keywordflow">if</span> (zs12bit) {</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;          <a class="code" href="../../dc/da3/glcorearb_8h.html#af545b4458d07f53f6ffebc73b38814cb">buffers</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][j].setCharge((<span class="keywordtype">float</span>)((<span class="keywordtype">int</span>)(<a class="code" href="../../dc/da3/glcorearb_8h.html#af545b4458d07f53f6ffebc73b38814cb">buffers</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][j].getChargeFloat() * decodeBitsFactor + 0.5<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a>)) / decodeBitsFactor);</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;          <a class="code" href="../../dc/da3/glcorearb_8h.html#af545b4458d07f53f6ffebc73b38814cb">buffers</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][j].setCharge((<span class="keywordtype">float</span>)((<span class="keywordtype">int</span>)(<a class="code" href="../../dc/da3/glcorearb_8h.html#af545b4458d07f53f6ffebc73b38814cb">buffers</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>][j].getChargeFloat() + 0.5<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a>)));</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        }</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        j++;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      }</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    }</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    nsb[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = j;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  }</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;}</div><div class="ttc" id="structo2_1_1raw_1_1RDHUtils_html_ae2e5db94ad33a3126cdbb1ba437a8271"><div class="ttname"><a href="../../da/d2c/structo2_1_1raw_1_1RDHUtils.html#ae2e5db94ad33a3126cdbb1ba437a8271">o2::raw::RDHUtils::setHeartBeatOrbit</a></div><div class="ttdeci">static void setHeartBeatOrbit(RDHv4 &amp;rdh, uint32_t v)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dec/Raw_2include_2DetectorsRaw_2RDHUtils_8h_source.html#l00355">RDHUtils.h:355</a></div></div>
<div class="ttc" id="LHCConstants_8h_html"><div class="ttname"><a href="../../d4/dc6/LHCConstants_8h.html">LHCConstants.h</a></div><div class="ttdoc">Header to collect LHC related constants. </div></div>
<div class="ttc" id="classo2_1_1raw_1_1RawFileWriter_html_a12043623a0f1b0867628da945ddddadb"><div class="ttname"><a href="../../d0/d0d/classo2_1_1raw_1_1RawFileWriter.html#a12043623a0f1b0867628da945ddddadb">o2::raw::RawFileWriter::addData</a></div><div class="ttdeci">void addData(uint16_t feeid, uint16_t cru, uint8_t lnk, uint8_t endpoint, const IR &amp;ir, const gsl::span&lt; char &gt; data, bool preformatted=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dd8/RawFileWriter_8cxx_source.html#l00126">RawFileWriter.cxx:126</a></div></div>
<div class="ttc" id="glcorearb_8h_html_ac7c896d55e93a6cf7ff8524005b4e7b4"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a></div><div class="ttdeci">GLenum GLfloat param</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00271">glcorearb.h:271</a></div></div>
<div class="ttc" id="glcorearb_8h_html_aee38b51639b577753f6a92029fb92000"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#aee38b51639b577753f6a92029fb92000">z</a></div><div class="ttdeci">GLdouble GLdouble GLdouble z</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00843">glcorearb.h:843</a></div></div>
<div class="ttc" id="bench__Clusterizer_8cxx_html_adc2980dd50ea866e70e476f11dca803b"><div class="ttname"><a href="../../d2/d12/bench__Clusterizer_8cxx.html#adc2980dd50ea866e70e476f11dca803b">nClusters</a></div><div class="ttdeci">int nClusters</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d12/bench__Clusterizer_8cxx_source.html#l00120">bench_Clusterizer.cxx:120</a></div></div>
<div class="ttc" id="namespaceo2_1_1header_html_a1382d043a29d3edd8ec00b89e0f89fa6"><div class="ttname"><a href="../../de/dd4/namespaceo2_1_1header.html#a1382d043a29d3edd8ec00b89e0f89fa6">o2::header::RAWDataHeader</a></div><div class="ttdeci">RAWDataHeaderV4 RAWDataHeader</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d78/DataFormats_2Headers_2include_2Headers_2RAWDataHeader_8h_source.html#l00427">RAWDataHeader.h:427</a></div></div>
<div class="ttc" id="classGPUCA__NAMESPACE_1_1gpu_1_1GPUReconstructionConvert_html_a7493b506019949a8bd4b20770b50b78a"><div class="ttname"><a href="../../d3/de2/classGPUCA__NAMESPACE_1_1gpu_1_1GPUReconstructionConvert.html#a7493b506019949a8bd4b20770b50b78a">GPUCA_NAMESPACE::gpu::GPUReconstructionConvert::ConvertRun2RawToNative</a></div><div class="ttdeci">static void ConvertRun2RawToNative(o2::tpc::ClusterNativeAccess &amp;native, std::unique_ptr&lt; o2::tpc::ClusterNative[]&gt; &amp;nativeBuffer, const AliHLTTPCRawCluster **rawClusters, unsigned int *nRawClusters)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7f/GPUReconstructionConvert_8cxx_source.html#l00083">GPUReconstructionConvert.cxx:83</a></div></div>
<div class="ttc" id="GPUReconstructionConvert_8h_html"><div class="ttname"><a href="../../d1/dfa/GPUReconstructionConvert_8h.html">GPUReconstructionConvert.h</a></div></div>
<div class="ttc" id="structAliHLTTPCRawCluster_html_a8c4752e6c73bb589209c38379356a005"><div class="ttname"><a href="../../d1/d6e/structAliHLTTPCRawCluster.html#a8c4752e6c73bb589209c38379356a005">AliHLTTPCRawCluster::GetTime</a></div><div class="ttdeci">float GetTime() const</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d86/AliHLTTPCRawCluster_8h_source.html#l00060">AliHLTTPCRawCluster.h:60</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a4568fc090febc136eed4577a600739ca"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a4568fc090febc136eed4577a600739ca">v</a></div><div class="ttdeci">const GLdouble * v</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00832">glcorearb.h:832</a></div></div>
<div class="ttc" id="structGPUCA__NAMESPACE_1_1gpu_1_1GPUSettingsRec_html_a7c3aaf630ec901ce63276ae181b55e00"><div class="ttname"><a href="../../d0/d8d/structGPUCA__NAMESPACE_1_1gpu_1_1GPUSettingsRec.html#a7c3aaf630ec901ce63276ae181b55e00">GPUCA_NAMESPACE::gpu::GPUSettingsRec::tpcZSthreshold</a></div><div class="ttdeci">unsigned char tpcZSthreshold</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dc6/GPUSettings_8h_source.html#l00078">GPUSettings.h:78</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a950fc91edb4504f62f1c577bf4727c29"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a950fc91edb4504f62f1c577bf4727c29">void</a></div><div class="ttdeci">typedef void(APIENTRYP PFNGLCULLFACEPROC)(GLenum mode)</div></div>
<div class="ttc" id="GPUDefConstantsAndSettings_8h_html_afd2e13a07f9d227b8949af90d39812cf"><div class="ttname"><a href="../../d2/d37/GPUDefConstantsAndSettings_8h.html#afd2e13a07f9d227b8949af90d39812cf">GPUCA_ROW_COUNT</a></div><div class="ttdeci">#define GPUCA_ROW_COUNT</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d37/GPUDefConstantsAndSettings_8h_source.html#l00074">GPUDefConstantsAndSettings.h:74</a></div></div>
<div class="ttc" id="structo2_1_1header_1_1RAWDataHeaderV4_html"><div class="ttname"><a href="../../d8/d47/structo2_1_1header_1_1RAWDataHeaderV4.html">o2::header::RAWDataHeaderV4</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d78/DataFormats_2Headers_2include_2Headers_2RAWDataHeader_8h_source.html#l00285">RAWDataHeader.h:285</a></div></div>
<div class="ttc" id="glcorearb_8h_html_ac8729153468b5dcf13f971b21d84d4e5"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#ac8729153468b5dcf13f971b21d84d4e5">a</a></div><div class="ttdeci">GLboolean GLboolean GLboolean GLboolean a</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l01233">glcorearb.h:1233</a></div></div>
<div class="ttc" id="namespaceo2_1_1pmr_html_aeea588f6ab06f06d4131f84d8eea272b"><div class="ttname"><a href="../../dd/d2d/namespaceo2_1_1pmr.html#aeea588f6ab06f06d4131f84d8eea272b">o2::pmr::vector</a></div><div class="ttdeci">std::vector&lt; T, o2::pmr::polymorphic_allocator&lt; T &gt; &gt; vector</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d03/MemoryResources_8h_source.html#l00282">MemoryResources.h:282</a></div></div>
<div class="ttc" id="structS_html"><div class="ttname"><a href="../../d1/d6a/structS.html">S</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df1/cxx14-test-aggregate-initialization_8cxx_source.html#l00017">cxx14-test-aggregate-initialization.cxx:17</a></div></div>
<div class="ttc" id="structo2_1_1tpc_1_1TPCZSHDR_html"><div class="ttname"><a href="../../dc/d83/structo2_1_1tpc_1_1TPCZSHDR.html">o2::tpc::TPCZSHDR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d04/ZeroSuppression_8h_source.html#l00027">ZeroSuppression.h:27</a></div></div>
<div class="ttc" id="TPC_2base_2include_2TPCBase_2RDHUtils_8h_html"><div class="ttname"><a href="../../db/d0d/TPC_2base_2include_2TPCBase_2RDHUtils_8h.html">RDHUtils.h</a></div></div>
<div class="ttc" id="structAliHLTTPCRawCluster_html_a52e03b2c5ee4934f85e81f10b2d6dbcb"><div class="ttname"><a href="../../d1/d6e/structAliHLTTPCRawCluster.html#a52e03b2c5ee4934f85e81f10b2d6dbcb">AliHLTTPCRawCluster::GetCharge</a></div><div class="ttdeci">int GetCharge() const</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d86/AliHLTTPCRawCluster_8h_source.html#l00063">AliHLTTPCRawCluster.h:63</a></div></div>
<div class="ttc" id="GPUDataTypes_8h_html"><div class="ttname"><a href="../../d4/dc5/GPUDataTypes_8h.html">GPUDataTypes.h</a></div></div>
<div class="ttc" id="ZeroSuppression_8h_html"><div class="ttname"><a href="../../dd/d04/ZeroSuppression_8h.html">ZeroSuppression.h</a></div><div class="ttdoc">Definitions of TPC Zero Suppression Data Headers. </div></div>
<div class="ttc" id="qconfigoptions_8h_html_ad08a37964429d340d966dfa679443e8f"><div class="ttname"><a href="../../d8/de9/qconfigoptions_8h.html#ad08a37964429d340d966dfa679443e8f">int</a></div><div class="ttdeci">Visualize clusters only Timeframe settings Average distance in cm of events merged into Randomize distance around average distance of merged events int</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/de9/qconfigoptions_8h_source.html#l00025">qconfigoptions.h:25</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a3667f558219c90437106b544a3ca00b8"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a3667f558219c90437106b544a3ca00b8">buffer</a></div><div class="ttdeci">GLuint buffer</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00655">glcorearb.h:655</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a8e8a78e36205bada4146dc581c95f82c"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a8e8a78e36205bada4146dc581c95f82c">offset</a></div><div class="ttdeci">GLintptr offset</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00660">glcorearb.h:660</a></div></div>
<div class="ttc" id="DataFormats_2Detectors_2TPC_2include_2DataFormatsTPC_2Digit_8h_html"><div class="ttname"><a href="../../d3/d7d/DataFormats_2Detectors_2TPC_2include_2DataFormatsTPC_2Digit_8h.html">Digit.h</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a11941354c1d09e70ec63bde35fc79d4f"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a11941354c1d09e70ec63bde35fc79d4f">m</a></div><div class="ttdeci">const GLfloat * m</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l04066">glcorearb.h:4066</a></div></div>
<div class="ttc" id="classshort_html"><div class="ttname"><a href="../../dc/d10/classshort.html">short</a></div></div>
<div class="ttc" id="glcorearb_8h_html_ae1838b9db98fcca9cd79d66954101c9f"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#ae1838b9db98fcca9cd79d66954101c9f">mask</a></div><div class="ttdeci">GLint GLuint mask</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00291">glcorearb.h:291</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a3d1e3edfcf61ca2d831883e1afbad89e"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a3d1e3edfcf61ca2d831883e1afbad89e">size</a></div><div class="ttdeci">GLsizeiptr size</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00659">glcorearb.h:659</a></div></div>
<div class="ttc" id="GPUParam_8h_html"><div class="ttname"><a href="../../df/d13/GPUParam_8h.html">GPUParam.h</a></div></div>
<div class="ttc" id="structAliHLTTPCRawCluster_html_a65131359473b5d9b47b6502a4a271afc"><div class="ttname"><a href="../../d1/d6e/structAliHLTTPCRawCluster.html#a65131359473b5d9b47b6502a4a271afc">AliHLTTPCRawCluster::GetQMax</a></div><div class="ttdeci">int GetQMax() const</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d86/AliHLTTPCRawCluster_8h_source.html#l00064">AliHLTTPCRawCluster.h:64</a></div></div>
<div class="ttc" id="GPUDefMacros_8h_html_a8f5eec32d1a68364e1f8686a03170527"><div class="ttname"><a href="../../d6/dff/GPUDefMacros_8h.html#a8f5eec32d1a68364e1f8686a03170527">GPUCA_OPENMP</a></div><div class="ttdeci">#define GPUCA_OPENMP(...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dff/GPUDefMacros_8h_source.html#l00048">GPUDefMacros.h:48</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a1fe2b9d716f80da76adb19505d583dc1"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a></div><div class="ttdeci">GLdouble f</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00310">glcorearb.h:310</a></div></div>
<div class="ttc" id="namespaceGPUCA__NAMESPACE_1_1gpu_html_a936e7e1d3f59c6e9a0301dc3b4a1c436"><div class="ttname"><a href="../../d8/dde/namespaceGPUCA__NAMESPACE_1_1gpu.html#a936e7e1d3f59c6e9a0301dc3b4a1c436">GPUCA_NAMESPACE::gpu::size</a></div><div class="ttdeci">unsigned long size</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dc0/GPUReconstructionCPU_8h_source.html#l00025">GPUReconstructionCPU.h:25</a></div></div>
<div class="ttc" id="qconfigoptions_8h_html_aa1bc83c2f27c6427080c2ba02be21feb"><div class="ttname"><a href="../../d8/de9/qconfigoptions_8h.html#aa1bc83c2f27c6427080c2ba02be21feb">bool</a></div><div class="ttdeci">bool</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/de9/qconfigoptions_8h_source.html#l00016">qconfigoptions.h:16</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a0788d3762d0c3c76e4c094d8078b4c27"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a0788d3762d0c3c76e4c094d8078b4c27">n</a></div><div class="ttdeci">GLdouble n</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l01982">glcorearb.h:1982</a></div></div>
<div class="ttc" id="structo2_1_1tpc_1_1TPCZSHDR_html_a70643353af25100617d427a9f044ea43"><div class="ttname"><a href="../../dc/d83/structo2_1_1tpc_1_1TPCZSHDR.html#a70643353af25100617d427a9f044ea43">o2::tpc::TPCZSHDR::timeOffset</a></div><div class="ttdeci">unsigned short timeOffset</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d04/ZeroSuppression_8h_source.html#l00038">ZeroSuppression.h:38</a></div></div>
<div class="ttc" id="classo2_1_1raw_1_1RawFileWriter_html"><div class="ttname"><a href="../../d0/d0d/classo2_1_1raw_1_1RawFileWriter.html">o2::raw::RawFileWriter</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d08/RawFileWriter_8h_source.html#l00038">RawFileWriter.h:38</a></div></div>
<div class="ttc" id="namespaceGPUCA__NAMESPACE_1_1gpu_1_1tpccf_html_a465ae00813fec747f6aa28b1b208a7e6"><div class="ttname"><a href="../../dd/d35/namespaceGPUCA__NAMESPACE_1_1gpu_1_1tpccf.html#a465ae00813fec747f6aa28b1b208a7e6">GPUCA_NAMESPACE::gpu::tpccf::Pad</a></div><div class="ttdeci">unsigned char Pad</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db0/clusterFinderDefs_8h_source.html#l00080">clusterFinderDefs.h:80</a></div></div>
<div class="ttc" id="structo2_1_1tpc_1_1ClusterNativeAccess_html_a1d0678d105530d43592d904224522814"><div class="ttname"><a href="../../da/d95/structo2_1_1tpc_1_1ClusterNativeAccess.html#a1d0678d105530d43592d904224522814">o2::tpc::ClusterNativeAccess::clusterOffset</a></div><div class="ttdeci">unsigned int clusterOffset[Constants::MAXSECTOR][Constants::MAXGLOBALPADROW]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/ClusterNative_8h_source.html#l00163">ClusterNative.h:163</a></div></div>
<div class="ttc" id="BenchCathodeSegmentation_8cxx_html_ad6a7b6b73caa2bc27f897bd23d8740ec"><div class="ttname"><a href="../../d8/df7/BenchCathodeSegmentation_8cxx.html#ad6a7b6b73caa2bc27f897bd23d8740ec">for</a></div><div class="ttdeci">for(auto _ :state)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df7/BenchCathodeSegmentation_8cxx_source.html#l00061">BenchCathodeSegmentation.cxx:61</a></div></div>
<div class="ttc" id="structAliHLTTPCRawCluster_html_add6db1f912767970e56c07c5d5af3146"><div class="ttname"><a href="../../d1/d6e/structAliHLTTPCRawCluster.html#add6db1f912767970e56c07c5d5af3146">AliHLTTPCRawCluster::GetSigmaPad2</a></div><div class="ttdeci">float GetSigmaPad2() const</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d86/AliHLTTPCRawCluster_8h_source.html#l00061">AliHLTTPCRawCluster.h:61</a></div></div>
<div class="ttc" id="DataFormats_2Detectors_2TPC_2include_2DataFormatsTPC_2Constants_8h_html"><div class="ttname"><a href="../../d0/dda/DataFormats_2Detectors_2TPC_2include_2DataFormatsTPC_2Constants_8h.html">Constants.h</a></div></div>
<div class="ttc" id="classfloat_html"><div class="ttname"><a href="../../d4/dc3/classfloat.html">float</a></div></div>
<div class="ttc" id="RawFileWriter_8h_html"><div class="ttname"><a href="../../da/d08/RawFileWriter_8h.html">RawFileWriter.h</a></div><div class="ttdoc">Utility class to write detectors data to (multiple) raw data file(s) respecting CRU format...</div></div>
<div class="ttc" id="HBFUtils_8h_html"><div class="ttname"><a href="../../d1/dec/HBFUtils_8h.html">HBFUtils.h</a></div></div>
<div class="ttc" id="classGPUCA__NAMESPACE_1_1gpu_1_1GPUReconstructionConvert_html_a3c48646598a6087eb967425434eabc00"><div class="ttname"><a href="../../d3/de2/classGPUCA__NAMESPACE_1_1gpu_1_1GPUReconstructionConvert.html#a3c48646598a6087eb967425434eabc00">GPUCA_NAMESPACE::gpu::GPUReconstructionConvert::RunZSEncoder</a></div><div class="ttdeci">static void RunZSEncoder(const S &amp;in, std::unique_ptr&lt; unsigned long long int[]&gt; *outBuffer, unsigned int *outSizes, o2::raw::RawFileWriter *raw, const o2::InteractionRecord *ir, const GPUParam &amp;param, bool zs12bit, bool verify, float threshold=0.f, bool padding=true)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7f/GPUReconstructionConvert_8cxx_source.html#l00221">GPUReconstructionConvert.cxx:221</a></div></div>
<div class="ttc" id="structGPUCA__NAMESPACE_1_1gpu_1_1GPUParam_html_af02f717a7f3982e9eaf4c9738e44fdb6"><div class="ttname"><a href="../../da/daf/structGPUCA__NAMESPACE_1_1gpu_1_1GPUParam.html#af02f717a7f3982e9eaf4c9738e44fdb6">GPUCA_NAMESPACE::gpu::GPUParam::rec</a></div><div class="ttdeci">GPUSettingsRec rec</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d13/GPUParam_8h_source.html#l00042">GPUParam.h:42</a></div></div>
<div class="ttc" id="qconfigoptions_8h_html_a00dc28d5db1371df938f63ad9eb450df"><div class="ttname"><a href="../../d8/de9/qconfigoptions_8h.html#a00dc28d5db1371df938f63ad9eb450df">clusters</a></div><div class="ttdeci">Visualize clusters only Timeframe settings Average distance in cm of events merged into Randomize distance around average distance of merged events Simulate correct bunch interactions instead of placing only the average number of events A value [n] sets TFlen for [n] collisions in Number of bunches per train Number of bunch trains Instantaneous interaction rate Do not simulate border Total number of collisions to be placed in the interior of all time Do not select random but walk over array of events in stride steps h QA settings const char Legend entries for data from comparison histogram files const char Store histograms in output root Do not run but just create PDFs from input root files Set cut for Q Compute the efficiency including impure tracks with fake contamination Maxmimum Create resolution histograms in the native fit Filter for Filter for Particle Store mc labels to file for later matching Minimum Pt of a matched track to be displayed Compare QA QAonly Event generator settings h Reconstruction settings Enable TRD processing Enable TPC Compression Mask to disable certain attachment steps during Enable rejection of TPC clusters for Pt threshold to reject clusters of TPC tracks Sort order of TPC Force early TPC transformation also for continuous Forward TPC digits as clusters(if they pass the ZS threshold)&quot;) AddOption(dropLoopers</div></div>
<div class="ttc" id="convertDigitsToRawZS_8cxx_html_a916fcf3a51816de2e63dda5b66a89d48"><div class="ttname"><a href="../../df/d6c/convertDigitsToRawZS_8cxx.html#a916fcf3a51816de2e63dda5b66a89d48">DigitArray</a></div><div class="ttdeci">std::array&lt; gsl::span&lt; const o2::tpc::Digit &gt;, Sector::MAXSECTOR &gt; DigitArray</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d6c/convertDigitsToRawZS_8cxx_source.html#l00052">convertDigitsToRawZS.cxx:52</a></div></div>
<div class="ttc" id="structo2_1_1tpc_1_1TPCZSHDR_html_a67b8704cce7b6e0e03b8b8c0ee90c4cc"><div class="ttname"><a href="../../dc/d83/structo2_1_1tpc_1_1TPCZSHDR.html#a67b8704cce7b6e0e03b8b8c0ee90c4cc">o2::tpc::TPCZSHDR::version</a></div><div class="ttdeci">unsigned char version</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d04/ZeroSuppression_8h_source.html#l00035">ZeroSuppression.h:35</a></div></div>
<div class="ttc" id="structo2_1_1tpc_1_1TPCZSHDR_html_a06ec33001ad93d5aa2fa1e933fdd36f3"><div class="ttname"><a href="../../dc/d83/structo2_1_1tpc_1_1TPCZSHDR.html#a06ec33001ad93d5aa2fa1e933fdd36f3">o2::tpc::TPCZSHDR::nTimeBins</a></div><div class="ttdeci">unsigned char nTimeBins</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d04/ZeroSuppression_8h_source.html#l00036">ZeroSuppression.h:36</a></div></div>
<div class="ttc" id="structo2_1_1tpc_1_1ClusterNative_html"><div class="ttname"><a href="../../dc/dbc/structo2_1_1tpc_1_1ClusterNative.html">o2::tpc::ClusterNative</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/ClusterNative_8h_source.html#l00050">ClusterNative.h:50</a></div></div>
<div class="ttc" id="structo2_1_1tpc_1_1TPCZSTBHDR_html"><div class="ttname"><a href="../../d6/d04/structo2_1_1tpc_1_1TPCZSTBHDR.html">o2::tpc::TPCZSTBHDR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d04/ZeroSuppression_8h_source.html#l00041">ZeroSuppression.h:41</a></div></div>
<div class="ttc" id="classT_html"><div class="ttname"><a href="../../d1/def/classT.html">T</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a6eba317e3cf44d6d26c04a5a8f197dcb"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a6eba317e3cf44d6d26c04a5a8f197dcb">b</a></div><div class="ttdeci">GLboolean GLboolean GLboolean b</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l01233">glcorearb.h:1233</a></div></div>
<div class="ttc" id="structAliHLTTPCRawCluster_html_a663a6c02f81797b6bf08d48a17932436"><div class="ttname"><a href="../../d1/d6e/structAliHLTTPCRawCluster.html#a663a6c02f81797b6bf08d48a17932436">AliHLTTPCRawCluster::GetFlags</a></div><div class="ttdeci">unsigned short GetFlags() const</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d86/AliHLTTPCRawCluster_8h_source.html#l00070">AliHLTTPCRawCluster.h:70</a></div></div>
<div class="ttc" id="namespaceo2_1_1tpc_1_1rdh__utils_html_a42665a9cc0d8132098f2d36794d6923a"><div class="ttname"><a href="../../d3/d5b/namespaceo2_1_1tpc_1_1rdh__utils.html#a42665a9cc0d8132098f2d36794d6923a">o2::tpc::rdh_utils::FEEIDType</a></div><div class="ttdeci">uint16_t FEEIDType</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d0d/TPC_2base_2include_2TPCBase_2RDHUtils_8h_source.html#l00025">RDHUtils.h:25</a></div></div>
<div class="ttc" id="structAliHLTTPCRawCluster_html_a165e321718fc52f13afa6c6d76729b18"><div class="ttname"><a href="../../d1/d6e/structAliHLTTPCRawCluster.html#a165e321718fc52f13afa6c6d76729b18">AliHLTTPCRawCluster::GetPad</a></div><div class="ttdeci">float GetPad() const</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d86/AliHLTTPCRawCluster_8h_source.html#l00059">AliHLTTPCRawCluster.h:59</a></div></div>
<div class="ttc" id="structo2_1_1tpc_1_1ClusterNativeAccess_html"><div class="ttname"><a href="../../da/d95/structo2_1_1tpc_1_1ClusterNativeAccess.html">o2::tpc::ClusterNativeAccess</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/ClusterNative_8h_source.html#l00157">ClusterNative.h:157</a></div></div>
<div class="ttc" id="Sector_8h_html"><div class="ttname"><a href="../../d3/dd6/Sector_8h.html">Sector.h</a></div></div>
<div class="ttc" id="structo2_1_1tpc_1_1ClusterNativeAccess_html_a9fef936d9bcd36d70bce4d1058642524"><div class="ttname"><a href="../../da/d95/structo2_1_1tpc_1_1ClusterNativeAccess.html#a9fef936d9bcd36d70bce4d1058642524">o2::tpc::ClusterNativeAccess::clusters</a></div><div class="ttdeci">const ClusterNative * clusters[Constants::MAXSECTOR][Constants::MAXGLOBALPADROW]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/ClusterNative_8h_source.html#l00159">ClusterNative.h:159</a></div></div>
<div class="ttc" id="glcorearb_8h_html_af545b4458d07f53f6ffebc73b38814cb"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#af545b4458d07f53f6ffebc73b38814cb">buffers</a></div><div class="ttdeci">const GLuint * buffers</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00656">glcorearb.h:656</a></div></div>
<div class="ttc" id="qconfigoptions_8h_html_af38f59778a92ac6d4aa7b1eeec5c5ed2"><div class="ttname"><a href="../../d8/de9/qconfigoptions_8h.html#af38f59778a92ac6d4aa7b1eeec5c5ed2">float</a></div><div class="ttdeci">Visualize clusters only Timeframe settings float</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/de9/qconfigoptions_8h_source.html#l00022">qconfigoptions.h:22</a></div></div>
<div class="ttc" id="classGPUCA__NAMESPACE_1_1gpu_1_1GPUReconstructionConvert_html_a3ab2e9a0c4566c51cdc685946602d1a7"><div class="ttname"><a href="../../d3/de2/classGPUCA__NAMESPACE_1_1gpu_1_1GPUReconstructionConvert.html#a3ab2e9a0c4566c51cdc685946602d1a7">GPUCA_NAMESPACE::gpu::GPUReconstructionConvert::RunZSFilter</a></div><div class="ttdeci">static void RunZSFilter(std::unique_ptr&lt; o2::tpc::Digit[]&gt; *buffers, const o2::tpc::Digit *const *ptrs, size_t *nsb, const size_t *ns, const GPUParam &amp;param, bool zs12bit)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7f/GPUReconstructionConvert_8cxx_source.html#l00564">GPUReconstructionConvert.cxx:564</a></div></div>
<div class="ttc" id="GPURawData_8h_html"><div class="ttname"><a href="../../d4/dbe/GPURawData_8h.html">GPURawData.h</a></div></div>
<div class="ttc" id="structo2_1_1tpc_1_1TPCZSHDR_html_a7e8208e4566edfd6ec50cf03b13ae091"><div class="ttname"><a href="../../dc/d83/structo2_1_1tpc_1_1TPCZSHDR.html#a7e8208e4566edfd6ec50cf03b13ae091">o2::tpc::TPCZSHDR::cruID</a></div><div class="ttdeci">unsigned short cruID</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d04/ZeroSuppression_8h_source.html#l00037">ZeroSuppression.h:37</a></div></div>
<div class="ttc" id="structo2_1_1tpc_1_1ClusterNative_html_a3bf15f414113a6e8754942e8f58d20fa"><div class="ttname"><a href="../../dc/dbc/structo2_1_1tpc_1_1ClusterNative.html#a3bf15f414113a6e8754942e8f58d20fa">o2::tpc::ClusterNative::qMax</a></div><div class="ttdeci">uint16_t qMax</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/ClusterNative_8h_source.html#l00067">ClusterNative.h:67</a></div></div>
<div class="ttc" id="structAliHLTTPCRawCluster_html_ab38d65c9758e13569731b9e92b2a9cda"><div class="ttname"><a href="../../d1/d6e/structAliHLTTPCRawCluster.html#ab38d65c9758e13569731b9e92b2a9cda">AliHLTTPCRawCluster::GetSigmaTime2</a></div><div class="ttdeci">float GetSigmaTime2() const</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d86/AliHLTTPCRawCluster_8h_source.html#l00062">AliHLTTPCRawCluster.h:62</a></div></div>
<div class="ttc" id="namespaceo2_1_1tpc_html"><div class="ttname"><a href="../../d0/d0a/namespaceo2_1_1tpc.html">o2::tpc</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dbc/SimTraits_8h_source.html#l00152">SimTraits.h:152</a></div></div>
<div class="ttc" id="AliHLTTPCRawCluster_8h_html"><div class="ttname"><a href="../../dd/d86/AliHLTTPCRawCluster_8h.html">AliHLTTPCRawCluster.h</a></div></div>
<div class="ttc" id="structGPUCA__NAMESPACE_1_1gpu_1_1GPUParam_html"><div class="ttname"><a href="../../da/daf/structGPUCA__NAMESPACE_1_1gpu_1_1GPUParam.html">GPUCA_NAMESPACE::gpu::GPUParam</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d13/GPUParam_8h_source.html#l00040">GPUParam.h:40</a></div></div>
<div class="ttc" id="GPUO2DataTypes_8h_html"><div class="ttname"><a href="../../d5/d5c/GPUO2DataTypes_8h.html">GPUO2DataTypes.h</a></div></div>
<div class="ttc" id="namespaceGPUCA__NAMESPACE_1_1gpu_1_1tpccf_html_ac17ae87a48d065a48250d7991a611728"><div class="ttname"><a href="../../dd/d35/namespaceGPUCA__NAMESPACE_1_1gpu_1_1tpccf.html#ac17ae87a48d065a48250d7991a611728">GPUCA_NAMESPACE::gpu::tpccf::Row</a></div><div class="ttdeci">unsigned char Row</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db0/clusterFinderDefs_8h_source.html#l00082">clusterFinderDefs.h:82</a></div></div>
<div class="ttc" id="structGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCClusterData_html"><div class="ttname"><a href="../../de/d16/structGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCClusterData.html">GPUCA_NAMESPACE::gpu::GPUTPCClusterData</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dde/GPUTPCClusterData_8h_source.html#l00023">GPUTPCClusterData.h:23</a></div></div>
<div class="ttc" id="clusterFinderDefs_8h_html"><div class="ttname"><a href="../../d9/db0/clusterFinderDefs_8h.html">clusterFinderDefs.h</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a0cdec8e97a75ee9458b23d152bf962d4"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a></div><div class="ttdeci">GLint GLenum GLint x</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00403">glcorearb.h:403</a></div></div>
<div class="ttc" id="namespaceGPUCA__NAMESPACE_1_1gpu_html"><div class="ttname"><a href="../../d8/dde/namespaceGPUCA__NAMESPACE_1_1gpu.html">GPUCA_NAMESPACE::gpu</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d0b/GPUCommonAlgorithm_8h_source.html#l00029">GPUCommonAlgorithm.h:29</a></div></div>
<div class="ttc" id="TPCFastTransform_8h_html"><div class="ttname"><a href="../../d4/db1/TPCFastTransform_8h.html">TPCFastTransform.h</a></div><div class="ttdoc">Definition of TPCFastTransform class. </div></div>
<div class="ttc" id="glcorearb_8h_html_a74d80fd479c0f6d0153c709949a089ef"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a74d80fd479c0f6d0153c709949a089ef">y</a></div><div class="ttdeci">GLint y</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00270">glcorearb.h:270</a></div></div>
<div class="ttc" id="structo2_1_1raw_1_1RDHUtils_html_aa3f3c16f28a6ea1526d0944b5ed63681"><div class="ttname"><a href="../../da/d2c/structo2_1_1raw_1_1RDHUtils.html#aa3f3c16f28a6ea1526d0944b5ed63681">o2::raw::RDHUtils::setMemorySize</a></div><div class="ttdeci">static void setMemorySize(H &amp;rdh, uint16_t v, NOTPTR(H))</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dec/Raw_2include_2DetectorsRaw_2RDHUtils_8h_source.html#l00233">RDHUtils.h:233</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a47de6d08cc8a4fedb70ca3645aa6f72d"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a47de6d08cc8a4fedb70ca3645aa6f72d">sizes</a></div><div class="ttdeci">GLuint GLsizei const GLuint const GLintptr const GLsizeiptr * sizes</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l02595">glcorearb.h:2595</a></div></div>
<div class="ttc" id="qconfigoptions_8h_html_a2b8298cdaa115e10085952184e21fa2f"><div class="ttname"><a href="../../d8/de9/qconfigoptions_8h.html#a2b8298cdaa115e10085952184e21fa2f">threshold</a></div><div class="ttdeci">Run track merging Number of iterations to Number of iterations to Number of initial iterations excluded from const char Directory with events to Number of OMP threads to Show standalone event Enable tracking Run event generator Use way track fit Create OuterParam Process continuous timeframe data Factor to apply to all memory scalers Automatically register input memory buffers for the GPU Use FIFO realtime Trap on floating point exceptions Field strength of solenoid Bz in kGaus Override max time bin setting for continuous data with max time bin in time frame Apply Zero Suppression when loading digits and remove those below threshold</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/de9/qconfigoptions_8h_source.html#l00163">qconfigoptions.h:163</a></div></div>
<div class="ttc" id="classGPUCA__NAMESPACE_1_1gpu_1_1GPUReconstructionConvert_html_a65bed44605f6269ce848b209a14b7550"><div class="ttname"><a href="../../d3/de2/classGPUCA__NAMESPACE_1_1gpu_1_1GPUReconstructionConvert.html#a65bed44605f6269ce848b209a14b7550">GPUCA_NAMESPACE::gpu::GPUReconstructionConvert::RunZSEncoderCreateMeta</a></div><div class="ttdeci">static void RunZSEncoderCreateMeta(const unsigned long long int *buffer, const unsigned int *sizes, void **ptrs, GPUTrackingInOutZS *out)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7f/GPUReconstructionConvert_8cxx_source.html#l00550">GPUReconstructionConvert.cxx:550</a></div></div>
<div class="ttc" id="structAliHLTTPCRawCluster_html_af1f76318133be0055e60ce5107d89e1a"><div class="ttname"><a href="../../d1/d6e/structAliHLTTPCRawCluster.html#af1f76318133be0055e60ce5107d89e1a">AliHLTTPCRawCluster::GetPadRow</a></div><div class="ttdeci">int GetPadRow() const</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d86/AliHLTTPCRawCluster_8h_source.html#l00058">AliHLTTPCRawCluster.h:58</a></div></div>
<div class="ttc" id="structo2_1_1InteractionRecord_html"><div class="ttname"><a href="../../d1/d21/structo2_1_1InteractionRecord.html">o2::InteractionRecord</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d80/InteractionRecord_8h_source.html#l00024">InteractionRecord.h:24</a></div></div>
<div class="ttc" id="structAliHLTTPCRawCluster_html"><div class="ttname"><a href="../../d1/d6e/structAliHLTTPCRawCluster.html">AliHLTTPCRawCluster</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d86/AliHLTTPCRawCluster_8h_source.html#l00023">AliHLTTPCRawCluster.h:23</a></div></div>
<div class="ttc" id="classGPUCA__NAMESPACE_1_1gpu_1_1GPUReconstructionConvert_html_a99668d6f3f98acb42c9b284b1bb4b6bf"><div class="ttname"><a href="../../d3/de2/classGPUCA__NAMESPACE_1_1gpu_1_1GPUReconstructionConvert.html#a99668d6f3f98acb42c9b284b1bb4b6bf">GPUCA_NAMESPACE::gpu::GPUReconstructionConvert::GetMaxTimeBin</a></div><div class="ttdeci">static int GetMaxTimeBin(const o2::tpc::ClusterNativeAccess &amp;native)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7f/GPUReconstructionConvert_8cxx_source.html#l00115">GPUReconstructionConvert.cxx:115</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a744fbed01658cb96bb8ba7e85a86d1dc"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a744fbed01658cb96bb8ba7e85a86d1dc">distance</a></div><div class="ttdeci">GLsizei GLsizei GLfloat distance</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l05506">glcorearb.h:5506</a></div></div>
<div class="ttc" id="classo2_1_1tpc_1_1Sector_html_ac8b33b4c676a81bba75f8c3c5d4dc11e"><div class="ttname"><a href="../../d0/d0c/classo2_1_1tpc_1_1Sector.html#ac8b33b4c676a81bba75f8c3c5d4dc11e">o2::tpc::Sector::MAXSECTOR</a></div><div class="ttdeci">static constexpr int MAXSECTOR</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dd6/Sector_8h_source.html#l00043">Sector.h:43</a></div></div>
<div class="ttc" id="structo2_1_1tpc_1_1ClusterNativeAccess_html_a7a32e75ccf6192097a3c78e86c6aa036"><div class="ttname"><a href="../../da/d95/structo2_1_1tpc_1_1ClusterNativeAccess.html#a7a32e75ccf6192097a3c78e86c6aa036">o2::tpc::ClusterNativeAccess::nClusters</a></div><div class="ttdeci">unsigned int nClusters[Constants::MAXSECTOR][Constants::MAXGLOBALPADROW]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/ClusterNative_8h_source.html#l00161">ClusterNative.h:161</a></div></div>
<div class="ttc" id="structo2_1_1tpc_1_1TPCZSTBHDR_html_abe54e8ff11c4f7a9121531506150d887"><div class="ttname"><a href="../../d6/d04/structo2_1_1tpc_1_1TPCZSTBHDR.html#abe54e8ff11c4f7a9121531506150d887">o2::tpc::TPCZSTBHDR::rowMask</a></div><div class="ttdeci">unsigned short rowMask</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d04/ZeroSuppression_8h_source.html#l00042">ZeroSuppression.h:42</a></div></div>
<div class="ttc" id="GPUTPCClusterData_8h_html"><div class="ttname"><a href="../../d1/dde/GPUTPCClusterData_8h.html">GPUTPCClusterData.h</a></div></div>
<div class="ttc" id="namespaceo2_1_1framework_html_a930799bc13c911ce05e376c5b6c8ac09"><div class="ttname"><a href="../../dd/d8d/namespaceo2_1_1framework.html#a930799bc13c911ce05e376c5b6c8ac09">o2::framework::parallel</a></div><div class="ttdeci">WorkflowSpec parallel(DataProcessorSpec original, size_t maxIndex, std::function&lt; void(DataProcessorSpec &amp;, size_t id)&gt; amendCallback)</div></div>
<div class="ttc" id="structo2_1_1tpc_1_1TPCZSHDR_html_af23bf9b0cc7cc269c3dacfb06d1c19e8"><div class="ttname"><a href="../../dc/d83/structo2_1_1tpc_1_1TPCZSHDR.html#af23bf9b0cc7cc269c3dacfb06d1c19e8">o2::tpc::TPCZSHDR::nADCsamples</a></div><div class="ttdeci">unsigned short nADCsamples</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d04/ZeroSuppression_8h_source.html#l00039">ZeroSuppression.h:39</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a8922a680b00df660c57f47c1971d04c5"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a></div><div class="ttdeci">GLboolean * data</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00298">glcorearb.h:298</a></div></div>
<div class="ttc" id="GPUCommonAlgorithm_8h_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d0b/GPUCommonAlgorithm_8h_source.html#l00385">GPUCommonAlgorithm.h:385</a></div></div>
<div class="ttc" id="structGPUCA__NAMESPACE_1_1gpu_1_1GPUParam_html_a22fe417c0550ad7cc062d0062425c26a"><div class="ttname"><a href="../../da/daf/structGPUCA__NAMESPACE_1_1gpu_1_1GPUParam.html#a22fe417c0550ad7cc062d0062425c26a">GPUCA_NAMESPACE::gpu::GPUParam::tpcGeometry</a></div><div class="ttdeci">GPUTPCGeometry tpcGeometry</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d13/GPUParam_8h_source.html#l00059">GPUParam.h:59</a></div></div>
<div class="ttc" id="classGPUCA__NAMESPACE_1_1gpu_1_1TPCFastTransform_html"><div class="ttname"><a href="../../d2/d47/classGPUCA__NAMESPACE_1_1gpu_1_1TPCFastTransform.html">GPUCA_NAMESPACE::gpu::TPCFastTransform</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/db1/TPCFastTransform_8h_source.html#l00062">TPCFastTransform.h:62</a></div></div>
<div class="ttc" id="namespaceo2_html_a43c0bd48129b9b3448436996f35ffbc5"><div class="ttname"><a href="../../d4/d7c/namespaceo2.html#a43c0bd48129b9b3448436996f35ffbc5">o2::byte</a></div><div class="ttdeci">unsigned char byte</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/df8/Types_8h_source.html#l00016">Types.h:16</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a8dc2cc80c52413d48ac45732e90d3a66"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a8dc2cc80c52413d48ac45732e90d3a66">bits</a></div><div class="ttdeci">GLenum GLint GLenum GLsizei GLsizei GLsizei GLint GLsizei const void * bits</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l04150">glcorearb.h:4150</a></div></div>
<div class="ttc" id="structo2_1_1InteractionRecord_html_a4dd7d03ed59d92173589ba61165873ab"><div class="ttname"><a href="../../d1/d21/structo2_1_1InteractionRecord.html#a4dd7d03ed59d92173589ba61165873ab">o2::InteractionRecord::bc</a></div><div class="ttdeci">uint16_t bc</div><div class="ttdoc">bunch crossing ID of interaction </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d80/InteractionRecord_8h_source.html#l00030">InteractionRecord.h:30</a></div></div>
<div class="ttc" id="structo2_1_1tpc_1_1ClusterNative_html_a869b47009cff6108aa57d25c6916e623"><div class="ttname"><a href="../../dc/dbc/structo2_1_1tpc_1_1ClusterNative.html#a869b47009cff6108aa57d25c6916e623">o2::tpc::ClusterNative::qTot</a></div><div class="ttdeci">uint16_t qTot</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/ClusterNative_8h_source.html#l00068">ClusterNative.h:68</a></div></div>
<div class="ttc" id="classo2_1_1tpc_1_1Digit_html"><div class="ttname"><a href="../../d1/d46/classo2_1_1tpc_1_1Digit.html">o2::tpc::Digit</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d7d/DataFormats_2Detectors_2TPC_2include_2DataFormatsTPC_2Digit_8h_source.html#l00034">Digit.h:34</a></div></div>
<div class="ttc" id="classGPUCA__NAMESPACE_1_1gpu_1_1GPUReconstructionConvert_html_a300978b87042c1274a63e7bf7feb2b47"><div class="ttname"><a href="../../d3/de2/classGPUCA__NAMESPACE_1_1gpu_1_1GPUReconstructionConvert.html#a300978b87042c1274a63e7bf7feb2b47">GPUCA_NAMESPACE::gpu::GPUReconstructionConvert::ConvertNativeToClusterData</a></div><div class="ttdeci">static void ConvertNativeToClusterData(o2::tpc::ClusterNativeAccess *native, std::unique_ptr&lt; GPUTPCClusterData[]&gt; *clusters, unsigned int *nClusters, const TPCFastTransform *transform, int continuousMaxTimeBin=0)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7f/GPUReconstructionConvert_8cxx_source.html#l00044">GPUReconstructionConvert.cxx:44</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_f511f1e9c03c071966ae594f00bbc5e0.html">GPU</a></li><li class="navelem"><a class="el" href="../../dir_77030b149987c946eb2e85728f65acc0.html">GPUTracking</a></li><li class="navelem"><a class="el" href="../../dir_442920581a03c66cf8c08ae559108050.html">Base</a></li><li class="navelem"><a class="el" href="../../dd/d7f/GPUReconstructionConvert_8cxx.html">GPUReconstructionConvert.cxx</a></li>
    <li class="footer">Generated on Thu Jun 4 2020 09:30:34 for Project by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
