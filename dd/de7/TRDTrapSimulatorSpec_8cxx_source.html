<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Project: /home/travis/build/AliceO2Group/AliceO2/Detectors/TRD/workflow/src/TRDTrapSimulatorSpec.cxx Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../o2_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('dd/de7/TRDTrapSimulatorSpec_8cxx_source.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">TRDTrapSimulatorSpec.cxx</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../dd/de7/TRDTrapSimulatorSpec_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Copyright CERN and copyright holders of ALICE O2. This software is</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// distributed under the terms of the GNU General Public License v3 (GPL</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Version 3), copied verbatim in the file &quot;COPYING&quot;.</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// See http://alice-o2.web.cern.ch/license for full licensing information.</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// In applying this license CERN does not waive the privileges and immunities</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// granted to it by virtue of its status as an Intergovernmental Organization</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// or submit itself to any jurisdiction.</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//#include &quot;Framework/runDataProcessing.h&quot;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/d96/TRDTrapSimulatorSpec_8h.html">TRDWorkflow/TRDTrapSimulatorSpec.h</a>&quot;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;cstdlib&gt;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// this is somewhat assuming that a DPL workflow will run on one node</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;thread&gt;</span> <span class="comment">// to detect number of hardware threads</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;sstream&gt;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span> <span class="comment">// for getppid</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;chrono&gt;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/dc6/ConfigParamRegistry_8h.html">Framework/ConfigParamRegistry.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/d43/ControlService_8h.html">Framework/ControlService.h</a>&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d0/df4/DataProcessorSpec_8h.html">Framework/DataProcessorSpec.h</a>&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/db8/DataRefUtils_8h.html">Framework/DataRefUtils.h</a>&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/dca/Lifetime_8h.html">Framework/Lifetime.h</a>&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d4f/Task_8h.html">Framework/Task.h</a>&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/dcd/DataHeader_8h.html">Headers/DataHeader.h</a>&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;TStopwatch.h&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/d40/HitProcessingManager_8h.html">Steer/HitProcessingManager.h</a>&quot;</span> <span class="comment">// for DigitizationContext</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;TChain.h&quot;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="../../d7/dcd/MCCompLabel_8h.html">SimulationDataFormat/MCCompLabel.h</a>&gt;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="../../db/d14/MCTruthContainer_8h.html">SimulationDataFormat/MCTruthContainer.h</a>&gt;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d28/GRPObject_8h.html">DataFormatsParameters/GRPObject.h</a>&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/da5/Detectors_2TRD_2base_2include_2TRDBase_2Digit_8h.html">TRDBase/Digit.h</a>&quot;</span> <span class="comment">// for the Digit type</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/d42/TrapSimulator_8h.html">TRDSimulation/TrapSimulator.h</a>&quot;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/dae/TRD_2simulation_2include_2TRDSimulation_2Digitizer_8h.html">TRDSimulation/Digitizer.h</a>&quot;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/df0/TRD_2simulation_2include_2TRDSimulation_2Detector_8h.html">TRDSimulation/Detector.h</a>&quot;</span> <span class="comment">// for the Hit type</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/dcc/Detectors_2Base_2include_2DetectorsBase_2GeometryManager_8h.html">DetectorsBase/GeometryManager.h</a>&quot;</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/d36/FeeParam_8h.html">TRDBase/FeeParam.h</a>&quot;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/d42/TrapSimulator_8h.html">TRDSimulation/TrapSimulator.h</a>&quot;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/dbe/TRD_2include_2DataFormatsTRD_2TriggerRecord_8h.html">DataFormatsTRD/TriggerRecord.h</a>&quot;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keyword">using namespace </span><a class="code" href="../../d8/dcc/namespacestd.html">std</a>;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">using namespace </span><a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html">o2::framework</a>;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="keyword">namespace </span><a class="code" href="../../d4/d7c/namespaceo2.html">o2</a></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;{</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="keyword">namespace </span><a class="code" href="../../d8/de9/qconfigoptions_8h.html#a8811c5158a219e0bc489747955a647ae">trd</a></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;{</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="../../d2/d76/namespaceo2_1_1trd.html#ad8e4dbeff25d86f622b276d38c99e8b9">   53</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d2/d76/namespaceo2_1_1trd.html#ad8e4dbeff25d86f622b276d38c99e8b9">DigitSortComparator</a>(<a class="code" href="../../d7/d48/classo2_1_1trd_1_1Digit.html">o2::trd::Digit</a> <span class="keyword">const</span>&amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#ac8729153468b5dcf13f971b21d84d4e5">a</a>, <a class="code" href="../../d7/d48/classo2_1_1trd_1_1Digit.html">o2::trd::Digit</a> <span class="keyword">const</span>&amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#a6eba317e3cf44d6d26c04a5a8f197dcb">b</a>)</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;{</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <a class="code" href="../../db/d0c/classo2_1_1trd_1_1FeeParam.html">FeeParam</a>* fee = FeeParam::instance();</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordtype">int</span> rowa = a.<a class="code" href="../../d7/d48/classo2_1_1trd_1_1Digit.html#a4c65ec2dfd903d39e0df1965caed066f">getRow</a>();</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordtype">int</span> rowb = b.<a class="code" href="../../d7/d48/classo2_1_1trd_1_1Digit.html#a4c65ec2dfd903d39e0df1965caed066f">getRow</a>();</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordtype">int</span> pada = a.<a class="code" href="../../d7/d48/classo2_1_1trd_1_1Digit.html#aa07ae55dafea1c2a2bb067b3ea564ea2">getPad</a>();</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordtype">int</span> padb = b.<a class="code" href="../../d7/d48/classo2_1_1trd_1_1Digit.html#aa07ae55dafea1c2a2bb067b3ea564ea2">getPad</a>();</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keywordtype">double</span> timea = a.getTimeStamp();</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordtype">double</span> timeb = b.getTimeStamp();</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordtype">int</span> roba = fee-&gt;<a class="code" href="../../db/d0c/classo2_1_1trd_1_1FeeParam.html#afa9ff2c666695eae576cbb74df082192">getROBfromPad</a>(rowa, pada);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordtype">int</span> robb = fee-&gt;<a class="code" href="../../db/d0c/classo2_1_1trd_1_1FeeParam.html#afa9ff2c666695eae576cbb74df082192">getROBfromPad</a>(rowb, padb);</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordtype">int</span> mcma = fee-&gt;<a class="code" href="../../db/d0c/classo2_1_1trd_1_1FeeParam.html#a74b3292dd4838ffa60a83168fd176cf6">getMCMfromPad</a>(rowa, pada);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keywordtype">int</span> mcmb = fee-&gt;<a class="code" href="../../db/d0c/classo2_1_1trd_1_1FeeParam.html#a74b3292dd4838ffa60a83168fd176cf6">getMCMfromPad</a>(rowb, padb);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keywordflow">if</span> (timea &lt; timeb) {</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">//  LOG(info) &lt;&lt; &quot;yip timea &lt; timeb &quot; &lt;&lt; timea &lt;&lt;&quot;&lt;&quot; &lt;&lt; timeb;</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (timea == timeb) {</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordflow">if</span> (a.<a class="code" href="../../d7/d48/classo2_1_1trd_1_1Digit.html#a36c5fb2dca8e50f90b8e26ad45beff10">getDetector</a>() &lt; b.<a class="code" href="../../d7/d48/classo2_1_1trd_1_1Digit.html#a36c5fb2dca8e50f90b8e26ad45beff10">getDetector</a>())</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <span class="keywordflow">if</span> (a.<a class="code" href="../../d7/d48/classo2_1_1trd_1_1Digit.html#a36c5fb2dca8e50f90b8e26ad45beff10">getDetector</a>() == b.<a class="code" href="../../d7/d48/classo2_1_1trd_1_1Digit.html#a36c5fb2dca8e50f90b8e26ad45beff10">getDetector</a>()) {</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="keywordflow">if</span> (roba &lt; robb)</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;          <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;          <span class="keywordflow">if</span> (roba == robb) {</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            <span class="keywordflow">if</span> (mcma &lt; mcmb)</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;              <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;              <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;          } <span class="keywordflow">else</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        }</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      }</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    }</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  }</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;}</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="../../d2/d76/namespaceo2_1_1trd.html#a273a0c4630ee720226ee0b4f36b62733">   95</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d2/d76/namespaceo2_1_1trd.html#a273a0c4630ee720226ee0b4f36b62733">DigitSortComparatorPadRow</a>(<a class="code" href="../../d7/d48/classo2_1_1trd_1_1Digit.html">o2::trd::Digit</a> <span class="keyword">const</span>&amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#ac8729153468b5dcf13f971b21d84d4e5">a</a>, <a class="code" href="../../d7/d48/classo2_1_1trd_1_1Digit.html">o2::trd::Digit</a> <span class="keyword">const</span>&amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#a6eba317e3cf44d6d26c04a5a8f197dcb">b</a>)</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;{</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="comment">//this sorts the data into pad rows, and pads with in that pad row.</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="comment">//this allows us to generate a structure of 144 pads to then pass to the trap simulator</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="comment">//taking into account the shared pads.</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordtype">int</span> rowa = a.<a class="code" href="../../d7/d48/classo2_1_1trd_1_1Digit.html#a4c65ec2dfd903d39e0df1965caed066f">getRow</a>();</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordtype">int</span> rowb = b.<a class="code" href="../../d7/d48/classo2_1_1trd_1_1Digit.html#a4c65ec2dfd903d39e0df1965caed066f">getRow</a>();</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordtype">int</span> pada = a.<a class="code" href="../../d7/d48/classo2_1_1trd_1_1Digit.html#aa07ae55dafea1c2a2bb067b3ea564ea2">getPad</a>();</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordtype">int</span> padb = b.<a class="code" href="../../d7/d48/classo2_1_1trd_1_1Digit.html#aa07ae55dafea1c2a2bb067b3ea564ea2">getPad</a>();</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordtype">double</span> timea = a.getTimeStamp();</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordtype">double</span> timeb = b.getTimeStamp();</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordflow">if</span> (timea &lt; timeb)</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (timea == timeb) {</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">if</span> (a.<a class="code" href="../../d7/d48/classo2_1_1trd_1_1Digit.html#a36c5fb2dca8e50f90b8e26ad45beff10">getDetector</a>() &lt; b.<a class="code" href="../../d7/d48/classo2_1_1trd_1_1Digit.html#a36c5fb2dca8e50f90b8e26ad45beff10">getDetector</a>())</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keywordflow">if</span> (a.<a class="code" href="../../d7/d48/classo2_1_1trd_1_1Digit.html#a36c5fb2dca8e50f90b8e26ad45beff10">getDetector</a>() == b.<a class="code" href="../../d7/d48/classo2_1_1trd_1_1Digit.html#a36c5fb2dca8e50f90b8e26ad45beff10">getDetector</a>()) {</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keywordflow">if</span> (rowa &lt; rowb)</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;          <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;          <span class="keywordflow">if</span> (rowa == rowb) {</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            <span class="keywordflow">if</span> (pada &lt; padb)</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;              <span class="keywordflow">return</span> 1; <span class="comment">//leaving in for now. so I dont have to have a 144x30 entry array for the pad data. dont have to deal with pad sorting, its going to be 1 of 144 and inserted into the required array.</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;              <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;          } <span class="keywordflow">else</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        }</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    }</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  }</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;}</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<a class="code" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html">TrapConfig</a>* TRDDPLTrapSimulatorTask::getTrapConfig()</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;{</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="comment">// return an existing TRAPconfig or load it from the CCDB</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="comment">// in case of failure, a default TRAPconfig is created</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(debug) &lt;&lt; <span class="stringliteral">&quot;start of gettrapconfig&quot;</span>;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="keywordflow">if</span> (mTrapConfig) {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(debug) &lt;&lt; <span class="stringliteral">&quot;mTrapConfig is valid : 0x&quot;</span> &lt;&lt; hex &lt;&lt; mTrapConfig &lt;&lt; dec;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">return</span> mTrapConfig;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(debug) &lt;&lt; <span class="stringliteral">&quot;mTrapConfig is invalid : 0x&quot;</span> &lt;&lt; hex &lt;&lt; mTrapConfig &lt;&lt; dec;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">//can I just ignore the old default and pull a new &quot;default&quot; from ccdb?</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment"></span>    <span class="keywordflow">if</span> (0) <span class="comment">//mTrapConfigName!= std::string(&quot;default&quot;))</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    {</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="comment">// try to load the requested configuration</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      loadTrapConfig();</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="comment">//calib.</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <span class="comment">// if we still don&#39;t have a valid TRAPconfig, we give up</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(debug) &lt;&lt; <span class="stringliteral">&quot;mTrapConfig is not valid now : 0x&quot;</span> &lt;&lt; hex &lt;&lt; mTrapConfig &lt;&lt; dec;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(warn) &lt;&lt; <span class="stringliteral">&quot;Falling back to default configuration for year&lt;2012&quot;</span>;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="keyword">static</span> <a class="code" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html">TrapConfig</a> trapConfigDefault(mTrapConfigName);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      mTrapConfig = &amp;trapConfigDefault; <span class="comment">//new TrapConfig; //&amp;trapConfigDefault;</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <a class="code" href="../../dc/dba/classo2_1_1trd_1_1TrapConfigHandler.html">TrapConfigHandler</a> cfgHandler(mTrapConfig);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      cfgHandler.<a class="code" href="../../dc/dba/classo2_1_1trd_1_1TrapConfigHandler.html#adc2947f47e1a0951e5eceff8564c785a">init</a>();</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      cfgHandler.<a class="code" href="../../dc/dba/classo2_1_1trd_1_1TrapConfigHandler.html#acf5433385576e38c25bae55035349166">loadConfig</a>();</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    }</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(debug) &lt;&lt; <span class="stringliteral">&quot;using TRAPconfig :&quot;</span> &lt;&lt; mTrapConfig-&gt;getConfigName().c_str() &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; mTrapConfig-&gt;getConfigVersion().c_str();</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">// we still have to load the gain tables</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">// if the gain filter is active</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">return</span> mTrapConfig;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  } <span class="comment">// end of else from if mTrapConfig</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;}</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="keywordtype">void</span> TRDDPLTrapSimulatorTask::loadTrapConfig()</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;{</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="comment">// try to load the specified configuration from the CCDB</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;looking for TRAPconfig &quot;</span> &lt;&lt; mTrapConfigName;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="comment">// const CalTrapConfig *caltrap = dynamic_cast&lt;const CalTrapConfig*&gt; (GetCachedCDBObject(kIDTrapConfig));</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="comment">//TODO get trap config from OCDB/CCDB</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="comment">//pull values from CDDB incoming structure or message ??</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;looking for TRAPconfig &quot;</span> &lt;&lt; mTrapConfigName &lt;&lt; __FILE__ &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; __LINE__;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keyword">auto</span>&amp; ccdbmgr = <a class="code" href="../../da/d73/classo2_1_1ccdb_1_1BasicCCDBManager.html#ac829fb69185587ba263490a43eab67d8">o2::ccdb::BasicCCDBManager::instance</a>();</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;looking for TRAPconfig &quot;</span> &lt;&lt; mTrapConfigName &lt;&lt; __FILE__ &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; __LINE__;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  ccdbmgr.setTimestamp(297595);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;looking for TRAPconfig &quot;</span> &lt;&lt; mTrapConfigName &lt;&lt; __FILE__ &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; __LINE__;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  mTrapConfig = ccdbmgr.get&lt;<a class="code" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html">o2::trd::TrapConfig</a>&gt;(mTrapConfigBaseName + std::string(<span class="stringliteral">&quot;/&quot;</span>) + mTrapConfigName);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;looking for TRAPconfig &quot;</span> &lt;&lt; mTrapConfigName &lt;&lt; __FILE__ &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; __LINE__ &lt;&lt; <span class="stringliteral">&quot;   trapconfig is : &quot;</span> &lt;&lt; &amp;mTrapConfig;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordflow">if</span> (mTrapConfig == <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;looking for TRAPconfig &quot;</span> &lt;&lt; mTrapConfigName &lt;&lt; __FILE__ &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; __LINE__;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">//failed to find or open or connect or something to get the trapconfig from the ccdb.</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">//first check the directory listing.</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(warn) &lt;&lt; <span class="stringliteral">&quot; failed to get trapconfig from ccdb with name :  &quot;</span> &lt;&lt; mTrapConfigName;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;looking for TRAPconfig &quot;</span> &lt;&lt; mTrapConfigName &lt;&lt; __FILE__ &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; __LINE__;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  }</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;looking for TRAPconfig &quot;</span> &lt;&lt; mTrapConfigName &lt;&lt; __FILE__ &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; __LINE__;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="comment">//  mTrapConfig = caltrap-&gt;Get(configName); //TODO it is not clear to me how this actually comes in.</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="comment">//}</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment"></span>  <span class="comment">//    if(mTrapConfig != nullptr){</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="comment">//      delete mTrapConfig;</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="comment">//    mTrapConfig = nullptr;</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="comment">//  }</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="comment">// mTrapConfig-&gt;LOADFROMDISKDEFAULT();</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;looking for TRAPconfig &quot;</span> &lt;&lt; mTrapConfigName &lt;&lt; __FILE__ &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; __LINE__;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(warn) &lt;&lt; <span class="stringliteral">&quot;No TRAPconfig entry found for name of &quot;</span> &lt;&lt; mTrapConfigName;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;looking for TRAPconfig &quot;</span> &lt;&lt; mTrapConfigName &lt;&lt; __FILE__ &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; __LINE__;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="comment">//  }</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;}</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno"><a class="line" href="../../d3/dfd/classo2_1_1trd_1_1TRDDPLTrapSimulatorTask.html#a8d6c53494345b316da9f39c6fc18c170">  209</a></span>&#160;<span class="keywordtype">void</span> TRDDPLTrapSimulatorTask::init(<a class="code" href="../../d4/d07/classo2_1_1framework_1_1InitContext.html">o2::framework::InitContext</a>&amp; ic)</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;{</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="comment">//               LOG(debug) &lt;&lt; &quot;Input data file is : &quot; &lt;&lt; ic.options().get&lt;std::string&gt;(&quot;simdatasrc&quot;);</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="comment">//               LOG(info) &lt;&lt; &quot;simSm is : &quot; &lt;&lt; ic.options().get&lt;int&gt;(&quot;simSM&quot;);</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(debug1) &lt;&lt; <span class="stringliteral">&quot;TRD Trap Simulator Device with pid of : &quot;</span> &lt;&lt; ::getpid();</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  mfeeparam = FeeParam::instance();</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  mPrintTrackletOptions = ic.<a class="code" href="../../d4/d07/classo2_1_1framework_1_1InitContext.html#a53b0eb564dc476a5804213809a3dee4c">options</a>().<a class="code" href="../../df/d6f/classo2_1_1framework_1_1ConfigParamRegistry.html#ae86d66faf0b5cdc42a725d722be54d5e">get</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;printtracklets&quot;</span>);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  mDrawTrackletOptions = ic.<a class="code" href="../../d4/d07/classo2_1_1framework_1_1InitContext.html#a53b0eb564dc476a5804213809a3dee4c">options</a>().<a class="code" href="../../df/d6f/classo2_1_1framework_1_1ConfigParamRegistry.html#ae86d66faf0b5cdc42a725d722be54d5e">get</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;drawtracklets&quot;</span>);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  mShowTrackletStats = ic.<a class="code" href="../../d4/d07/classo2_1_1framework_1_1InitContext.html#a53b0eb564dc476a5804213809a3dee4c">options</a>().<a class="code" href="../../df/d6f/classo2_1_1framework_1_1ConfigParamRegistry.html#ae86d66faf0b5cdc42a725d722be54d5e">get</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;show-trd-trackletstats&quot;</span>);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  mTrapConfigName = ic.<a class="code" href="../../d4/d07/classo2_1_1framework_1_1InitContext.html#a53b0eb564dc476a5804213809a3dee4c">options</a>().<a class="code" href="../../df/d6f/classo2_1_1framework_1_1ConfigParamRegistry.html#ae86d66faf0b5cdc42a725d722be54d5e">get</a>&lt;std::string&gt;(<span class="stringliteral">&quot;trapconfig&quot;</span>);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;Trap Simulator Device initialising with trap config of : &quot;</span> &lt;&lt; mTrapConfigName;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="comment">//  if(mDisableTrapSimulation){</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="comment">//  //now get a trapconfig to work with.</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="comment">//    LOG(warn) &lt;&lt; &quot;You elected to not do a trap chip simulation and hence no trapconfig was saught&quot;;</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="comment">//  }</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="comment">//  else{</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  getTrapConfig();</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;Trap Simulator Device initialised ... &quot;</span>;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="comment">//  }</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;}</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="../../d3/dfd/classo2_1_1trd_1_1TRDDPLTrapSimulatorTask.html#a6ad5763aa5229d5a2f0bdb76c0427b0d">  230</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/de9/qconfigoptions_8h.html#aafec0419b86d778bf3583702a2e6392c">TRDDPLTrapSimulatorTask::run</a>(<a class="code" href="../../d3/db7/classo2_1_1framework_1_1ProcessingContext.html">o2::framework::ProcessingContext</a>&amp; pc)</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;{</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;TRD Trap Simulator Device running over incoming message ...&quot;</span>;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="comment">// get the relevant inputs for the TrapSimulator</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="comment">// the digits are going to be sorted, we therefore need a copy of the vector rather than an object created</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="comment">// directly on the input data, the output vector however is created directly inside the message</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="comment">// memory thus avoiding copy by snapshot</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keyword">auto</span> digitsinput = pc.<a class="code" href="../../d3/db7/classo2_1_1framework_1_1ProcessingContext.html#aee19ae5272d374b797a29a755ad6f2c1">inputs</a>().<a class="code" href="../../df/d24/classo2_1_1framework_1_1InputRecord.html#a1c777bf7e242f8ba17b89275446a1225">get</a>&lt;std::vector&lt;o2::trd::Digit&gt;&gt;(<span class="stringliteral">&quot;digitinput&quot;</span>);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="comment">// TODO: not clear yet whether to send the digits because the snapshot method</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="comment">// has been commented out below. Rather than using snapshot (thus a copy) on a vector</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="comment">// object, this target object should be created directly in the message memory</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="comment">//auto&amp; digits = pc.outputs().make&lt;std::vector&lt;o2::trd::Digit&gt;&gt;(Output{&quot;TRD&quot;, &quot;DIGITS&quot;, 0, Lifetime::Timeframe}, digitsinput.begin(), digitsinput.end());</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  std::vector&lt;o2::trd::Digit&gt; digits(digitsinput.begin(), digitsinput.end());</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="comment">//auto mMCLabels = pc.inputs().get&lt;o2::dataformats::MCTruthContainer&lt;o2::trd::MCLabel&gt;*&gt;(&quot;labelinput&quot;);</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="comment">//auto mTriggerRecords = pc.inputs().get&lt;std::vector&lt;o2::trd::TriggerRecord&gt;&gt;(&quot;triggerrecords&quot;);</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(debug) &lt;&lt; <span class="stringliteral">&quot;Read in Digits with size of : &quot;</span> &lt;&lt; digits.size();</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="comment">//set up structures to hold the returning tracklets.</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="comment">// TODO: correct naming convention, wrong convention used for local variables</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  std::vector&lt;Tracklet&gt; mMCMTracklets; <span class="comment">//vector to store the retrieved tracklets from an mcm</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keyword">auto</span>&amp; mMCMTrackletsAccum = pc.<a class="code" href="../../d3/db7/classo2_1_1framework_1_1ProcessingContext.html#acf17ebe3e8fd81cefc8babca3e6a9f70">outputs</a>().<a class="code" href="../../df/d82/classo2_1_1framework_1_1DataAllocator.html#a254174798f600465454656790714d6cc">make</a>&lt;std::vector&lt;Tracklet&gt;&gt;(<a class="code" href="../../d1/dc1/structo2_1_1framework_1_1Output.html">Output</a>{<span class="stringliteral">&quot;TRD&quot;</span>, <span class="stringliteral">&quot;TRACKLETS&quot;</span>, 0, Lifetime::Timeframe});</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  mMCMTracklets.reserve(30);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  mMCMTrackletsAccum.reserve(digits.size() / 3); <span class="comment">//attempt to a. conserve mem, b. stop a vector resize</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="comment">//TODO we can ignore time, and use the triggerrecords as to defined subsets to sort. TriggerRecord has the time in it for all the digits, by creation.</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  std::chrono::duration&lt;double&gt; sortingtime{0}; </div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="keyword">auto</span> sortstart = std::chrono::high_resolution_clock::now();</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  std::sort(digits.begin(), digits.end(), <a class="code" href="../../d2/d76/namespaceo2_1_1trd.html#ad8e4dbeff25d86f622b276d38c99e8b9">DigitSortComparator</a>);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  sortingtime = std::chrono::high_resolution_clock::now() - sortstart;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="comment">//TODO Do we care about tracklet order so long as its time stamped.</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="comment">//TODO Dont sort, just build an index array</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="comment">//TODO sort from mTriggerRecords.getFirstEntry() to mTriggerRecords.getFirstEntry()+mTriggerRecords.getNumberOfObjects();</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keywordtype">int</span> olddetector = -1;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordtype">int</span> oldrow = -1;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keywordtype">int</span> oldpad = -1;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keywordtype">int</span> loopindex = 0;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keywordtype">int</span> counttrackletadditions = 0;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="keywordtype">int</span> oldsize = 0;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="keywordtype">double</span> trackletrate;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> oldtrackletcount = 0;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="comment">//various timers so we can see how long things take</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  std::chrono::duration&lt;double&gt; trapsimaccumulatedtime{0}; </div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  std::chrono::duration&lt;double&gt; digitlooptime{0};          </div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  std::chrono::duration&lt;double&gt; traplooptime{0};           </div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  std::chrono::duration&lt;double&gt; oldelse{0};                </div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  std::chrono::duration&lt;double&gt; tracklettime{0};           </div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="comment">// now to loop over the incoming digits.</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="keyword">auto</span> digitloopstart = std::chrono::high_resolution_clock::now();</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> digititerator = digits.begin(); digititerator != digits.end(); ++digititerator) {</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">//in here we have an entire padrow which corresponds to 8 TRAPs.</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">//while on a single padrow, populate data structures in the 8 trapsimulator.</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">//on change of padrow</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">//  fireup trapsim, do its thing with each 18 sequence of pads data that already exists inside the class from previous iterations of the loop</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordtype">double</span> digittime = digititerator-&gt;getTimeStamp();</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordtype">int</span> pad = digititerator-&gt;getPad();</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordtype">int</span> row = digititerator-&gt;getRow();</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordtype">int</span> detector = digititerator-&gt;getDetector();</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordtype">int</span> rob = mfeeparam-&gt;getROBfromPad(row, pad);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordtype">int</span> mcm = mfeeparam-&gt;getMCMfromPad(row, pad);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">if</span> (digititerator == digits.begin()) { <span class="comment">// first time in loop</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      oldrow = row;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      olddetector = detector;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    }</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">if</span> (olddetector != detector || oldrow != row) {</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <span class="comment">// we haved gone over the pad row. //TODO ??? do we need to check for change of time as well?</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <span class="comment">//all data is inside the 8 relavent trapsimulators</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      rob = mfeeparam-&gt;getROBfromPad(oldrow, oldpad); <span class="comment">//</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(debug) &lt;&lt; <span class="stringliteral">&quot;processing of row,mcm&quot;</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; padrow changed from &quot;</span> &lt;&lt; olddetector &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; oldrow &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; detector &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; row;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <span class="comment">//fireup Trapsim.</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="keyword">auto</span> traploopstart = std::chrono::high_resolution_clock::now();</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> trapcounter = 0; trapcounter &lt; 8; trapcounter++) {</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> isinit = mTrapSimulator[trapcounter].checkInitialized();</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(debug) &lt;&lt; <span class="stringliteral">&quot;is init : &quot;</span> &lt;&lt; isinit;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="keywordflow">if</span> (mTrapSimulator[trapcounter].isDataSet()) { <span class="comment">//firedtraps &amp; (1&lt;&lt;trapcounter){ /}/mTrapSimulator[trapcounter].checkInitialized()){</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;          <span class="comment">//this one has been filled with data for the now previous pad row.</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;          <span class="keyword">auto</span> trapsimtimerstart = std::chrono::high_resolution_clock::now();</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;          mTrapSimulator[trapcounter].filter();</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;          mTrapSimulator[trapcounter].tracklet();</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;          mMCMTracklets = mTrapSimulator[trapcounter].getTrackletArray(); <span class="comment">//TODO remove the copy and send the Accumulated array into the Trapsimulator</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;          <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(debug) &lt;&lt; mMCMTrackletsAccum.size() &lt;&lt; <span class="stringliteral">&quot; :: &quot;</span> &lt;&lt; mMCMTracklets.size() &lt;&lt; <span class="stringliteral">&quot; count tracklet additions :  &quot;</span> &lt;&lt; counttrackletadditions;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;          counttrackletadditions++;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;          mMCMTrackletsAccum.insert(mMCMTrackletsAccum.end(), mMCMTracklets.begin(), mMCMTracklets.end());</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;          trapsimaccumulatedtime += std::chrono::high_resolution_clock::now() - trapsimtimerstart;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;          <span class="keywordflow">if</span> (mShowTrackletStats &gt; 0) {</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <span class="keywordflow">if</span> (mMCMTrackletsAccum.size() - oldsize &gt; mShowTrackletStats) {</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;              <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(debug) &lt;&lt; <span class="stringliteral">&quot;TrapSim Accumulated tracklets: &quot;</span> &lt;&lt; mMCMTrackletsAccum.size() &lt;&lt; <span class="stringliteral">&quot; :: &quot;</span> &lt;&lt; mMCMTracklets.size();</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;              oldsize = mMCMTrackletsAccum.size();</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            }</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;          }</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;          <span class="comment">// mTrapSimulator[trapcounter].zeroSupressionMapping();</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;          <span class="keywordflow">if</span> (mDrawTrackletOptions != 0)</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            mTrapSimulator[trapcounter].draw(mDrawTrackletOptions, loopindex);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;          <span class="keywordflow">if</span> (mPrintTrackletOptions != 0)</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            mTrapSimulator[trapcounter].print(mPrintTrackletOptions);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;          loopindex++;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;          <span class="comment">//set this trap sim object to have not data (effectively) reset.</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;          mTrapSimulator[trapcounter].unsetData();</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;          <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(debug) &lt;&lt; <span class="stringliteral">&quot;if statement is init failed [&quot;</span> &lt;&lt; trapcounter &lt;&lt; <span class="stringliteral">&quot;] PROCESSING TRAP !&quot;</span>;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        }</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      } <span class="comment">//end of loop over trap chips</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      traplooptime += std::chrono::high_resolution_clock::now() - traploopstart;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(debug) &lt;&lt; <span class="stringliteral">&quot;Row change ... Tracklets so far: &quot;</span> &lt;&lt; mMCMTrackletsAccum.size();</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <span class="keywordflow">if</span> (mShowTrackletStats &gt; 0) {</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="keywordflow">if</span> (mMCMTrackletsAccum.size() - oldtrackletcount &gt; mShowTrackletStats) {</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;          oldtrackletcount = mMCMTrackletsAccum.size();</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> mcmTrackletsize = mMCMTrackletsAccum.size();</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;          tracklettime = std::chrono::high_resolution_clock::now() - digitloopstart;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;          trackletrate = mcmTrackletsize / tracklettime.count();</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;          <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;Getting tracklets at the rate of : &quot;</span> &lt;&lt; trackletrate &lt;&lt; <span class="stringliteral">&quot; Tracklets/s ... Accumulated tracklets : &quot;</span> &lt;&lt; mMCMTrackletsAccum.size();</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        }</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      }</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    } <span class="comment">//if oldetector!= detector ....</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">//we are still on the same detector and row.</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">//add the digits to the padrow.</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="comment">//copy pad time data into where they belong in the 8 TrapSimulators for this pad.</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordtype">int</span> mcmoffset = -1;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordtype">int</span> firstrob = mfeeparam-&gt;getROBfromPad(row, 5); <span class="comment">// 5 is arbitrary, but above the lower shared pads. so will get first rob and mcm</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordtype">int</span> firstmcm = mfeeparam-&gt;getMCMfromPad(row, 5); <span class="comment">// 5 for same reason</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordtype">int</span> trapindex = pad / 18;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">//check trap is initialised.</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">if</span> (!mTrapSimulator[trapindex].isDataSet()) {</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(debug) &lt;&lt; <span class="stringliteral">&quot;Initialising trapsimulator for triplet (&quot;</span> &lt;&lt; detector &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; rob &lt;&lt; <span class="stringliteral">&quot;,&quot;</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                 &lt;&lt; mcm &lt;&lt; <span class="stringliteral">&quot;) as its not initialized and we need to send it some adc data.&quot;</span>;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      mTrapSimulator[trapindex].init(mTrapConfig, detector, rob, mcm);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    }</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordtype">int</span> adc = 0;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    adc = 20 - (pad % 18) - 1;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(debug) &lt;&lt; <span class="stringliteral">&quot;setting data for simulator : &quot;</span> &lt;&lt; trapindex &lt;&lt; <span class="stringliteral">&quot; and adc : &quot;</span> &lt;&lt; adc;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    mTrapSimulator[trapindex].setData(adc, digititerator-&gt;getADC());</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="comment">// mTrapSimulator[trapindex].printAdcDatHuman(cout);</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="comment">// now take care of the case of shared pads (the whole reason for doing this pad row wise).</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordflow">if</span> (pad % 18 == 0 || (pad + 1) % 18 == 0) { <span class="comment">//case of pad 18 and 19 must be shared to preceding trap chip adc 1 and 0 respectively.</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                                                <span class="comment">//check trap is initialised.</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      adc = 20 - (pad % 18) - 1;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(debug) &lt;&lt; <span class="stringliteral">&quot;setting data for simulator : &quot;</span> &lt;&lt; trapindex - 1 &lt;&lt; <span class="stringliteral">&quot; and adc : &quot;</span> &lt;&lt; adc;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      mTrapSimulator[trapindex - 1].setData(adc, digititerator-&gt;getADC());</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    }</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">if</span> ((pad - 1) % 18 == 0) { <span class="comment">// case of pad 17 must shared to next trap chip as adc 20</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                               <span class="comment">//check trap is initialised.</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      adc = 20 - (pad % 18) - 1;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(debug) &lt;&lt; <span class="stringliteral">&quot;setting data for simulator : &quot;</span> &lt;&lt; trapindex + 1 &lt;&lt; <span class="stringliteral">&quot; and adc : &quot;</span> &lt;&lt; adc;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="keywordflow">if</span> (trapindex + 1 != 8) {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        mTrapSimulator[trapindex + 1].setData(adc, digititerator-&gt;getADC());</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      }</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      <span class="comment">//else { // this is not an issue as its a shared pad, simply the sharing to the next trap chip is meaningless.</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <span class="comment">//}</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    }</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    olddetector = detector;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    oldrow = row;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    oldpad = pad;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  } <span class="comment">// end of loop over digits.</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;Trap simulator found &quot;</span> &lt;&lt; mMCMTrackletsAccum.size() &lt;&lt; <span class="stringliteral">&quot; tracklets from &quot;</span> &lt;&lt; digits.size() &lt;&lt; <span class="stringliteral">&quot; Digits&quot;</span>;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="keywordflow">if</span> (mShowTrackletStats &gt; 0) {</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    digitlooptime = std::chrono::high_resolution_clock::now() - digitloopstart;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;Trap Simulator done \\o/ &quot;</span>;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;Sorting took &quot;</span> &lt;&lt; sortingtime.count();</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;Digit loop took : &quot;</span> &lt;&lt; digitlooptime.count();</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;Trapsim took : &quot;</span> &lt;&lt; trapsimaccumulatedtime.count();</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;Traploop took : &quot;</span> &lt;&lt; traplooptime.count();</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  }</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="comment">// Note: do not use snapshot for TRD/DIGITS and TRD/TRACKLETS, we can avoif the copy by allocating</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="comment">// the vectors directly in the message memory, see above</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="comment">//  pc.outputs().snapshot(Output{&quot;TRD&quot;,&quot;TRKLABELS&quot;,0,Lifetime::Timeframe},mMCLabels);</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="comment">//pc.outputs().snapshot(Output{&quot;TRD&quot;,&quot;TRGRRecords&quot;,0,Lifetime::Timeframe},mTriggerRecords);</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;}</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno"><a class="line" href="../../d2/d76/namespaceo2_1_1trd.html#a6efcd34597df4791893391f6f79876c1">  419</a></span>&#160;<a class="code" href="../../d0/d16/structo2_1_1framework_1_1DataProcessorSpec.html">o2::framework::DataProcessorSpec</a> <a class="code" href="../../d2/d76/namespaceo2_1_1trd.html#a6efcd34597df4791893391f6f79876c1">getTRDTrapSimulatorSpec</a>()</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;{</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d0/d16/structo2_1_1framework_1_1DataProcessorSpec.html">DataProcessorSpec</a>{<span class="stringliteral">&quot;TRAP&quot;</span>, <a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ae0fa8f5b8c413d923205bbe985f08602">Inputs</a>{<a class="code" href="../../da/d96/structo2_1_1framework_1_1InputSpec.html">InputSpec</a>{<span class="stringliteral">&quot;digitinput&quot;</span>, <span class="stringliteral">&quot;TRD&quot;</span>, <span class="stringliteral">&quot;DIGITS&quot;</span>, 0}, <a class="code" href="../../da/d96/structo2_1_1framework_1_1InputSpec.html">InputSpec</a>{<span class="stringliteral">&quot;triggerrecords&quot;</span>, <span class="stringliteral">&quot;TRD&quot;</span>, <span class="stringliteral">&quot;TRGRDIG&quot;</span>, 0}, <a class="code" href="../../da/d96/structo2_1_1framework_1_1InputSpec.html">InputSpec</a>{<span class="stringliteral">&quot;labelinput&quot;</span>, <span class="stringliteral">&quot;TRD&quot;</span>, <span class="stringliteral">&quot;LABELS&quot;</span>, 0}},</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                           <a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#af99101fa4f6d5dd76f39eb050f2b2d2a">Outputs</a>{<a class="code" href="../../d8/dc3/structo2_1_1framework_1_1OutputSpec.html">OutputSpec</a>{<span class="stringliteral">&quot;TRD&quot;</span>, <span class="stringliteral">&quot;TRACKLETS&quot;</span>, 0, Lifetime::Timeframe}},</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                           <span class="comment">//                                   OutputSpec{&quot;TRD&quot;,&quot;TRGRRecords&quot;,0,Lifetime::Timeframe}},</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                           <span class="comment">//                               OutputSpec{&quot;TRD&quot;,&quot;TRKLABELS&quot;,0, Lifetime::Timeframe},</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                           <a class="code" href="../../d4/d5e/structo2_1_1framework_1_1AlgorithmSpec.html">AlgorithmSpec</a>{adaptFromTask&lt;TRDDPLTrapSimulatorTask&gt;()},</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                           <a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#acda743ee0581ee4ad2f506fffe2cfc08">Options</a>{</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                             {<span class="stringliteral">&quot;show-trd-trackletstats&quot;</span>, VariantType::Int, 25000, {<span class="stringliteral">&quot;Display the accumulated size and capacity at number of track intervals&quot;</span>}},</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                             {<span class="stringliteral">&quot;trapconfig&quot;</span>, VariantType::String, <span class="stringliteral">&quot;default&quot;</span>, {<span class="stringliteral">&quot;Name of the trap config from the CCDB&quot;</span>}},</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                             {<span class="stringliteral">&quot;drawtracklets&quot;</span>, VariantType::Int, 0, {<span class="stringliteral">&quot;Bitpattern of input to TrapSimulator Draw method (be very careful) one file per track&quot;</span>}},</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                             {<span class="stringliteral">&quot;printtracklets&quot;</span>, VariantType::Int, 0, {<span class="stringliteral">&quot;Bitpattern of input to TrapSimulator print method&quot;</span>}}}};</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;};</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;} <span class="comment">//end namespace trd</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;} <span class="comment">//end namespace o2</span></div><div class="ttc" id="classo2_1_1trd_1_1FeeParam_html_a74b3292dd4838ffa60a83168fd176cf6"><div class="ttname"><a href="../../db/d0c/classo2_1_1trd_1_1FeeParam.html#a74b3292dd4838ffa60a83168fd176cf6">o2::trd::FeeParam::getMCMfromPad</a></div><div class="ttdeci">virtual int getMCMfromPad(int irow, int icol) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d67/FeeParam_8cxx_source.html#l00246">FeeParam.cxx:246</a></div></div>
<div class="ttc" id="classo2_1_1trd_1_1FeeParam_html_afa9ff2c666695eae576cbb74df082192"><div class="ttname"><a href="../../db/d0c/classo2_1_1trd_1_1FeeParam.html#afa9ff2c666695eae576cbb74df082192">o2::trd::FeeParam::getROBfromPad</a></div><div class="ttdeci">virtual int getROBfromPad(int irow, int icol) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d67/FeeParam_8cxx_source.html#l00290">FeeParam.cxx:290</a></div></div>
<div class="ttc" id="namespaceo2_1_1trd_html_ad8e4dbeff25d86f622b276d38c99e8b9"><div class="ttname"><a href="../../d2/d76/namespaceo2_1_1trd.html#ad8e4dbeff25d86f622b276d38c99e8b9">o2::trd::DigitSortComparator</a></div><div class="ttdeci">bool DigitSortComparator(o2::trd::Digit const &amp;a, o2::trd::Digit const &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de7/TRDTrapSimulatorSpec_8cxx_source.html#l00053">TRDTrapSimulatorSpec.cxx:53</a></div></div>
<div class="ttc" id="namespaceo2_html"><div class="ttname"><a href="../../d4/d7c/namespaceo2.html">o2</a></div><div class="ttdoc">information complementary to a CCDB object (path, metadata, startTimeValidity, endTimeValidity etc) ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d24/BitstreamReader_8h_source.html#l00022">BitstreamReader.h:22</a></div></div>
<div class="ttc" id="classo2_1_1trd_1_1TrapConfigHandler_html_acf5433385576e38c25bae55035349166"><div class="ttname"><a href="../../dc/dba/classo2_1_1trd_1_1TrapConfigHandler.html#acf5433385576e38c25bae55035349166">o2::trd::TrapConfigHandler::loadConfig</a></div><div class="ttdeci">int loadConfig()</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc3/TrapConfigHandler_8cxx_source.html#l00113">TrapConfigHandler.cxx:113</a></div></div>
<div class="ttc" id="GPUCommonLogger_8h_html_aea3d0edfe28fc0325c636b2b33f0527a"><div class="ttname"><a href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a></div><div class="ttdeci">#define LOG(type)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d5b/GPUCommonLogger_8h_source.html#l00028">GPUCommonLogger.h:28</a></div></div>
<div class="ttc" id="DataHeader_8h_html"><div class="ttname"><a href="../../dc/dcd/DataHeader_8h.html">DataHeader.h</a></div></div>
<div class="ttc" id="Lifetime_8h_html"><div class="ttname"><a href="../../dc/dca/Lifetime_8h.html">Lifetime.h</a></div></div>
<div class="ttc" id="TRDTrapSimulatorSpec_8h_html"><div class="ttname"><a href="../../dc/d96/TRDTrapSimulatorSpec_8h.html">TRDTrapSimulatorSpec.h</a></div></div>
<div class="ttc" id="glcorearb_8h_html_ac8729153468b5dcf13f971b21d84d4e5"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#ac8729153468b5dcf13f971b21d84d4e5">a</a></div><div class="ttdeci">GLboolean GLboolean GLboolean GLboolean a</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l01233">glcorearb.h:1233</a></div></div>
<div class="ttc" id="classo2_1_1framework_1_1ProcessingContext_html_aee19ae5272d374b797a29a755ad6f2c1"><div class="ttname"><a href="../../d3/db7/classo2_1_1framework_1_1ProcessingContext.html#aee19ae5272d374b797a29a755ad6f2c1">o2::framework::ProcessingContext::inputs</a></div><div class="ttdeci">InputRecord &amp; inputs()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d6a/ProcessingContext_8h_source.html#l00033">ProcessingContext.h:33</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="../../d8/dcc/namespacestd.html">std</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d76/Cartesian3D_8h_source.html#l00229">Cartesian3D.h:229</a></div></div>
<div class="ttc" id="structo2_1_1framework_1_1DataProcessorSpec_html"><div class="ttname"><a href="../../d0/d16/structo2_1_1framework_1_1DataProcessorSpec.html">o2::framework::DataProcessorSpec</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/DataProcessorSpec_8h_source.html#l00033">DataProcessorSpec.h:33</a></div></div>
<div class="ttc" id="classo2_1_1framework_1_1InitContext_html_a53b0eb564dc476a5804213809a3dee4c"><div class="ttname"><a href="../../d4/d07/classo2_1_1framework_1_1InitContext.html#a53b0eb564dc476a5804213809a3dee4c">o2::framework::InitContext::options</a></div><div class="ttdeci">ConfigParamRegistry const  &amp; options()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2b/InitContext_8h_source.html#l00030">InitContext.h:30</a></div></div>
<div class="ttc" id="FeeParam_8h_html"><div class="ttname"><a href="../../d2/d36/FeeParam_8h.html">FeeParam.h</a></div></div>
<div class="ttc" id="Detectors_2Base_2include_2DetectorsBase_2GeometryManager_8h_html"><div class="ttname"><a href="../../db/dcc/Detectors_2Base_2include_2DetectorsBase_2GeometryManager_8h.html">GeometryManager.h</a></div></div>
<div class="ttc" id="classo2_1_1framework_1_1InputRecord_html_a1c777bf7e242f8ba17b89275446a1225"><div class="ttname"><a href="../../df/d24/classo2_1_1framework_1_1InputRecord.html#a1c777bf7e242f8ba17b89275446a1225">o2::framework::InputRecord::get</a></div><div class="ttdeci">decltype(auto) get(R binding, int part=0) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d5c/InputRecord_8h_source.html#l00216">InputRecord.h:216</a></div></div>
<div class="ttc" id="classo2_1_1trd_1_1Digit_html_a36c5fb2dca8e50f90b8e26ad45beff10"><div class="ttname"><a href="../../d7/d48/classo2_1_1trd_1_1Digit.html#a36c5fb2dca8e50f90b8e26ad45beff10">o2::trd::Digit::getDetector</a></div><div class="ttdeci">int getDetector() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/da5/Detectors_2TRD_2base_2include_2TRDBase_2Digit_8h_source.html#l00050">Digit.h:50</a></div></div>
<div class="ttc" id="namespaceo2_1_1framework_html"><div class="ttname"><a href="../../dd/d8d/namespaceo2_1_1framework.html">o2::framework</a></div><div class="ttdoc">A header which contains some meta-data generated by Data Sampling. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d62/DataFormats_2Detectors_2ITSMFT_2common_2include_2DataFormatsITSMFT_2Cluster_8h_source.html#l00198">Cluster.h:198</a></div></div>
<div class="ttc" id="classo2_1_1ccdb_1_1BasicCCDBManager_html_ac829fb69185587ba263490a43eab67d8"><div class="ttname"><a href="../../da/d73/classo2_1_1ccdb_1_1BasicCCDBManager.html#ac829fb69185587ba263490a43eab67d8">o2::ccdb::BasicCCDBManager::instance</a></div><div class="ttdeci">static BasicCCDBManager &amp; instance()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/df3/BasicCCDBManager_8h_source.html#l00039">BasicCCDBManager.h:39</a></div></div>
<div class="ttc" id="namespaceo2_1_1framework_html_acda743ee0581ee4ad2f506fffe2cfc08"><div class="ttname"><a href="../../dd/d8d/namespaceo2_1_1framework.html#acda743ee0581ee4ad2f506fffe2cfc08">o2::framework::Options</a></div><div class="ttdeci">std::vector&lt; ConfigParamSpec &gt; Options</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/DataProcessorSpec_8h_source.html#l00028">DataProcessorSpec.h:28</a></div></div>
<div class="ttc" id="namespaceo2_1_1framework_html_ae0fa8f5b8c413d923205bbe985f08602"><div class="ttname"><a href="../../dd/d8d/namespaceo2_1_1framework.html#ae0fa8f5b8c413d923205bbe985f08602">o2::framework::Inputs</a></div><div class="ttdeci">std::vector&lt; InputSpec &gt; Inputs</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/DataProcessorSpec_8h_source.html#l00026">DataProcessorSpec.h:26</a></div></div>
<div class="ttc" id="namespaceo2_1_1trd_html_a6efcd34597df4791893391f6f79876c1"><div class="ttname"><a href="../../d2/d76/namespaceo2_1_1trd.html#a6efcd34597df4791893391f6f79876c1">o2::trd::getTRDTrapSimulatorSpec</a></div><div class="ttdeci">o2::framework::DataProcessorSpec getTRDTrapSimulatorSpec()</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de7/TRDTrapSimulatorSpec_8cxx_source.html#l00419">TRDTrapSimulatorSpec.cxx:419</a></div></div>
<div class="ttc" id="classo2_1_1framework_1_1DataAllocator_html_a254174798f600465454656790714d6cc"><div class="ttname"><a href="../../df/d82/classo2_1_1framework_1_1DataAllocator.html#a254174798f600465454656790714d6cc">o2::framework::DataAllocator::make</a></div><div class="ttdeci">decltype(auto) make(const Output &amp;spec, Args... args)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d28/DataAllocator_8h_source.html#l00099">DataAllocator.h:99</a></div></div>
<div class="ttc" id="structo2_1_1framework_1_1AlgorithmSpec_html"><div class="ttname"><a href="../../d4/d5e/structo2_1_1framework_1_1AlgorithmSpec.html">o2::framework::AlgorithmSpec</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d14/AlgorithmSpec_8h_source.html#l00044">AlgorithmSpec.h:44</a></div></div>
<div class="ttc" id="DataRefUtils_8h_html"><div class="ttname"><a href="../../d5/db8/DataRefUtils_8h.html">DataRefUtils.h</a></div></div>
<div class="ttc" id="classo2_1_1framework_1_1ProcessingContext_html"><div class="ttname"><a href="../../d3/db7/classo2_1_1framework_1_1ProcessingContext.html">o2::framework::ProcessingContext</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d6a/ProcessingContext_8h_source.html#l00023">ProcessingContext.h:23</a></div></div>
<div class="ttc" id="Detectors_2TRD_2base_2include_2TRDBase_2Digit_8h_html"><div class="ttname"><a href="../../d7/da5/Detectors_2TRD_2base_2include_2TRDBase_2Digit_8h.html">Digit.h</a></div></div>
<div class="ttc" id="classo2_1_1trd_1_1FeeParam_html"><div class="ttname"><a href="../../db/d0c/classo2_1_1trd_1_1FeeParam.html">o2::trd::FeeParam</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d36/FeeParam_8h_source.html#l00041">FeeParam.h:41</a></div></div>
<div class="ttc" id="classo2_1_1trd_1_1Digit_html_aa07ae55dafea1c2a2bb067b3ea564ea2"><div class="ttname"><a href="../../d7/d48/classo2_1_1trd_1_1Digit.html#aa07ae55dafea1c2a2bb067b3ea564ea2">o2::trd::Digit::getPad</a></div><div class="ttdeci">int getPad() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/da5/Detectors_2TRD_2base_2include_2TRDBase_2Digit_8h_source.html#l00052">Digit.h:52</a></div></div>
<div class="ttc" id="namespaceo2_1_1trd_html_a273a0c4630ee720226ee0b4f36b62733"><div class="ttname"><a href="../../d2/d76/namespaceo2_1_1trd.html#a273a0c4630ee720226ee0b4f36b62733">o2::trd::DigitSortComparatorPadRow</a></div><div class="ttdeci">bool DigitSortComparatorPadRow(o2::trd::Digit const &amp;a, o2::trd::Digit const &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de7/TRDTrapSimulatorSpec_8cxx_source.html#l00095">TRDTrapSimulatorSpec.cxx:95</a></div></div>
<div class="ttc" id="TrapSimulator_8h_html"><div class="ttname"><a href="../../d7/d42/TrapSimulator_8h.html">TrapSimulator.h</a></div></div>
<div class="ttc" id="TRD_2simulation_2include_2TRDSimulation_2Detector_8h_html"><div class="ttname"><a href="../../df/df0/TRD_2simulation_2include_2TRDSimulation_2Detector_8h.html">Detector.h</a></div></div>
<div class="ttc" id="classo2_1_1framework_1_1InitContext_html"><div class="ttname"><a href="../../d4/d07/classo2_1_1framework_1_1InitContext.html">o2::framework::InitContext</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2b/InitContext_8h_source.html#l00021">InitContext.h:21</a></div></div>
<div class="ttc" id="classo2_1_1trd_1_1TrapConfigHandler_html_adc2947f47e1a0951e5eceff8564c785a"><div class="ttname"><a href="../../dc/dba/classo2_1_1trd_1_1TrapConfigHandler.html#adc2947f47e1a0951e5eceff8564c785a">o2::trd::TrapConfigHandler::init</a></div><div class="ttdeci">void init()</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc3/TrapConfigHandler_8cxx_source.html#l00044">TrapConfigHandler.cxx:44</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a6eba317e3cf44d6d26c04a5a8f197dcb"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a6eba317e3cf44d6d26c04a5a8f197dcb">b</a></div><div class="ttdeci">GLboolean GLboolean GLboolean b</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l01233">glcorearb.h:1233</a></div></div>
<div class="ttc" id="classo2_1_1framework_1_1ConfigParamRegistry_html_ae86d66faf0b5cdc42a725d722be54d5e"><div class="ttname"><a href="../../df/d6f/classo2_1_1framework_1_1ConfigParamRegistry.html#ae86d66faf0b5cdc42a725d722be54d5e">o2::framework::ConfigParamRegistry::get</a></div><div class="ttdeci">T get(const char *key) const</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc6/ConfigParamRegistry_8h_source.html#l00051">ConfigParamRegistry.h:51</a></div></div>
<div class="ttc" id="ConfigParamRegistry_8h_html"><div class="ttname"><a href="../../de/dc6/ConfigParamRegistry_8h.html">ConfigParamRegistry.h</a></div></div>
<div class="ttc" id="classo2_1_1trd_1_1TrapConfigHandler_html"><div class="ttname"><a href="../../dc/dba/classo2_1_1trd_1_1TrapConfigHandler.html">o2::trd::TrapConfigHandler</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d00/TrapConfigHandler_8h_source.html#l00032">TrapConfigHandler.h:32</a></div></div>
<div class="ttc" id="structo2_1_1framework_1_1Output_html"><div class="ttname"><a href="../../d1/dc1/structo2_1_1framework_1_1Output.html">o2::framework::Output</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddf/Output_8h_source.html#l00028">Output.h:28</a></div></div>
<div class="ttc" id="ControlService_8h_html"><div class="ttname"><a href="../../d2/d43/ControlService_8h.html">ControlService.h</a></div></div>
<div class="ttc" id="MCCompLabel_8h_html"><div class="ttname"><a href="../../d7/dcd/MCCompLabel_8h.html">MCCompLabel.h</a></div></div>
<div class="ttc" id="classo2_1_1trd_1_1Digit_html_a4c65ec2dfd903d39e0df1965caed066f"><div class="ttname"><a href="../../d7/d48/classo2_1_1trd_1_1Digit.html#a4c65ec2dfd903d39e0df1965caed066f">o2::trd::Digit::getRow</a></div><div class="ttdeci">int getRow() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/da5/Detectors_2TRD_2base_2include_2TRDBase_2Digit_8h_source.html#l00051">Digit.h:51</a></div></div>
<div class="ttc" id="TRD_2include_2DataFormatsTRD_2TriggerRecord_8h_html"><div class="ttname"><a href="../../d9/dbe/TRD_2include_2DataFormatsTRD_2TriggerRecord_8h.html">TriggerRecord.h</a></div></div>
<div class="ttc" id="qconfigoptions_8h_html_aafec0419b86d778bf3583702a2e6392c"><div class="ttname"><a href="../../d8/de9/qconfigoptions_8h.html#aafec0419b86d778bf3583702a2e6392c">run</a></div><div class="ttdeci">Run track merging Number of iterations to Number of iterations to Number of initial iterations excluded from const char Directory with events to Number of OMP threads to run(-1:all)&quot;</div></div>
<div class="ttc" id="HitProcessingManager_8h_html"><div class="ttname"><a href="../../dd/d40/HitProcessingManager_8h.html">HitProcessingManager.h</a></div></div>
<div class="ttc" id="structo2_1_1framework_1_1OutputSpec_html"><div class="ttname"><a href="../../d8/dc3/structo2_1_1framework_1_1OutputSpec.html">o2::framework::OutputSpec</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d2d/OutputSpec_8h_source.html#l00029">OutputSpec.h:29</a></div></div>
<div class="ttc" id="qconfigoptions_8h_html_a8811c5158a219e0bc489747955a647ae"><div class="ttname"><a href="../../d8/de9/qconfigoptions_8h.html#a8811c5158a219e0bc489747955a647ae">trd</a></div><div class="ttdeci">Visualize clusters only Timeframe settings Average distance in cm of events merged into Randomize distance around average distance of merged events Simulate correct bunch interactions instead of placing only the average number of events A value [n] sets TFlen for [n] collisions in Number of bunches per train Number of bunch trains Instantaneous interaction rate Do not simulate border Total number of collisions to be placed in the interior of all time Do not select random but walk over array of events in stride steps h QA settings const char Legend entries for data from comparison histogram files const char Store histograms in output root Do not run but just create PDFs from input root files Set cut for Q Compute the efficiency including impure tracks with fake contamination Maxmimum Create resolution histograms in the native fit Filter for Filter for Particle Store mc labels to file for later matching Minimum Pt of a matched track to be displayed Compare QA QAonly Event generator settings h Reconstruction settings trd</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/de9/qconfigoptions_8h_source.html#l00070">qconfigoptions.h:70</a></div></div>
<div class="ttc" id="Task_8h_html"><div class="ttname"><a href="../../df/d4f/Task_8h.html">Task.h</a></div></div>
<div class="ttc" id="MCTruthContainer_8h_html"><div class="ttname"><a href="../../db/d14/MCTruthContainer_8h.html">MCTruthContainer.h</a></div><div class="ttdoc">Definition of a container to keep Monte Carlo truth external to simulation objects. </div></div>
<div class="ttc" id="GRPObject_8h_html"><div class="ttname"><a href="../../de/d28/GRPObject_8h.html">GRPObject.h</a></div><div class="ttdoc">Header of the General Run Parameters object. </div></div>
<div class="ttc" id="structo2_1_1framework_1_1InputSpec_html"><div class="ttname"><a href="../../da/d96/structo2_1_1framework_1_1InputSpec.html">o2::framework::InputSpec</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3f/InputSpec_8h_source.html#l00029">InputSpec.h:29</a></div></div>
<div class="ttc" id="namespaceo2_1_1framework_html_af99101fa4f6d5dd76f39eb050f2b2d2a"><div class="ttname"><a href="../../dd/d8d/namespaceo2_1_1framework.html#af99101fa4f6d5dd76f39eb050f2b2d2a">o2::framework::Outputs</a></div><div class="ttdeci">std::vector&lt; OutputSpec &gt; Outputs</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/DataProcessorSpec_8h_source.html#l00027">DataProcessorSpec.h:27</a></div></div>
<div class="ttc" id="DataProcessorSpec_8h_html"><div class="ttname"><a href="../../d0/df4/DataProcessorSpec_8h.html">DataProcessorSpec.h</a></div></div>
<div class="ttc" id="classo2_1_1framework_1_1ProcessingContext_html_acf17ebe3e8fd81cefc8babca3e6a9f70"><div class="ttname"><a href="../../d3/db7/classo2_1_1framework_1_1ProcessingContext.html#acf17ebe3e8fd81cefc8babca3e6a9f70">o2::framework::ProcessingContext::outputs</a></div><div class="ttdeci">DataAllocator &amp; outputs()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d6a/ProcessingContext_8h_source.html#l00035">ProcessingContext.h:35</a></div></div>
<div class="ttc" id="classo2_1_1trd_1_1TrapConfig_html"><div class="ttname"><a href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html">o2::trd::TrapConfig</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dbb/TrapConfig_8h_source.html#l00034">TrapConfig.h:34</a></div></div>
<div class="ttc" id="classo2_1_1trd_1_1Digit_html"><div class="ttname"><a href="../../d7/d48/classo2_1_1trd_1_1Digit.html">o2::trd::Digit</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/da5/Detectors_2TRD_2base_2include_2TRDBase_2Digit_8h_source.html#l00033">Digit.h:33</a></div></div>
<div class="ttc" id="TRD_2simulation_2include_2TRDSimulation_2Digitizer_8h_html"><div class="ttname"><a href="../../d4/dae/TRD_2simulation_2include_2TRDSimulation_2Digitizer_8h.html">Digitizer.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_051dca18e802f8e9474f2e30d29c04e0.html">Detectors</a></li><li class="navelem"><a class="el" href="../../dir_69dd0583e11051991bf4c0cf23c50933.html">TRD</a></li><li class="navelem"><a class="el" href="../../dir_184e1d06e85fb151746c3bdf717cc8ad.html">workflow</a></li><li class="navelem"><a class="el" href="../../dir_19cbc61730528058d9acd8ae2ca70332.html">src</a></li><li class="navelem"><a class="el" href="../../dd/de7/TRDTrapSimulatorSpec_8cxx.html">TRDTrapSimulatorSpec.cxx</a></li>
    <li class="footer">Generated on Thu Jun 4 2020 09:30:32 for Project by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
