<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Project: /home/travis/build/AliceO2Group/AliceO2/Detectors/TPC/reconstruction/test/testTPCHwClusterer.cxx Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../o2_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('df/d47/testTPCHwClusterer_8cxx_source.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">testTPCHwClusterer.cxx</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../df/d47/testTPCHwClusterer_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Copyright CERN and copyright holders of ALICE O2. This software is</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// distributed under the terms of the GNU General Public License v3 (GPL</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Version 3), copied verbatim in the file &quot;COPYING&quot;.</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// See http://alice-o2.web.cern.ch/license for full licensing information.</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// In applying this license CERN does not waive the privileges and immunities</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// granted to it by virtue of its status as an Intergovernmental Organization</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// or submit itself to any jurisdiction.</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno"><a class="line" href="../../df/d47/testTPCHwClusterer_8cxx.html#a6b2a3852db8bb19ab6909bac01859985">   15</a></span>&#160;<span class="preprocessor">#define BOOST_TEST_MODULE Test TPC HwClusterer</span></div><div class="line"><a name="l00016"></a><span class="lineno"><a class="line" href="../../df/d47/testTPCHwClusterer_8cxx.html#ab340a5e76af466a5f20ec5500d30a80b">   16</a></span>&#160;<span class="preprocessor">#define BOOST_TEST_MAIN</span></div><div class="line"><a name="l00017"></a><span class="lineno"><a class="line" href="../../df/d47/testTPCHwClusterer_8cxx.html#a139f00d2466d591f60b8d6a73c8273f1">   17</a></span>&#160;<span class="preprocessor">#define BOOST_TEST_DYN_LINK</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;boost/test/unit_test.hpp&gt;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/d7c/DataFormats_2Detectors_2TPC_2include_2DataFormatsTPC_2Helpers_8h.html">DataFormatsTPC/Helpers.h</a>&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d7d/DataFormats_2Detectors_2TPC_2include_2DataFormatsTPC_2Digit_8h.html">DataFormatsTPC/Digit.h</a>&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d1d/TPC_2base_2include_2TPCBase_2Mapper_8h.html">TPCBase/Mapper.h</a>&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/df6/HwClusterer_8h.html">TPCReconstruction/HwClusterer.h</a>&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/d14/MCTruthContainer_8h.html">SimulationDataFormat/MCTruthContainer.h</a>&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/dcd/MCCompLabel_8h.html">SimulationDataFormat/MCCompLabel.h</a>&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword">namespace </span><a class="code" href="../../d4/d7c/namespaceo2.html">o2</a></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;{</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keyword">namespace </span>tpc</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;{</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">// some helper functions / struct</span></div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="../../d9/d6b/structo2_1_1tpc_1_1sortTime.html">   36</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d9/d6b/structo2_1_1tpc_1_1sortTime.html">sortTime</a> {</div><div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="../../d9/d6b/structo2_1_1tpc_1_1sortTime.html#a28f7f268014bb38429a50a95468a6154">   37</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="../../d9/d6b/structo2_1_1tpc_1_1sortTime.html#a28f7f268014bb38429a50a95468a6154">operator()</a>(<span class="keyword">const</span> <a class="code" href="../../d1/d46/classo2_1_1tpc_1_1Digit.html">o2::tpc::Digit</a>&amp; d1, <span class="keyword">const</span> <a class="code" href="../../d1/d46/classo2_1_1tpc_1_1Digit.html">o2::tpc::Digit</a>&amp; d2)</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  {</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordflow">return</span> (d1.getTimeStamp() &lt; d2.getTimeStamp());</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  }</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;};</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="../../d0/d0a/namespaceo2_1_1tpc.html#a7fa614fe23094b9dfe1224b76e2ab66c">   43</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a7fa614fe23094b9dfe1224b76e2ab66c">p_pre</a>(std::array&lt;int, 25&gt;&amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>)</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;{</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordtype">int</span> ret = 0;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  ret += -2 * (data[0]) - (data[1]) + 0 * (data[3]) + (data[3]) + 2 * (data[4]);</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  ret += -2 * (data[5]) - (data[6]) + 0 * (data[8]) + (data[8]) + 2 * (data[9]);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  ret += -2 * (data[10]) - (data[11]) + 0 * (data[13]) + (data[13]) + 2 * (data[14]);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  ret += -2 * (data[15]) - (data[16]) + 0 * (data[18]) + (data[18]) + 2 * (data[19]);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  ret += -2 * (data[20]) - (data[21]) + 0 * (data[23]) + (data[23]) + 2 * (data[24]);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;};</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="../../d0/d0a/namespaceo2_1_1tpc.html#ad87e960b884330c83a7e8067aa57d05e">   54</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#ad87e960b884330c83a7e8067aa57d05e">sigma_p_pre</a>(std::array&lt;int, 25&gt;&amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>)</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;{</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordtype">int</span> ret = 0;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  ret += 4 * (data[0]) + (data[1]) + 0 * (data[3]) + (data[3]) + 4 * (data[4]);</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  ret += 4 * (data[5]) + (data[6]) + 0 * (data[8]) + (data[8]) + 4 * (data[9]);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  ret += 4 * (data[10]) + (data[11]) + 0 * (data[13]) + (data[13]) + 4 * (data[14]);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  ret += 4 * (data[15]) + (data[16]) + 0 * (data[18]) + (data[18]) + 4 * (data[19]);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  ret += 4 * (data[20]) + (data[21]) + 0 * (data[23]) + (data[23]) + 4 * (data[24]);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;};</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="../../d0/d0a/namespaceo2_1_1tpc.html#a77da24d02dec1a41ca4cf20a25c39ded">   65</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a77da24d02dec1a41ca4cf20a25c39ded">t_pre</a>(std::array&lt;int, 25&gt;&amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>)</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;{</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordtype">int</span> ret = 0;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  ret += -2 * (data[0]) - 2 * (data[1]) - 2 * (data[2]) - 2 * (data[3]) - 2 * (data[4]);</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  ret += -1 * (data[5]) - 1 * (data[6]) - 1 * (data[7]) - 1 * (data[8]) - 1 * (data[9]);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  ret += 0 * (data[10]) + 0 * (data[11]) + 0 * (data[12]) + 0 * (data[13]) + 0 * (data[14]);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  ret += 1 * (data[15]) + 1 * (data[16]) + 1 * (data[17]) + 1 * (data[18]) + 1 * (data[19]);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  ret += 2 * (data[20]) + 2 * (data[21]) + 2 * (data[22]) + 2 * (data[23]) + 2 * (data[24]);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;};</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="../../d0/d0a/namespaceo2_1_1tpc.html#af0a73aac97b31c66edd0faa054e0a943">   76</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#af0a73aac97b31c66edd0faa054e0a943">sigma_t_pre</a>(std::array&lt;int, 25&gt;&amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>)</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;{</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordtype">int</span> ret = 0;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  ret += 4 * (data[0]) + 4 * (data[1]) + 4 * (data[2]) + 4 * (data[3]) + 4 * (data[4]);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  ret += 1 * (data[5]) + 1 * (data[6]) + 1 * (data[7]) + 1 * (data[8]) + 1 * (data[9]);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  ret += 0 * (data[10]) + 0 * (data[11]) + 0 * (data[12]) + 0 * (data[13]) + 0 * (data[14]);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  ret += 1 * (data[15]) + 1 * (data[16]) + 1 * (data[17]) + 1 * (data[18]) + 1 * (data[19]);</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  ret += 4 * (data[20]) + 4 * (data[21]) + 4 * (data[22]) + 4 * (data[23]) + 4 * (data[24]);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;};</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="../../d0/d0a/namespaceo2_1_1tpc.html#a286e9bdb2374fc9f58f6c9565968ec64">   87</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a286e9bdb2374fc9f58f6c9565968ec64">p_pre_fp</a>(std::array&lt;float, 25&gt;&amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>)</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;{</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordtype">int</span> ret = 0;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  ret += -2 * (data[0] * 16) - (data[1] * 16) + 0 * (data[3] * 16) + (data[3] * 16) + 2 * (data[4] * 16);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  ret += -2 * (data[5] * 16) - (data[6] * 16) + 0 * (data[8] * 16) + (data[8] * 16) + 2 * (data[9] * 16);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  ret += -2 * (data[10] * 16) - (data[11] * 16) + 0 * (data[13] * 16) + (data[13] * 16) + 2 * (data[14] * 16);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  ret += -2 * (data[15] * 16) - (data[16] * 16) + 0 * (data[18] * 16) + (data[18] * 16) + 2 * (data[19] * 16);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  ret += -2 * (data[20] * 16) - (data[21] * 16) + 0 * (data[23] * 16) + (data[23] * 16) + 2 * (data[24] * 16);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;};</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="../../d0/d0a/namespaceo2_1_1tpc.html#a045aac36e3fc1283e21d208febbcfd7d">   98</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a045aac36e3fc1283e21d208febbcfd7d">sigma_p_pre_fp</a>(std::array&lt;float, 25&gt;&amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>)</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;{</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordtype">int</span> ret = 0;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  ret += 4 * (data[0] * 16) + (data[1] * 16) + 0 * (data[3] * 16) + (data[3] * 16) + 4 * (data[4] * 16);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  ret += 4 * (data[5] * 16) + (data[6] * 16) + 0 * (data[8] * 16) + (data[8] * 16) + 4 * (data[9] * 16);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  ret += 4 * (data[10] * 16) + (data[11] * 16) + 0 * (data[13] * 16) + (data[13] * 16) + 4 * (data[14] * 16);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  ret += 4 * (data[15] * 16) + (data[16] * 16) + 0 * (data[18] * 16) + (data[18] * 16) + 4 * (data[19] * 16);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  ret += 4 * (data[20] * 16) + (data[21] * 16) + 0 * (data[23] * 16) + (data[23] * 16) + 4 * (data[24] * 16);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;};</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6058326f702b3486039e2e0e0e3a2b0d">  109</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6058326f702b3486039e2e0e0e3a2b0d">t_pre_fp</a>(std::array&lt;float, 25&gt;&amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>)</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;{</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordtype">int</span> ret = 0;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  ret += -2 * (data[0] * 16) - 2 * (data[1] * 16) - 2 * (data[2] * 16) - 2 * (data[3] * 16) - 2 * (data[4] * 16);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  ret += -1 * (data[5] * 16) - 1 * (data[6] * 16) - 1 * (data[7] * 16) - 1 * (data[8] * 16) - 1 * (data[9] * 16);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  ret += 0 * (data[10] * 16) + 0 * (data[11] * 16) + 0 * (data[12] * 16) + 0 * (data[13] * 16) + 0 * (data[14] * 16);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  ret += 1 * (data[15] * 16) + 1 * (data[16] * 16) + 1 * (data[17] * 16) + 1 * (data[18] * 16) + 1 * (data[19] * 16);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  ret += 2 * (data[20] * 16) + 2 * (data[21] * 16) + 2 * (data[22] * 16) + 2 * (data[23] * 16) + 2 * (data[24] * 16);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;};</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="../../d0/d0a/namespaceo2_1_1tpc.html#a091e548b5a234094aece83f89cc6d668">  120</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a091e548b5a234094aece83f89cc6d668">sigma_t_pre_fp</a>(std::array&lt;float, 25&gt;&amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>)</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;{</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordtype">int</span> ret = 0;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  ret += 4 * (data[0] * 16) + 4 * (data[1] * 16) + 4 * (data[2] * 16) + 4 * (data[3] * 16) + 4 * (data[4] * 16);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  ret += 1 * (data[5] * 16) + 1 * (data[6] * 16) + 1 * (data[7] * 16) + 1 * (data[8] * 16) + 1 * (data[9] * 16);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  ret += 0 * (data[10] * 16) + 0 * (data[11] * 16) + 0 * (data[12] * 16) + 0 * (data[13] * 16) + 0 * (data[14] * 16);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  ret += 1 * (data[15] * 16) + 1 * (data[16] * 16) + 1 * (data[17] * 16) + 1 * (data[18] * 16) + 1 * (data[19] * 16);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  ret += 4 * (data[20] * 16) + 4 * (data[21] * 16) + 4 * (data[22] * 16) + 4 * (data[23] * 16) + 4 * (data[24] * 16);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;};</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="../../d0/d0a/namespaceo2_1_1tpc.html#a0cac6fced942d7b3a2746fba8ff0fd0c">  132</a></span>&#160;<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a040c4bfa70ddfb0a6910de9e479a05a4">BOOST_AUTO_TEST_CASE</a>(HwClusterer_test1)</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;{</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;##&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;## Starting test 1, basic class tests.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keyword">using</span> <a class="code" href="../../dc/daa/classo2_1_1dataformats_1_1MCTruthContainer.html">MCLabelContainer</a> = <a class="code" href="../../dc/daa/classo2_1_1dataformats_1_1MCTruthContainer.html">o2::dataformats::MCTruthContainer&lt;o2::MCCompLabel&gt;</a>;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keyword">auto</span> clusterArray = std::make_unique&lt;std::vector&lt;ClusterHardwareContainer8kb&gt;&gt;();</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keyword">auto</span> labelArray = std::make_unique&lt;MCLabelContainer&gt;();</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <a class="code" href="../../d2/d09/classo2_1_1tpc_1_1HwClusterer.html">HwClusterer</a> clusterer(clusterArray.get(), 0, labelArray.get());</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="comment">// If continuous readout is false, all clusters are written directly to the output</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  clusterer.<a class="code" href="../../d2/d09/classo2_1_1tpc_1_1HwClusterer.html#a8492607b3362cb43919a32c94bb13292">setContinuousReadout</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keyword">auto</span> digitVec = std::vector&lt;Digit&gt;();</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <a class="code" href="../../dc/daa/classo2_1_1dataformats_1_1MCTruthContainer.html">MCLabelContainer</a> labelContainer;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="comment">// create three digits above peak charge threshold, two close to each other</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="comment">// which should result in one cluster</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  digitVec.emplace_back(0, 123, 13, 4, 2);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  digitVec.emplace_back(0, 12, 13, 5, 2);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  digitVec.emplace_back(0, 321, 7, 10, 10);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  labelContainer.<a class="code" href="../../dc/daa/classo2_1_1dataformats_1_1MCTruthContainer.html#a48909c36a47bc704d7d58672cb0e27fb">addElement</a>(0, {1, 0, 0, <span class="keyword">false</span>});</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  labelContainer.addElement(1, {2, 0, 0, <span class="keyword">false</span>});</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  labelContainer.addElement(2, {3, 0, 0, <span class="keyword">false</span>});</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keyword">auto</span> digits = std::make_unique&lt;const std::vector&lt;Digit&gt;&gt;(digitVec);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keyword">auto</span> mcDigitTruth = std::make_unique&lt;const MCLabelContainer&gt;(labelContainer);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  clusterer.process(*digits.get(), mcDigitTruth.get());</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="comment">// check if clusters were found</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  BOOST_CHECK_EQUAL(clusterArray-&gt;size(), 1);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="comment">// check if two lusters were found, one in row 13 with charge 123 and one in 12 with charge 321</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  BOOST_CHECK_EQUAL(clusterArray-&gt;at(0).getContainer()-&gt;numberOfClusters, 2);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  BOOST_CHECK_EQUAL(clusterArray-&gt;at(0).getContainer()-&gt;clusters[0].getRow(), 13);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  BOOST_CHECK_EQUAL(clusterArray-&gt;at(0).getContainer()-&gt;clusters[0].getQMax(), 123);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  BOOST_CHECK_EQUAL(clusterArray-&gt;at(0).getContainer()-&gt;clusters[1].getRow(), 7);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  BOOST_CHECK_EQUAL(clusterArray-&gt;at(0).getContainer()-&gt;clusters[1].getQMax(), 321);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="comment">// check if MC labels are propagated correctly</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  BOOST_CHECK_EQUAL(labelArray-&gt;getLabels(0).size(), 2); <span class="comment">// first cluster got two MC labels</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  BOOST_CHECK_EQUAL(labelArray-&gt;getLabels(0)[0].getTrackID(), 1);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  BOOST_CHECK_EQUAL(labelArray-&gt;getLabels(0)[1].getTrackID(), 2);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  BOOST_CHECK_EQUAL(labelArray-&gt;getLabels(1).size(), 1); <span class="comment">// second cluster got one MC label</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  BOOST_CHECK_EQUAL(labelArray-&gt;getLabels(1)[0].getTrackID(), 3);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;## Test 1 done.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;##&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            &lt;&lt; std::endl;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;}</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="../../d0/d0a/namespaceo2_1_1tpc.html#a1e1c2c7499304cce9a6c6c719a38b6ee">  185</a></span>&#160;<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a040c4bfa70ddfb0a6910de9e479a05a4">BOOST_AUTO_TEST_CASE</a>(HwClusterer_test2)</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;{</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;##&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;## Starting test 2, finding single pad clusters.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keyword">using</span> <a class="code" href="../../dc/daa/classo2_1_1dataformats_1_1MCTruthContainer.html">MCLabelContainer</a> = <a class="code" href="../../dc/daa/classo2_1_1dataformats_1_1MCTruthContainer.html">o2::dataformats::MCTruthContainer&lt;o2::MCCompLabel&gt;</a>;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keyword">auto</span> clusterArray = std::make_unique&lt;std::vector&lt;o2::tpc::ClusterHardwareContainer8kb&gt;&gt;();</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keyword">auto</span> labelArray = std::make_unique&lt;o2::dataformats::MCTruthContainer&lt;o2::MCCompLabel&gt;&gt;();</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <a class="code" href="../../d2/d09/classo2_1_1tpc_1_1HwClusterer.html">o2::tpc::HwClusterer</a> clusterer(clusterArray.get(), 0, labelArray.get());</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="comment">// If continuous readout is false, all clusters are written directly to the output</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  clusterer.<a class="code" href="../../d2/d09/classo2_1_1tpc_1_1HwClusterer.html#a8492607b3362cb43919a32c94bb13292">setContinuousReadout</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keyword">auto</span> digits = std::make_unique&lt;std::vector&lt;o2::tpc::Digit&gt;&gt;();</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="comment">// create a lot of single pad clusters, one in every pad, well separated in time</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="comment">// which should result in one cluster</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="comment">// Digit(int cru, float charge, int row, int pad, int time)</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <a class="code" href="../../de/db6/classo2_1_1tpc_1_1Mapper.html">o2::tpc::Mapper</a>&amp; mapper = <a class="code" href="../../de/db6/classo2_1_1tpc_1_1Mapper.html#a750b7412728e537ff85ea3dd430ffb4e">o2::tpc::Mapper::instance</a>();</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  std::vector&lt;unsigned&gt; clusterPerRegionGenerated(10, 0);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="keywordtype">int</span> globalRow = 0;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> region = 0; region &lt; 10; ++region) {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row = 0; row &lt; mapper.getNumberOfRowsRegion(region); ++row) {</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <span class="keywordtype">int</span> time = 0;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> pad = 0; pad &lt; mapper.getNumberOfPadsInRowSector(globalRow); ++pad) {</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        ++clusterPerRegionGenerated[region];</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        digits-&gt;emplace_back(region, 20, globalRow, pad, time);</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        time += 7;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      }</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      ++globalRow;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    }</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  }</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  std::sort(digits-&gt;begin(), digits-&gt;end(), <a class="code" href="../../d9/d6b/structo2_1_1tpc_1_1sortTime.html">sortTime</a>());</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="comment">// Search clusters</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  clusterer.process(*digits.get(), <span class="keyword">nullptr</span>);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="comment">// Check result</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  BOOST_CHECK_EQUAL(clusterArray-&gt;size(), 47);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="comment">// check if all clusters were found</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  std::vector&lt;unsigned&gt; clusterPerRegionFound(10, 0);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; cont : *clusterArray) {</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keyword">auto</span> clusterContainer = cont.getContainer();</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    clusterPerRegionFound[clusterContainer-&gt;CRU] += clusterContainer-&gt;numberOfClusters;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  }</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> region = 0; region &lt; 10; ++region) {</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    BOOST_CHECK_EQUAL(clusterPerRegionFound[region], clusterPerRegionGenerated[region]);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  }</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="comment">// check if all cluster charges (tot and max) are 20</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; cont : *clusterArray) {</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keyword">auto</span> clusterContainer = cont.getContainer();</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> clIndex = 0; clIndex &lt; clusterContainer-&gt;numberOfClusters; ++clIndex) {</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[clIndex].getQTot(), 20);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[clIndex].getQMax(), 20);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    }</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  }</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="comment">// check the pad and time positions of the clusters and sigmas (all 0 because single pad lcusters)</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; cont : *clusterArray) {</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keyword">auto</span> clusterContainer = cont.getContainer();</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> clIndex = 0; clIndex &lt; clusterContainer-&gt;numberOfClusters; ++clIndex) {</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      BOOST_CHECK_EQUAL((clusterContainer-&gt;clusters[clIndex].getTimeLocal() + clusterContainer-&gt;timeBinOffset) / 7,</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                        clusterContainer-&gt;clusters[clIndex].getPad());</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[clIndex].getSigmaPad2(), 0);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[clIndex].getSigmaTime2(), 0);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    }</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  }</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;## Test 2 done.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;##&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            &lt;&lt; std::endl;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;}</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="../../d0/d0a/namespaceo2_1_1tpc.html#a5061e0f1fcf520b590a3943f7f047b89">  259</a></span>&#160;<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a040c4bfa70ddfb0a6910de9e479a05a4">BOOST_AUTO_TEST_CASE</a>(HwClusterer_test3)</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;{</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;##&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;## Starting test 3, computing cluster properties.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keyword">using</span> <a class="code" href="../../dc/daa/classo2_1_1dataformats_1_1MCTruthContainer.html">MCLabelContainer</a> = <a class="code" href="../../dc/daa/classo2_1_1dataformats_1_1MCTruthContainer.html">o2::dataformats::MCTruthContainer&lt;o2::MCCompLabel&gt;</a>;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keyword">auto</span> clusterArray = std::make_unique&lt;std::vector&lt;o2::tpc::ClusterHardwareContainer8kb&gt;&gt;();</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keyword">auto</span> labelArray = std::make_unique&lt;o2::dataformats::MCTruthContainer&lt;o2::MCCompLabel&gt;&gt;();</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <a class="code" href="../../d2/d09/classo2_1_1tpc_1_1HwClusterer.html">o2::tpc::HwClusterer</a> clusterer(clusterArray.get(), 0, labelArray.get());</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="comment">// If continuous readout is false, all clusters are written directly to the output</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  clusterer.<a class="code" href="../../d2/d09/classo2_1_1tpc_1_1HwClusterer.html#a8492607b3362cb43919a32c94bb13292">setContinuousReadout</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keyword">auto</span> digits = std::make_unique&lt;std::vector&lt;o2::tpc::Digit&gt;&gt;();</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="comment">// Digit(int cru, float charge, int row, int pad, int time)</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="comment">// Create digits for different clusters</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  std::array&lt;std::array&lt;int, 25&gt;, 6&gt; <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a00dc28d5db1371df938f63ad9eb450df">clusters</a> = {{{7, 10, 11, 8, 5,</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                                                   10, 18, 21, 15, 8,</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                                                   12, 22, 50, 20, 10,</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                                                   9, 16, 20, 15, 8,</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                                                   6, 9, 10, 8, 5},</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                                                  {7, 10, 11, 8, 5,</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                                                   11, 19, 22, 16, 9,</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                                                   14, 24, 52, 22, 12,</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                                                   12, 19, 23, 18, 11,</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                                                   10, 13, 14, 12, 9},</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                                                  {12, 15, 16, 13, 10,</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                                                   16, 24, 27, 21, 14,</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                                                   19, 29, 57, 27, 17,</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                                                   17, 24, 28, 23, 16,</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                                                   15, 18, 19, 17, 14},</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                                                  {17, 20, 21, 18, 15,</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                                                   21, 29, 32, 26, 19,</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                                                   24, 34, 62, 32, 22,</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                                                   22, 29, 33, 28, 21,</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                                                   20, 23, 24, 22, 19},</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                                                  {22, 25, 26, 23, 20,</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                                                   26, 34, 37, 31, 24,</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                                                   29, 39, 67, 37, 27,</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                                                   27, 34, 38, 33, 26,</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                                                   25, 28, 29, 27, 24},</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                                                  {27, 30, 31, 28, 25,</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                                                   31, 39, 42, 36, 29,</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                                                   34, 44, 72, 42, 32,</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                                   32, 39, 43, 38, 31,</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                                                   30, 33, 34, 32, 29}}};</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dp = 0; dp &lt; 5; ++dp) {</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dt = 0; dt &lt; 5; ++dt) {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cl = 0; cl &lt; clusters.size(); ++cl) {</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        digits-&gt;emplace_back(0, clusters[cl][dt * 5 + dp], cl, cl + dp, cl * 10 + dt);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      }</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    }</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  }</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  std::sort(digits-&gt;begin(), digits-&gt;end(), <a class="code" href="../../d9/d6b/structo2_1_1tpc_1_1sortTime.html">sortTime</a>());</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="comment">// Search clusters</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  clusterer.process(*digits.get(), <span class="keyword">nullptr</span>);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="comment">// Check outcome</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  BOOST_CHECK_EQUAL(clusterArray-&gt;size(), 1);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="keyword">auto</span> clusterContainer = (*clusterArray)[0].getContainer();</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="comment">// Checking cluster properties</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> clIndex = 0; clIndex &lt; clusterContainer-&gt;numberOfClusters; ++clIndex) {</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordtype">float</span> qtot = std::accumulate(clusters[clIndex].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clusters[clIndex].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">// Check QTot</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[clIndex].getQTot(), std::accumulate(clusters[clIndex].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clusters[clIndex].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0));</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">// Check QMax</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[clIndex].getQMax(), clusters[clIndex][12]);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">// Check row</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[clIndex].getRow(), clIndex);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">// Check Flags</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[clIndex].getFlags(), 0);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="comment">// Check pad</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    BOOST_CHECK_CLOSE(</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      clusterContainer-&gt;clusters[clIndex].getPad(),</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a7fa614fe23094b9dfe1224b76e2ab66c">p_pre</a>(clusters[clIndex]) / qtot + clIndex + 2,</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      0.0001);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">// Check time</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    BOOST_CHECK_CLOSE(</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      clusterContainer-&gt;clusters[clIndex].getTimeLocal() + clusterContainer-&gt;timeBinOffset,</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a77da24d02dec1a41ca4cf20a25c39ded">t_pre</a>(clusters[clIndex]) / qtot + clIndex * 10 + 2,</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      0.0001);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">// Check pad sigma</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    BOOST_CHECK_CLOSE(</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      clusterContainer-&gt;clusters[clIndex].getSigmaPad2(),</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      (<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#ad87e960b884330c83a7e8067aa57d05e">sigma_p_pre</a>(clusters[clIndex]) / qtot) - ((<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a7fa614fe23094b9dfe1224b76e2ab66c">p_pre</a>(clusters[clIndex]) * <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a7fa614fe23094b9dfe1224b76e2ab66c">p_pre</a>(clusters[clIndex])) / (qtot * qtot)),</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      0.0001);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">// Check time sigma</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    BOOST_CHECK_CLOSE(</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      clusterContainer-&gt;clusters[clIndex].getSigmaTime2(),</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      (<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#af0a73aac97b31c66edd0faa054e0a943">sigma_t_pre</a>(clusters[clIndex]) / qtot) - ((<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a77da24d02dec1a41ca4cf20a25c39ded">t_pre</a>(clusters[clIndex]) * <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a77da24d02dec1a41ca4cf20a25c39ded">t_pre</a>(clusters[clIndex])) / (qtot * qtot)),</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      0.0001);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  }</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;## Test 3 done.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;##&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            &lt;&lt; std::endl;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;}</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno"><a class="line" href="../../d0/d0a/namespaceo2_1_1tpc.html#a62cfa9c4d7c858d03d98dc48b868a5f2">  362</a></span>&#160;<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a040c4bfa70ddfb0a6910de9e479a05a4">BOOST_AUTO_TEST_CASE</a>(HwClusterer_test4)</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;{</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;##&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;## Starting test 4, rejecting single pad clusters.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="keyword">using</span> <a class="code" href="../../dc/daa/classo2_1_1dataformats_1_1MCTruthContainer.html">MCLabelContainer</a> = <a class="code" href="../../dc/daa/classo2_1_1dataformats_1_1MCTruthContainer.html">o2::dataformats::MCTruthContainer&lt;o2::MCCompLabel&gt;</a>;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keyword">auto</span> clusterArray = std::make_unique&lt;std::vector&lt;o2::tpc::ClusterHardwareContainer8kb&gt;&gt;();</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="keyword">auto</span> labelArray = std::make_unique&lt;o2::dataformats::MCTruthContainer&lt;o2::MCCompLabel&gt;&gt;();</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <a class="code" href="../../d2/d09/classo2_1_1tpc_1_1HwClusterer.html">o2::tpc::HwClusterer</a> clusterer(clusterArray.get(), 0, labelArray.get());</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="comment">// If continuous readout is false, all clusters are written directly to the output</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  clusterer.<a class="code" href="../../d2/d09/classo2_1_1tpc_1_1HwClusterer.html#a8492607b3362cb43919a32c94bb13292">setContinuousReadout</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="keyword">auto</span> digits = std::make_unique&lt;std::vector&lt;o2::tpc::Digit&gt;&gt;();</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="comment">// Digit(int cru, float charge, int row, int pad, int time)</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="comment">// single pad and time cluster</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  std::array&lt;std::array&lt;int, 25&gt;, 4&gt; <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a00dc28d5db1371df938f63ad9eb450df">clusters</a>;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  clusters[0] = {{0, 0, 0, 0, 0,</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                  0, 0, 0, 0, 0,</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                  0, 0, 67, 0, 0,</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                  0, 0, 0, 0, 0,</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                  0, 0, 0, 0, 0}};</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="comment">// single time cluster, but enlarged in pad direction</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  clusters[1] = {{0, 0, 0, 0, 0,</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                  0, 0, 0, 0, 0,</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                  0, 12, 72, 24, 0,</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                  0, 0, 0, 0, 0,</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                  0, 0, 0, 0, 0}};</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="comment">// single pad cluster, but enlarged in tim direction</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  clusters[2] = {{0, 0, 0, 0, 0,</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                  0, 0, 33, 0, 0,</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                  0, 0, 57, 0, 0,</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                  0, 0, 12, 0, 0,</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                  0, 0, 0, 0, 0}};</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="comment">// wide cluster in both direction</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  clusters[3] = {{0, 0, 0, 0, 0,</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                  0, 46, 71, 32, 0,</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                  0, 32, 129, 16, 0,</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                  0, 19, 53, 23, 0,</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                  0, 0, 0, 0, 0}};</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dp = 0; dp &lt; 5; ++dp) {</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dt = 0; dt &lt; 5; ++dt) {</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cl = 0; cl &lt; clusters.size(); ++cl) {</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        digits-&gt;emplace_back(0, clusters[cl][dt * 5 + dp], cl, cl + dp, cl * 10 + dt);</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      }</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    }</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  }</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  std::sort(digits-&gt;begin(), digits-&gt;end(), <a class="code" href="../../d9/d6b/structo2_1_1tpc_1_1sortTime.html">sortTime</a>());</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="comment">// Search clusters without thresholds, all 4 clusters shoud be found</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;testing without thresholds...&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  clusterer.setRejectSinglePadClusters(<span class="keyword">false</span>);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  clusterer.setRejectSingleTimeClusters(<span class="keyword">false</span>);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  clusterer.process(*digits.get(), <span class="keyword">nullptr</span>);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  BOOST_CHECK_EQUAL(clusterArray-&gt;size(), 1);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="keyword">auto</span> clusterContainer = (*clusterArray)[0].getContainer();</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  BOOST_CHECK_EQUAL(clusterContainer-&gt;numberOfClusters, 4);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> clIndex = 0; clIndex &lt; clusterContainer-&gt;numberOfClusters; ++clIndex) {</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordtype">float</span> qtot = std::accumulate(clusters[clIndex].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clusters[clIndex].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0);</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="comment">// Check QTot</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[clIndex].getQTot(), std::accumulate(clusters[clIndex].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clusters[clIndex].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0));</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="comment">// Check QMax</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[clIndex].getQMax(), clusters[clIndex][12]);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="comment">// Check row</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[clIndex].getRow(), clIndex);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="comment">// Check Flags</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[clIndex].getFlags(), 0);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">// Check pad</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    BOOST_CHECK_CLOSE(</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      clusterContainer-&gt;clusters[clIndex].getPad(),</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a7fa614fe23094b9dfe1224b76e2ab66c">p_pre</a>(clusters[clIndex]) / qtot + clIndex + 2,</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      0.0001);</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="comment">// Check time</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    BOOST_CHECK_CLOSE(</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      clusterContainer-&gt;clusters[clIndex].getTimeLocal() + clusterContainer-&gt;timeBinOffset,</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a77da24d02dec1a41ca4cf20a25c39ded">t_pre</a>(clusters[clIndex]) / qtot + clIndex * 10 + 2,</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      0.0001);</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="comment">// Check pad sigma</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    BOOST_CHECK_CLOSE(</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      clusterContainer-&gt;clusters[clIndex].getSigmaPad2(),</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      (<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#ad87e960b884330c83a7e8067aa57d05e">sigma_p_pre</a>(clusters[clIndex]) / qtot) - ((<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a7fa614fe23094b9dfe1224b76e2ab66c">p_pre</a>(clusters[clIndex]) * <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a7fa614fe23094b9dfe1224b76e2ab66c">p_pre</a>(clusters[clIndex])) / (qtot * qtot)),</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      0.0001);</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="comment">// Check time sigma</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    BOOST_CHECK_CLOSE(</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      clusterContainer-&gt;clusters[clIndex].getSigmaTime2(),</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      (<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#af0a73aac97b31c66edd0faa054e0a943">sigma_t_pre</a>(clusters[clIndex]) / qtot) - ((<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a77da24d02dec1a41ca4cf20a25c39ded">t_pre</a>(clusters[clIndex]) * <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a77da24d02dec1a41ca4cf20a25c39ded">t_pre</a>(clusters[clIndex])) / (qtot * qtot)),</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      0.0001);</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  }</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="comment">// Search clusters with threshold in pad direction, only clusters 1 and 3 should be found</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;testing with pad threshold...&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  clusterer.setRejectSinglePadClusters(<span class="keyword">true</span>);</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  clusterer.setRejectSingleTimeClusters(<span class="keyword">false</span>);</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  clusterer.process(*digits.get(), <span class="keyword">nullptr</span>);</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  BOOST_CHECK_EQUAL(clusterArray-&gt;size(), 1);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  clusterContainer = (*clusterArray)[0].getContainer();</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  BOOST_CHECK_EQUAL(clusterContainer-&gt;numberOfClusters, 2);</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> clIndex = 0; clIndex &lt; clusterContainer-&gt;numberOfClusters; ++clIndex) {</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordtype">float</span> qtot = std::accumulate(clusters[clIndex * 2 + 1].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clusters[clIndex * 2 + 1].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="comment">// Check QTot</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[clIndex].getQTot(), std::accumulate(clusters[clIndex * 2 + 1].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clusters[clIndex * 2 + 1].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0));</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="comment">// Check QMax</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[clIndex].getQMax(), clusters[clIndex * 2 + 1][12]);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="comment">// Check row</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[clIndex].getRow(), clIndex * 2 + 1);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="comment">// Check Flags</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[clIndex].getFlags(), 0);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="comment">// Check pad</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    BOOST_CHECK_CLOSE(</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      clusterContainer-&gt;clusters[clIndex].getPad(),</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a7fa614fe23094b9dfe1224b76e2ab66c">p_pre</a>(clusters[clIndex * 2 + 1]) / qtot + (clIndex * 2 + 1) + 2,</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      0.0001);</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="comment">// Check time</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    BOOST_CHECK_CLOSE(</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      clusterContainer-&gt;clusters[clIndex].getTimeLocal() + clusterContainer-&gt;timeBinOffset,</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a77da24d02dec1a41ca4cf20a25c39ded">t_pre</a>(clusters[clIndex * 2 + 1]) / qtot + (clIndex * 2 + 1) * 10 + 2,</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      0.0001);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="comment">// Check pad sigma</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    BOOST_CHECK_CLOSE(</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      clusterContainer-&gt;clusters[clIndex].getSigmaPad2(),</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      (<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#ad87e960b884330c83a7e8067aa57d05e">sigma_p_pre</a>(clusters[clIndex * 2 + 1]) / qtot) - ((<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a7fa614fe23094b9dfe1224b76e2ab66c">p_pre</a>(clusters[clIndex * 2 + 1]) * <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a7fa614fe23094b9dfe1224b76e2ab66c">p_pre</a>(clusters[clIndex * 2 + 1])) / (qtot * qtot)),</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      0.0001);</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="comment">// Check time sigma</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    BOOST_CHECK_CLOSE(</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      clusterContainer-&gt;clusters[clIndex].getSigmaTime2(),</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      (<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#af0a73aac97b31c66edd0faa054e0a943">sigma_t_pre</a>(clusters[clIndex * 2 + 1]) / qtot) - ((<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a77da24d02dec1a41ca4cf20a25c39ded">t_pre</a>(clusters[clIndex * 2 + 1]) * <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a77da24d02dec1a41ca4cf20a25c39ded">t_pre</a>(clusters[clIndex * 2 + 1])) / (qtot * qtot)),</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      0.0001);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  }</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="comment">// Search clusters with threshold in time direction, only clusters 2 and 3 should be found</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;testing with time threshold...&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  clusterer.setRejectSinglePadClusters(<span class="keyword">false</span>);</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  clusterer.setRejectSingleTimeClusters(<span class="keyword">true</span>);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  clusterer.process(*digits.get(), <span class="keyword">nullptr</span>);</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  BOOST_CHECK_EQUAL(clusterArray-&gt;size(), 1);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  clusterContainer = (*clusterArray)[0].getContainer();</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  BOOST_CHECK_EQUAL(clusterContainer-&gt;numberOfClusters, 2);</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> clIndex = 0; clIndex &lt; clusterContainer-&gt;numberOfClusters; ++clIndex) {</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordtype">float</span> qtot = std::accumulate(clusters[clIndex + 2].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clusters[clIndex + 2].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0);</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="comment">// Check QTot</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[clIndex].getQTot(), std::accumulate(clusters[clIndex + 2].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clusters[clIndex + 2].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0));</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="comment">// Check QMax</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[clIndex].getQMax(), clusters[clIndex + 2][12]);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="comment">// Check row</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[clIndex].getRow(), clIndex + 2);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="comment">// Check Flags</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[clIndex].getFlags(), 0);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="comment">// Check pad</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    BOOST_CHECK_CLOSE(</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      clusterContainer-&gt;clusters[clIndex].getPad(),</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a7fa614fe23094b9dfe1224b76e2ab66c">p_pre</a>(clusters[clIndex + 2]) / qtot + (clIndex + 2) + 2,</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      0.0001);</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="comment">// Check time</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    BOOST_CHECK_CLOSE(</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      clusterContainer-&gt;clusters[clIndex].getTimeLocal() + clusterContainer-&gt;timeBinOffset,</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a77da24d02dec1a41ca4cf20a25c39ded">t_pre</a>(clusters[clIndex + 2]) / qtot + (clIndex + 2) * 10 + 2,</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      0.0001);</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="comment">// Check pad sigma</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    BOOST_CHECK_CLOSE(</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      clusterContainer-&gt;clusters[clIndex].getSigmaPad2(),</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      (<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#ad87e960b884330c83a7e8067aa57d05e">sigma_p_pre</a>(clusters[clIndex + 2]) / qtot) - ((<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a7fa614fe23094b9dfe1224b76e2ab66c">p_pre</a>(clusters[clIndex + 2]) * <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a7fa614fe23094b9dfe1224b76e2ab66c">p_pre</a>(clusters[clIndex + 2])) / (qtot * qtot)),</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      0.0001);</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="comment">// Check time sigma</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    BOOST_CHECK_CLOSE(</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      clusterContainer-&gt;clusters[clIndex].getSigmaTime2(),</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      (<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#af0a73aac97b31c66edd0faa054e0a943">sigma_t_pre</a>(clusters[clIndex + 2]) / qtot) - ((<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a77da24d02dec1a41ca4cf20a25c39ded">t_pre</a>(clusters[clIndex + 2]) * <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a77da24d02dec1a41ca4cf20a25c39ded">t_pre</a>(clusters[clIndex + 2])) / (qtot * qtot)),</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      0.0001);</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  }</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <span class="comment">// Search clusters with both thresholds, only cluster 3 should be found</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;testing both thresholds...&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  clusterer.setRejectSinglePadClusters(<span class="keyword">true</span>);</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  clusterer.setRejectSingleTimeClusters(<span class="keyword">true</span>);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  clusterer.process(*digits.get(), <span class="keyword">nullptr</span>);</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  BOOST_CHECK_EQUAL(clusterArray-&gt;size(), 1);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  clusterContainer = (*clusterArray)[0].getContainer();</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  BOOST_CHECK_EQUAL(clusterContainer-&gt;numberOfClusters, 1);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> clIndex = 0; clIndex &lt; clusterContainer-&gt;numberOfClusters; ++clIndex) {</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keywordtype">float</span> qtot = std::accumulate(clusters[clIndex + 3].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clusters[clIndex + 3].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0);</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="comment">// Check QTot</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[clIndex].getQTot(), std::accumulate(clusters[clIndex + 3].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clusters[clIndex + 3].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0));</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="comment">// Check QMax</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[clIndex].getQMax(), clusters[clIndex + 3][12]);</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="comment">// Check row</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[clIndex].getRow(), clIndex + 3);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="comment">// Check Flags</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[clIndex].getFlags(), 0);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="comment">// Check pad</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    BOOST_CHECK_CLOSE(</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      clusterContainer-&gt;clusters[clIndex].getPad(),</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a7fa614fe23094b9dfe1224b76e2ab66c">p_pre</a>(clusters[clIndex + 3]) / qtot + (clIndex + 3) + 2,</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      0.0001);</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="comment">// Check time</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    BOOST_CHECK_CLOSE(</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      clusterContainer-&gt;clusters[clIndex].getTimeLocal() + clusterContainer-&gt;timeBinOffset,</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a77da24d02dec1a41ca4cf20a25c39ded">t_pre</a>(clusters[clIndex + 3]) / qtot + (clIndex + 3) * 10 + 2,</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      0.0001);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="comment">// Check pad sigma</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    BOOST_CHECK_CLOSE(</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      clusterContainer-&gt;clusters[clIndex].getSigmaPad2(),</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      (<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#ad87e960b884330c83a7e8067aa57d05e">sigma_p_pre</a>(clusters[clIndex + 3]) / qtot) - ((<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a7fa614fe23094b9dfe1224b76e2ab66c">p_pre</a>(clusters[clIndex + 3]) * <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a7fa614fe23094b9dfe1224b76e2ab66c">p_pre</a>(clusters[clIndex + 3])) / (qtot * qtot)),</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      0.0001);</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="comment">// Check time sigma</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    BOOST_CHECK_CLOSE(</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      clusterContainer-&gt;clusters[clIndex].getSigmaTime2(),</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      (<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#af0a73aac97b31c66edd0faa054e0a943">sigma_t_pre</a>(clusters[clIndex + 3]) / qtot) - ((<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a77da24d02dec1a41ca4cf20a25c39ded">t_pre</a>(clusters[clIndex + 3]) * <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a77da24d02dec1a41ca4cf20a25c39ded">t_pre</a>(clusters[clIndex + 3])) / (qtot * qtot)),</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      0.0001);</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  }</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;## Test 4 done.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;##&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            &lt;&lt; std::endl;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;}</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00581"></a><span class="lineno"><a class="line" href="../../d0/d0a/namespaceo2_1_1tpc.html#a64768d49c8884f89e2543cac2519b696">  581</a></span>&#160;<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a040c4bfa70ddfb0a6910de9e479a05a4">BOOST_AUTO_TEST_CASE</a>(HwClusterer_test5)</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;{</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;##&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;## Starting test 5, rejecting peaks in subsequent.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <span class="keyword">using</span> <a class="code" href="../../dc/daa/classo2_1_1dataformats_1_1MCTruthContainer.html">MCLabelContainer</a> = <a class="code" href="../../dc/daa/classo2_1_1dataformats_1_1MCTruthContainer.html">o2::dataformats::MCTruthContainer&lt;o2::MCCompLabel&gt;</a>;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="keyword">auto</span> clusterArray = std::make_unique&lt;std::vector&lt;o2::tpc::ClusterHardwareContainer8kb&gt;&gt;();</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <span class="keyword">auto</span> labelArray = std::make_unique&lt;o2::dataformats::MCTruthContainer&lt;o2::MCCompLabel&gt;&gt;();</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <a class="code" href="../../d2/d09/classo2_1_1tpc_1_1HwClusterer.html">o2::tpc::HwClusterer</a> clusterer(clusterArray.get(), 0, labelArray.get());</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="comment">// If continuous readout is false, all clusters are written directly to the output</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  clusterer.<a class="code" href="../../d2/d09/classo2_1_1tpc_1_1HwClusterer.html#a8492607b3362cb43919a32c94bb13292">setContinuousReadout</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="keyword">auto</span> digits = std::make_unique&lt;std::vector&lt;o2::tpc::Digit&gt;&gt;();</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="comment">// Digit(int cru, float charge, int row, int pad, int time)</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="comment">// two peaks, with the greater one afterwards</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  std::array&lt;std::array&lt;int, 25&gt;, 2&gt; <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a00dc28d5db1371df938f63ad9eb450df">clusters</a>;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  clusters[0] = {{0, 0, 6, 0, 0,</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                  0, 0, 23, 0, 0,</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                  0, 0, 7, 0, 0,</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                  0, 0, 77, 0, 0,</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                  0, 0, 5, 0, 0}};</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="comment">// two peaks, with the greater one first</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  clusters[1] = {{0, 0, 6, 0, 0,</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                  0, 0, 67, 0, 0,</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                  0, 0, 7, 0, 0,</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                  0, 0, 13, 0, 0,</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                  0, 0, 5, 0, 0}};</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dp = 0; dp &lt; 5; ++dp) {</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dt = 0; dt &lt; 5; ++dt) {</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cl = 0; cl &lt; clusters.size(); ++cl) {</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        digits-&gt;emplace_back(0, clusters[cl][dt * 5 + dp], cl, cl + dp, cl * 10 + dt);</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      }</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    }</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  }</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  std::sort(digits-&gt;begin(), digits-&gt;end(), <a class="code" href="../../d9/d6b/structo2_1_1tpc_1_1sortTime.html">sortTime</a>());</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="comment">// Search clusters without rejection, all 4 clusters shoud be found</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;testing without rejection...&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  clusterer.setRejectLaterTimebin(<span class="keyword">false</span>);</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  clusterer.process(*digits.get(), <span class="keyword">nullptr</span>);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  BOOST_CHECK_EQUAL(clusterArray-&gt;size(), 1);</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <span class="keyword">auto</span> clusterContainer = (*clusterArray)[0].getContainer();</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  BOOST_CHECK_EQUAL(clusterContainer-&gt;numberOfClusters, 4);</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[0].getQMax(), clusters[0][7]);</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[1].getQMax(), clusters[0][17]);</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[2].getQMax(), clusters[1][7]);</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[3].getQMax(), clusters[1][17]);</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <span class="comment">// Search clusters with rejection, cluster with peak charge 13 should be surpressed</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;testing with with rejection...&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  clusterer.setRejectLaterTimebin(<span class="keyword">true</span>);</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  clusterer.process(*digits.get(), <span class="keyword">nullptr</span>);</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  BOOST_CHECK_EQUAL(clusterArray-&gt;size(), 1);</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  clusterContainer = (*clusterArray)[0].getContainer();</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  BOOST_CHECK_EQUAL(clusterContainer-&gt;numberOfClusters, 3);</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[0].getQMax(), clusters[0][7]);</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[1].getQMax(), clusters[0][17]);</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[2].getQMax(), clusters[1][7]);</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;## Test 5 done.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;##&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            &lt;&lt; std::endl;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;}</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div><div class="line"><a name="l00649"></a><span class="lineno"><a class="line" href="../../d0/d0a/namespaceo2_1_1tpc.html#ae9cd708029137eefa75b658d5196810b">  649</a></span>&#160;<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a040c4bfa70ddfb0a6910de9e479a05a4">BOOST_AUTO_TEST_CASE</a>(HwClusterer_test6)</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;{</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;##&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;## Starting test 6, split charge among nearby clusters.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="keyword">using</span> <a class="code" href="../../dc/daa/classo2_1_1dataformats_1_1MCTruthContainer.html">MCLabelContainer</a> = <a class="code" href="../../dc/daa/classo2_1_1dataformats_1_1MCTruthContainer.html">o2::dataformats::MCTruthContainer&lt;o2::MCCompLabel&gt;</a>;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="keyword">auto</span> clusterArray = std::make_unique&lt;std::vector&lt;o2::tpc::ClusterHardwareContainer8kb&gt;&gt;();</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <span class="keyword">auto</span> labelArray = std::make_unique&lt;o2::dataformats::MCTruthContainer&lt;o2::MCCompLabel&gt;&gt;();</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  <a class="code" href="../../d2/d09/classo2_1_1tpc_1_1HwClusterer.html">o2::tpc::HwClusterer</a> clusterer(clusterArray.get(), 0, labelArray.get());</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="comment">// If continuous readout is false, all clusters are written directly to the output</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  clusterer.<a class="code" href="../../d2/d09/classo2_1_1tpc_1_1HwClusterer.html#a8492607b3362cb43919a32c94bb13292">setContinuousReadout</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="keyword">auto</span> digits = std::make_unique&lt;std::vector&lt;o2::tpc::Digit&gt;&gt;();</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="comment">// Digit(int cru, float charge, int row, int pad, int time)</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  std::array&lt;std::array&lt;int, 100&gt;, 6&gt; <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a00dc28d5db1371df938f63ad9eb450df">clusters</a>;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="comment">// Just a single cluster</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  clusters[0] = {{0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                  0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                  0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                  0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                  0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                  4, 9, 12, 6, 1, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                  8, 17, 25, 18, 5, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                  13, 22, 50, 28, 14, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                  9, 16, 27, 19, 7, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                  2, 7, 11, 6, 3, 0, 0, 0, 0, 0}};</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  <span class="comment">// Two clusters next to each other in pad direction, peaks well separated</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  clusters[1] = {{0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                  0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                  0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                  0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                  0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                  4, 9, 12, 6, 1, 4, 9, 12, 6, 1,</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                  8, 17, 25, 18, 5, 8, 17, 25, 18, 5,</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                  13, 22, 51, 28, 14, 13, 22, 52, 28, 15,</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                  9, 16, 27, 19, 7, 9, 16, 27, 19, 7,</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                  2, 7, 11, 6, 3, 2, 7, 11, 6, 3}};</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <span class="comment">// Two clusters next to each other in pad direction, peaks 4 pads appart</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  clusters[2] = {{0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                  0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                  0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                  0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                  0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                  4, 9, 12, 6, 1, 9, 12, 6, 1, 0,</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                  8, 17, 25, 18, 5, 17, 25, 18, 5, 0,</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                  13, 22, 53, 28, 14, 22, 54, 28, 15, 0,</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                  9, 16, 27, 19, 7, 16, 27, 19, 7, 0,</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                  2, 7, 11, 6, 3, 7, 11, 6, 3, 0}};</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  <span class="comment">// Two clusters next to each other in pad direction, peaks 3 pads appartd</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  clusters[3] = {{0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                  0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                  0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                  0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                  0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                  0, 4, 9, 12, 6, 9, 12, 6, 1, 0,</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                  0, 8, 17, 25, 18, 17, 25, 18, 5, 0,</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                  0, 13, 22, 55, 28, 22, 56, 28, 15, 0,</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                  0, 9, 16, 27, 19, 16, 27, 19, 7, 0,</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                  0, 2, 7, 11, 6, 7, 11, 6, 3, 0}};</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  <span class="comment">// Two clusters next to each other in pad direction, peaks 2 pads appartd</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  clusters[4] = {{0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                  0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                  0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                  0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                  0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                  0, 4, 9, 12, 6, 12, 6, 1, 0, 0,</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                  0, 8, 17, 25, 18, 25, 18, 5, 0, 0,</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                  0, 13, 22, 57, 28, 58, 28, 15, 0, 0,</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                  0, 9, 16, 27, 19, 27, 19, 7, 0, 0,</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                  0, 2, 7, 11, 6, 11, 6, 3, 0, 0}};</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <span class="comment">// Two clusters next to each other in diagonal direction</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  clusters[5] = {{0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                  0, 0, 0, 0, 0, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                  0, 0, 0, 0, 4, 9, 12, 6, 1, 0,</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                  0, 0, 0, 0, 8, 17, 25, 18, 5, 0,</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                  0, 0, 0, 0, 13, 22, 59, 28, 15, 0,</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                  4, 9, 12, 6, 9, 16, 27, 19, 7, 0,</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                  8, 17, 25, 18, 2, 7, 11, 6, 3, 0,</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                  13, 22, 60, 28, 14, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                  9, 16, 27, 19, 7, 0, 0, 0, 0, 0,</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                  2, 7, 11, 6, 3, 0, 0, 0, 0, 0}};</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  std::array&lt;std::array&lt;float, 25&gt;, 11&gt; clustersMode0;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  clustersMode0[0] = {{4, 9, 12, 6, 1,</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                       8, 17, 25, 18, 5,</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                       13, 22, 50, 28, 14,</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                       9, 16, 27, 19, 7,</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                       2, 7, 11, 6, 3}};</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  clustersMode0[1] = {{4, 9, 12, 6, 1,</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                       8, 17, 25, 18, 5,</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                       13, 22, 51, 28, 14,</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                       9, 16, 27, 19, 7,</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                       2, 7, 11, 6, 3}};</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  clustersMode0[2] = {{4, 9, 12, 6, 1,</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                       8, 17, 25, 18, 5,</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                       13, 22, 52, 28, 15,</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                       9, 16, 27, 19, 7,</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                       2, 7, 11, 6, 3}};</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  clustersMode0[3] = {{4, 9, 12, 6, 1,</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                       8, 17, 25, 18, 5,</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                       13, 22, 53, 28, 14,</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                       9, 16, 27, 19, 7,</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                       2, 7, 11, 6, 3}};</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  clustersMode0[4] = {{1, 9, 12, 6, 1,</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                       5, 17, 25, 18, 5,</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                       14, 22, 54, 28, 15,</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                       7, 16, 27, 19, 7,</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                       3, 7, 11, 6, 3}};</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  clustersMode0[5] = {{4, 9, 12, 6, 9,</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                       8, 17, 25, 18, 17,</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                       13, 22, 55, 28, 22,</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                       9, 16, 27, 19, 16,</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                       2, 7, 11, 6, 7}};</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  clustersMode0[6] = {{6, 9, 12, 6, 1,</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                       18, 17, 25, 18, 5,</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                       28, 22, 56, 28, 15,</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                       19, 16, 27, 19, 7,</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                       6, 7, 11, 6, 3}};</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  clustersMode0[7] = {{4, 9, 12, 6, 12,</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                       8, 17, 25, 18, 25,</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                       13, 22, 57, 28, 58,</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                       9, 16, 27, 19, 27,</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                       2, 7, 11, 6, 11}};</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  clustersMode0[8] = {{12, 6, 12, 6, 1,</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                       25, 18, 25, 18, 5,</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                       57, 28, 58, 28, 15,</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                       27, 19, 27, 19, 7,</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                       11, 6, 11, 6, 3}};</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  clustersMode0[9] = {{4, 9, 12, 6, 1,</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                       8, 17, 25, 18, 5,</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                       13, 22, 59, 28, 15,</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                       9, 16, 27, 19, 7,</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                       2, 7, 11, 6, 3}};</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  clustersMode0[10] = {{4, 9, 12, 6, 9,</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                        8, 17, 25, 18, 2,</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                        13, 22, 60, 28, 14,</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                        9, 16, 27, 19, 7,</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                        2, 7, 11, 6, 3}};</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  std::array&lt;std::array&lt;float, 25&gt;, 11&gt; clustersMode1;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  clustersMode1[0] = {{4, 9, 12, 6, 1,</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                       8, 17, 25, 18, 5,</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                       13, 22, 50, 28, 14,</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                       9, 16, 27, 19, 7,</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                       2, 7, 11, 6, 3}};</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  clustersMode1[1] = {{4, 9, 12, 6, 0.5,</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                       8, 17, 25, 18, 2.5,</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                       13, 22, 51, 28, 14,</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                       9, 16, 27, 19, 3.5,</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                       2, 7, 11, 6, 3}};</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  clustersMode1[2] = {{4, 9, 12, 6, 1,</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                       8, 17, 25, 18, 5,</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                       6.5, 22, 52, 28, 15,</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                       9, 16, 27, 19, 7,</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                       1, 7, 11, 6, 3}};</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  clustersMode1[3] = {{4, 9, 12, 6, 0.5,</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                       8, 17, 25, 18, 2.5,</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                       13, 22, 53, 28, 7,</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                       9, 16, 27, 19, 3.5,</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                       2, 7, 11, 6, 1.5}};</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  clustersMode1[4] = {{0.5, 9, 12, 6, 1,</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                       2.5, 17, 25, 18, 5,</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                       7, 22, 54, 28, 15,</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                       3.5, 16, 27, 19, 7,</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                       1.5, 7, 11, 6, 3}};</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  clustersMode1[5] = {{4, 9, 12, 6, 0,</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                       8, 17, 25, 18, 8.5,</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                       13, 22, 55, 28, 11,</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                       9, 16, 27, 19, 8,</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                       2, 7, 11, 6, 0}};</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  clustersMode1[6] = {{0, 9, 12, 6, 1,</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                       0, 8.5, 25, 18, 5,</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                       0, 11, 56, 28, 15,</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                       0, 8, 27, 19, 7,</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                       0, 7, 11, 6, 3}};</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  clustersMode1[7] = {{4, 9, 12, 6, 0,</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                       8, 17, 25, 9, 0,</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                       13, 22, 57, 14, 0,</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                       9, 16, 27, 9.5, 0,</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                       2, 7, 11, 6, 0}};</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  clustersMode1[8] = {{0, 6, 12, 6, 1,</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                       0, 9, 25, 18, 5,</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                       0, 14, 58, 28, 15,</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                       0, 9.5, 27, 19, 7,</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                       0, 6, 11, 6, 3}};</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  clustersMode1[9] = {{4, 9, 12, 6, 1,</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                       8, 17, 25, 18, 5,</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                       13, 22, 59, 28, 15,</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                       4.5, 16, 27, 19, 7,</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                       1, 3.5, 11, 6, 3}};</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  clustersMode1[10] = {{4, 9, 12, 3, 0,</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                        8, 17, 25, 18, 1,</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                        13, 22, 60, 28, 14,</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                        9, 16, 27, 19, 7,</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                        2, 7, 11, 6, 3}};</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cl = 0; cl &lt; clusters.size(); ++cl) {</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dt = 0; dt &lt; 10; ++dt) {</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dp = 0; dp &lt; 10; ++dp) {</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        <span class="comment">// Digit(int cru, float charge, int row, int pad, int time)</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        digits-&gt;emplace_back(0, clusters[cl][dt * 10 + dp], cl, dp, dt + 20 * cl);</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      }</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    }</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  }</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  std::sort(digits-&gt;begin(), digits-&gt;end(), <a class="code" href="../../d9/d6b/structo2_1_1tpc_1_1sortTime.html">sortTime</a>());</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;testing without splitting...&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  std::vector&lt;ClusterHardware&gt; clustersToCompare;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  clustersToCompare.emplace_back();</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  clustersToCompare.back().setCluster(2, 7, <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a286e9bdb2374fc9f58f6c9565968ec64">p_pre_fp</a>(clustersMode0[0]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6058326f702b3486039e2e0e0e3a2b0d">t_pre_fp</a>(clustersMode0[0]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a045aac36e3fc1283e21d208febbcfd7d">sigma_p_pre_fp</a>(clustersMode0[0]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a091e548b5a234094aece83f89cc6d668">sigma_t_pre_fp</a>(clustersMode0[0]), (clustersMode0[0][12] * 2), (std::accumulate(clustersMode0[0].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clustersMode0[0].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0.0) * 16), 0, 0);</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  clustersToCompare.emplace_back();</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  clustersToCompare.back().setCluster(2, 7 + 20, <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a286e9bdb2374fc9f58f6c9565968ec64">p_pre_fp</a>(clustersMode0[1]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6058326f702b3486039e2e0e0e3a2b0d">t_pre_fp</a>(clustersMode0[1]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a045aac36e3fc1283e21d208febbcfd7d">sigma_p_pre_fp</a>(clustersMode0[1]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a091e548b5a234094aece83f89cc6d668">sigma_t_pre_fp</a>(clustersMode0[1]), (clustersMode0[1][12] * 2), (std::accumulate(clustersMode0[1].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clustersMode0[1].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0.0) * 16), 0, 0);</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  clustersToCompare.emplace_back();</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  clustersToCompare.back().setCluster(2 + 5, 7 + 20, <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a286e9bdb2374fc9f58f6c9565968ec64">p_pre_fp</a>(clustersMode0[2]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6058326f702b3486039e2e0e0e3a2b0d">t_pre_fp</a>(clustersMode0[2]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a045aac36e3fc1283e21d208febbcfd7d">sigma_p_pre_fp</a>(clustersMode0[2]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a091e548b5a234094aece83f89cc6d668">sigma_t_pre_fp</a>(clustersMode0[2]), (clustersMode0[2][12] * 2), (std::accumulate(clustersMode0[2].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clustersMode0[2].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0.0) * 16), 0, 0);</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  clustersToCompare.emplace_back();</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  clustersToCompare.back().setCluster(2, 7 + 40, <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a286e9bdb2374fc9f58f6c9565968ec64">p_pre_fp</a>(clustersMode0[3]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6058326f702b3486039e2e0e0e3a2b0d">t_pre_fp</a>(clustersMode0[3]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a045aac36e3fc1283e21d208febbcfd7d">sigma_p_pre_fp</a>(clustersMode0[3]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a091e548b5a234094aece83f89cc6d668">sigma_t_pre_fp</a>(clustersMode0[3]), (clustersMode0[3][12] * 2), (std::accumulate(clustersMode0[3].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clustersMode0[3].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0.0) * 16), 0, 0);</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  clustersToCompare.emplace_back();</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  clustersToCompare.back().setCluster(2 + 4, 7 + 40, <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a286e9bdb2374fc9f58f6c9565968ec64">p_pre_fp</a>(clustersMode0[4]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6058326f702b3486039e2e0e0e3a2b0d">t_pre_fp</a>(clustersMode0[4]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a045aac36e3fc1283e21d208febbcfd7d">sigma_p_pre_fp</a>(clustersMode0[4]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a091e548b5a234094aece83f89cc6d668">sigma_t_pre_fp</a>(clustersMode0[4]), (clustersMode0[4][12] * 2), (std::accumulate(clustersMode0[4].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clustersMode0[4].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0.0) * 16), 0, 0);</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  clustersToCompare.emplace_back();</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  clustersToCompare.back().setCluster(2 + 1, 7 + 60, <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a286e9bdb2374fc9f58f6c9565968ec64">p_pre_fp</a>(clustersMode0[5]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6058326f702b3486039e2e0e0e3a2b0d">t_pre_fp</a>(clustersMode0[5]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a045aac36e3fc1283e21d208febbcfd7d">sigma_p_pre_fp</a>(clustersMode0[5]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a091e548b5a234094aece83f89cc6d668">sigma_t_pre_fp</a>(clustersMode0[5]), (clustersMode0[5][12] * 2), (std::accumulate(clustersMode0[5].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clustersMode0[5].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0.0) * 16), 0, 0);</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  clustersToCompare.emplace_back();</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  clustersToCompare.back().setCluster(2 + 4, 7 + 60, <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a286e9bdb2374fc9f58f6c9565968ec64">p_pre_fp</a>(clustersMode0[6]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6058326f702b3486039e2e0e0e3a2b0d">t_pre_fp</a>(clustersMode0[6]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a045aac36e3fc1283e21d208febbcfd7d">sigma_p_pre_fp</a>(clustersMode0[6]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a091e548b5a234094aece83f89cc6d668">sigma_t_pre_fp</a>(clustersMode0[6]), (clustersMode0[6][12] * 2), (std::accumulate(clustersMode0[6].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clustersMode0[6].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0.0) * 16), 0, 0);</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  clustersToCompare.emplace_back();</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  clustersToCompare.back().setCluster(2 + 1, 7 + 80, <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a286e9bdb2374fc9f58f6c9565968ec64">p_pre_fp</a>(clustersMode0[7]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6058326f702b3486039e2e0e0e3a2b0d">t_pre_fp</a>(clustersMode0[7]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a045aac36e3fc1283e21d208febbcfd7d">sigma_p_pre_fp</a>(clustersMode0[7]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a091e548b5a234094aece83f89cc6d668">sigma_t_pre_fp</a>(clustersMode0[7]), (clustersMode0[7][12] * 2), (std::accumulate(clustersMode0[7].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clustersMode0[7].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0.0) * 16), 0, 0);</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  clustersToCompare.emplace_back();</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  clustersToCompare.back().setCluster(2 + 3, 7 + 80, <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a286e9bdb2374fc9f58f6c9565968ec64">p_pre_fp</a>(clustersMode0[8]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6058326f702b3486039e2e0e0e3a2b0d">t_pre_fp</a>(clustersMode0[8]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a045aac36e3fc1283e21d208febbcfd7d">sigma_p_pre_fp</a>(clustersMode0[8]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a091e548b5a234094aece83f89cc6d668">sigma_t_pre_fp</a>(clustersMode0[8]), (clustersMode0[8][12] * 2), (std::accumulate(clustersMode0[8].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clustersMode0[8].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0.0) * 16), 0, 0);</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  clustersToCompare.emplace_back();</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  clustersToCompare.back().setCluster(2 + 4, 7 + 97, <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a286e9bdb2374fc9f58f6c9565968ec64">p_pre_fp</a>(clustersMode0[9]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6058326f702b3486039e2e0e0e3a2b0d">t_pre_fp</a>(clustersMode0[9]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a045aac36e3fc1283e21d208febbcfd7d">sigma_p_pre_fp</a>(clustersMode0[9]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a091e548b5a234094aece83f89cc6d668">sigma_t_pre_fp</a>(clustersMode0[9]), (clustersMode0[9][12] * 2), (std::accumulate(clustersMode0[9].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clustersMode0[9].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0.0) * 16), 0, 0);</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  clustersToCompare.emplace_back();</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  clustersToCompare.back().setCluster(2, 7 + 100, <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a286e9bdb2374fc9f58f6c9565968ec64">p_pre_fp</a>(clustersMode0[10]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6058326f702b3486039e2e0e0e3a2b0d">t_pre_fp</a>(clustersMode0[10]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a045aac36e3fc1283e21d208febbcfd7d">sigma_p_pre_fp</a>(clustersMode0[10]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a091e548b5a234094aece83f89cc6d668">sigma_t_pre_fp</a>(clustersMode0[10]), (clustersMode0[10][12] * 2), (std::accumulate(clustersMode0[10].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clustersMode0[10].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0.0) * 16), 0, 0);</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  clusterer.setSplittingMode(0);</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  clusterer.process(*digits.get(), <span class="keyword">nullptr</span>);</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  BOOST_CHECK_EQUAL(clusterArray-&gt;size(), 1);</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <span class="keyword">auto</span> clusterContainer = (*clusterArray)[0].getContainer();</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  BOOST_CHECK_EQUAL(clusterContainer-&gt;numberOfClusters, 11);</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> clIndex = 0; clIndex &lt; clusterContainer-&gt;numberOfClusters; ++clIndex) {</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Testing cluster &quot;</span> &lt;&lt; clIndex &lt;&lt; std::endl;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="comment">// Checking row and flags are not relevant for this test</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="comment">// Check QTot</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[clIndex].getQTot(), clustersToCompare[clIndex].getQTot());</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="comment">// Check QMax</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[clIndex].getQMax(), clustersToCompare[clIndex].getQMax());</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="comment">// Check pad</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    BOOST_CHECK_CLOSE(</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      clusterContainer-&gt;clusters[clIndex].getPad(),</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      clustersToCompare[clIndex].getPad(),</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;      0.0001);</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <span class="comment">// Check time</span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    BOOST_CHECK_CLOSE(</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      clusterContainer-&gt;clusters[clIndex].getTimeLocal() + clusterContainer-&gt;timeBinOffset,</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      clustersToCompare[clIndex].getTimeLocal(),</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      0.0001);</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="comment">// Check pad sigma</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    BOOST_CHECK_CLOSE(</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;      clusterContainer-&gt;clusters[clIndex].getSigmaPad2(),</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;      clustersToCompare[clIndex].getSigmaPad2(),</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;      0.0001);</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="comment">// Check time sigma</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    BOOST_CHECK_CLOSE(</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;      clusterContainer-&gt;clusters[clIndex].getSigmaTime2(),</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;      clustersToCompare[clIndex].getSigmaTime2(),</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;      0.0001);</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  }</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;testing splitting mode 1...&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  clustersToCompare.clear();</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  clustersToCompare.emplace_back();</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  clustersToCompare.back().setCluster(2, 7, <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a286e9bdb2374fc9f58f6c9565968ec64">p_pre_fp</a>(clustersMode1[0]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6058326f702b3486039e2e0e0e3a2b0d">t_pre_fp</a>(clustersMode1[0]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a045aac36e3fc1283e21d208febbcfd7d">sigma_p_pre_fp</a>(clustersMode1[0]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a091e548b5a234094aece83f89cc6d668">sigma_t_pre_fp</a>(clustersMode1[0]), (clustersMode1[0][12] * 2), (std::accumulate(clustersMode1[0].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clustersMode1[0].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0.0) * 16), 0, 0);</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  clustersToCompare.emplace_back();</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  clustersToCompare.back().setCluster(2, 7 + 20, <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a286e9bdb2374fc9f58f6c9565968ec64">p_pre_fp</a>(clustersMode1[1]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6058326f702b3486039e2e0e0e3a2b0d">t_pre_fp</a>(clustersMode1[1]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a045aac36e3fc1283e21d208febbcfd7d">sigma_p_pre_fp</a>(clustersMode1[1]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a091e548b5a234094aece83f89cc6d668">sigma_t_pre_fp</a>(clustersMode1[1]), (clustersMode1[1][12] * 2), (std::accumulate(clustersMode1[1].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clustersMode1[1].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0.0) * 16), 0, 0);</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  clustersToCompare.emplace_back();</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  clustersToCompare.back().setCluster(2 + 5, 7 + 20, <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a286e9bdb2374fc9f58f6c9565968ec64">p_pre_fp</a>(clustersMode1[2]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6058326f702b3486039e2e0e0e3a2b0d">t_pre_fp</a>(clustersMode1[2]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a045aac36e3fc1283e21d208febbcfd7d">sigma_p_pre_fp</a>(clustersMode1[2]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a091e548b5a234094aece83f89cc6d668">sigma_t_pre_fp</a>(clustersMode1[2]), (clustersMode1[2][12] * 2), (std::accumulate(clustersMode1[2].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clustersMode1[2].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0.0) * 16), 0, 0);</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  clustersToCompare.emplace_back();</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  clustersToCompare.back().setCluster(2, 7 + 40, <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a286e9bdb2374fc9f58f6c9565968ec64">p_pre_fp</a>(clustersMode1[3]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6058326f702b3486039e2e0e0e3a2b0d">t_pre_fp</a>(clustersMode1[3]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a045aac36e3fc1283e21d208febbcfd7d">sigma_p_pre_fp</a>(clustersMode1[3]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a091e548b5a234094aece83f89cc6d668">sigma_t_pre_fp</a>(clustersMode1[3]), (clustersMode1[3][12] * 2), (std::accumulate(clustersMode1[3].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clustersMode1[3].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0.0) * 16), 0, 0);</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  clustersToCompare.emplace_back();</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  clustersToCompare.back().setCluster(2 + 4, 7 + 40, <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a286e9bdb2374fc9f58f6c9565968ec64">p_pre_fp</a>(clustersMode1[4]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6058326f702b3486039e2e0e0e3a2b0d">t_pre_fp</a>(clustersMode1[4]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a045aac36e3fc1283e21d208febbcfd7d">sigma_p_pre_fp</a>(clustersMode1[4]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a091e548b5a234094aece83f89cc6d668">sigma_t_pre_fp</a>(clustersMode1[4]), (clustersMode1[4][12] * 2), (std::accumulate(clustersMode1[4].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clustersMode1[4].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0.0) * 16), 0, 0);</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  clustersToCompare.emplace_back();</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  clustersToCompare.back().setCluster(2 + 1, 7 + 60, <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a286e9bdb2374fc9f58f6c9565968ec64">p_pre_fp</a>(clustersMode1[5]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6058326f702b3486039e2e0e0e3a2b0d">t_pre_fp</a>(clustersMode1[5]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a045aac36e3fc1283e21d208febbcfd7d">sigma_p_pre_fp</a>(clustersMode1[5]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a091e548b5a234094aece83f89cc6d668">sigma_t_pre_fp</a>(clustersMode1[5]), (clustersMode1[5][12] * 2), (std::accumulate(clustersMode1[5].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clustersMode1[5].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0.0) * 16), 0, 0);</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  clustersToCompare.emplace_back();</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  clustersToCompare.back().setCluster(2 + 4, 7 + 60, <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a286e9bdb2374fc9f58f6c9565968ec64">p_pre_fp</a>(clustersMode1[6]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6058326f702b3486039e2e0e0e3a2b0d">t_pre_fp</a>(clustersMode1[6]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a045aac36e3fc1283e21d208febbcfd7d">sigma_p_pre_fp</a>(clustersMode1[6]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a091e548b5a234094aece83f89cc6d668">sigma_t_pre_fp</a>(clustersMode1[6]), (clustersMode1[6][12] * 2), (std::accumulate(clustersMode1[6].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clustersMode1[6].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0.0) * 16), 0, 0);</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  clustersToCompare.emplace_back();</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  clustersToCompare.back().setCluster(2 + 1, 7 + 80, <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a286e9bdb2374fc9f58f6c9565968ec64">p_pre_fp</a>(clustersMode1[7]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6058326f702b3486039e2e0e0e3a2b0d">t_pre_fp</a>(clustersMode1[7]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a045aac36e3fc1283e21d208febbcfd7d">sigma_p_pre_fp</a>(clustersMode1[7]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a091e548b5a234094aece83f89cc6d668">sigma_t_pre_fp</a>(clustersMode1[7]), (clustersMode1[7][12] * 2), (std::accumulate(clustersMode1[7].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clustersMode1[7].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0.0) * 16), 0, 0);</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  clustersToCompare.emplace_back();</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  clustersToCompare.back().setCluster(2 + 3, 7 + 80, <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a286e9bdb2374fc9f58f6c9565968ec64">p_pre_fp</a>(clustersMode1[8]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6058326f702b3486039e2e0e0e3a2b0d">t_pre_fp</a>(clustersMode1[8]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a045aac36e3fc1283e21d208febbcfd7d">sigma_p_pre_fp</a>(clustersMode1[8]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a091e548b5a234094aece83f89cc6d668">sigma_t_pre_fp</a>(clustersMode1[8]), (clustersMode1[8][12] * 2), (std::accumulate(clustersMode1[8].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clustersMode1[8].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0.0) * 16), 0, 0);</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  clustersToCompare.emplace_back();</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  clustersToCompare.back().setCluster(2 + 4, 7 + 97, <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a286e9bdb2374fc9f58f6c9565968ec64">p_pre_fp</a>(clustersMode1[9]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6058326f702b3486039e2e0e0e3a2b0d">t_pre_fp</a>(clustersMode1[9]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a045aac36e3fc1283e21d208febbcfd7d">sigma_p_pre_fp</a>(clustersMode1[9]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a091e548b5a234094aece83f89cc6d668">sigma_t_pre_fp</a>(clustersMode1[9]), (clustersMode1[9][12] * 2), (std::accumulate(clustersMode1[9].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clustersMode1[9].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0.0) * 16), 0, 0);</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  clustersToCompare.emplace_back();</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;  clustersToCompare.back().setCluster(2, 7 + 100, <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a286e9bdb2374fc9f58f6c9565968ec64">p_pre_fp</a>(clustersMode1[10]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6058326f702b3486039e2e0e0e3a2b0d">t_pre_fp</a>(clustersMode1[10]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a045aac36e3fc1283e21d208febbcfd7d">sigma_p_pre_fp</a>(clustersMode1[10]), <a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a091e548b5a234094aece83f89cc6d668">sigma_t_pre_fp</a>(clustersMode1[10]), (clustersMode1[10][12] * 2), (std::accumulate(clustersMode1[10].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">begin</a>(), clustersMode1[10].<a class="code" href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">end</a>(), 0.0) * 16), 0, 0);</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  clusterer.setSplittingMode(1);</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  clusterer.process(*digits.get(), <span class="keyword">nullptr</span>);</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  BOOST_CHECK_EQUAL(clusterArray-&gt;size(), 1);</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  clusterContainer = (*clusterArray)[0].getContainer();</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  BOOST_CHECK_EQUAL(clusterContainer-&gt;numberOfClusters, 11);</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> clIndex = 0; clIndex &lt; clusterContainer-&gt;numberOfClusters; ++clIndex) {</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Testing cluster &quot;</span> &lt;&lt; clIndex &lt;&lt; std::endl;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="comment">// Checking row and flags are not relevant for this test</span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <span class="comment">// Check QTot</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[clIndex].getQTot(), clustersToCompare[clIndex].getQTot());</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <span class="comment">// Check QMax</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    BOOST_CHECK_EQUAL(clusterContainer-&gt;clusters[clIndex].getQMax(), clustersToCompare[clIndex].getQMax());</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    <span class="comment">// Check pad</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    BOOST_CHECK_CLOSE(</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;      clusterContainer-&gt;clusters[clIndex].getPad(),</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      clustersToCompare[clIndex].getPad(),</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      0.0001);</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="comment">// Check time</span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    BOOST_CHECK_CLOSE(</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;      clusterContainer-&gt;clusters[clIndex].getTimeLocal() + clusterContainer-&gt;timeBinOffset,</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      clustersToCompare[clIndex].getTimeLocal(),</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      0.0001);</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="comment">// Check pad sigma</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    BOOST_CHECK_CLOSE(</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;      clusterContainer-&gt;clusters[clIndex].getSigmaPad2(),</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      clustersToCompare[clIndex].getSigmaPad2(),</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;      0.0001);</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <span class="comment">// Check time sigma</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    BOOST_CHECK_CLOSE(</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      clusterContainer-&gt;clusters[clIndex].getSigmaTime2(),</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;      clustersToCompare[clIndex].getSigmaTime2(),</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      0.0001);</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  }</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;## Test 6 done.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;##&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;            &lt;&lt; std::endl;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;}</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;} <span class="comment">// namespace tpc</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;} <span class="comment">// namespace o2</span></div><div class="ttc" id="namespaceo2_1_1tpc_html_a27da508ea0cb1d37fd56a0a598317cde"><div class="ttname"><a href="../../d0/d0a/namespaceo2_1_1tpc.html#a27da508ea0cb1d37fd56a0a598317cde">o2::tpc::begin</a></div><div class="ttdeci">Enum&lt; T &gt;::Iterator begin(Enum&lt; T &gt;)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d73/Defs_8h_source.html#l00126">Defs.h:126</a></div></div>
<div class="ttc" id="namespaceo2_1_1tpc_html_a045aac36e3fc1283e21d208febbcfd7d"><div class="ttname"><a href="../../d0/d0a/namespaceo2_1_1tpc.html#a045aac36e3fc1283e21d208febbcfd7d">o2::tpc::sigma_p_pre_fp</a></div><div class="ttdeci">float sigma_p_pre_fp(std::array&lt; float, 25 &gt; &amp;data)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d47/testTPCHwClusterer_8cxx_source.html#l00098">testTPCHwClusterer.cxx:98</a></div></div>
<div class="ttc" id="namespaceo2_html"><div class="ttname"><a href="../../d4/d7c/namespaceo2.html">o2</a></div><div class="ttdoc">information complementary to a CCDB object (path, metadata, startTimeValidity, endTimeValidity etc) ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d24/BitstreamReader_8h_source.html#l00022">BitstreamReader.h:22</a></div></div>
<div class="ttc" id="classo2_1_1tpc_1_1HwClusterer_html"><div class="ttname"><a href="../../d2/d09/classo2_1_1tpc_1_1HwClusterer.html">o2::tpc::HwClusterer</a></div><div class="ttdoc">Class for TPC HW cluster finding. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df6/HwClusterer_8h_source.html#l00040">HwClusterer.h:40</a></div></div>
<div class="ttc" id="namespaceo2_1_1tpc_html_ad87e960b884330c83a7e8067aa57d05e"><div class="ttname"><a href="../../d0/d0a/namespaceo2_1_1tpc.html#ad87e960b884330c83a7e8067aa57d05e">o2::tpc::sigma_p_pre</a></div><div class="ttdeci">float sigma_p_pre(std::array&lt; int, 25 &gt; &amp;data)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d47/testTPCHwClusterer_8cxx_source.html#l00054">testTPCHwClusterer.cxx:54</a></div></div>
<div class="ttc" id="classo2_1_1tpc_1_1Mapper_html"><div class="ttname"><a href="../../de/db6/classo2_1_1tpc_1_1Mapper.html">o2::tpc::Mapper</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d1d/TPC_2base_2include_2TPCBase_2Mapper_8h_source.html#l00038">Mapper.h:38</a></div></div>
<div class="ttc" id="namespaceo2_1_1tpc_html_a77da24d02dec1a41ca4cf20a25c39ded"><div class="ttname"><a href="../../d0/d0a/namespaceo2_1_1tpc.html#a77da24d02dec1a41ca4cf20a25c39ded">o2::tpc::t_pre</a></div><div class="ttdeci">float t_pre(std::array&lt; int, 25 &gt; &amp;data)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d47/testTPCHwClusterer_8cxx_source.html#l00065">testTPCHwClusterer.cxx:65</a></div></div>
<div class="ttc" id="namespaceo2_1_1tpc_html_a7fa614fe23094b9dfe1224b76e2ab66c"><div class="ttname"><a href="../../d0/d0a/namespaceo2_1_1tpc.html#a7fa614fe23094b9dfe1224b76e2ab66c">o2::tpc::p_pre</a></div><div class="ttdeci">float p_pre(std::array&lt; int, 25 &gt; &amp;data)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d47/testTPCHwClusterer_8cxx_source.html#l00043">testTPCHwClusterer.cxx:43</a></div></div>
<div class="ttc" id="DataFormats_2Detectors_2TPC_2include_2DataFormatsTPC_2Digit_8h_html"><div class="ttname"><a href="../../d3/d7d/DataFormats_2Detectors_2TPC_2include_2DataFormatsTPC_2Digit_8h.html">Digit.h</a></div></div>
<div class="ttc" id="namespaceo2_1_1tpc_html_a091e548b5a234094aece83f89cc6d668"><div class="ttname"><a href="../../d0/d0a/namespaceo2_1_1tpc.html#a091e548b5a234094aece83f89cc6d668">o2::tpc::sigma_t_pre_fp</a></div><div class="ttdeci">float sigma_t_pre_fp(std::array&lt; float, 25 &gt; &amp;data)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d47/testTPCHwClusterer_8cxx_source.html#l00120">testTPCHwClusterer.cxx:120</a></div></div>
<div class="ttc" id="namespaceo2_1_1tpc_html_a286e9bdb2374fc9f58f6c9565968ec64"><div class="ttname"><a href="../../d0/d0a/namespaceo2_1_1tpc.html#a286e9bdb2374fc9f58f6c9565968ec64">o2::tpc::p_pre_fp</a></div><div class="ttdeci">float p_pre_fp(std::array&lt; float, 25 &gt; &amp;data)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d47/testTPCHwClusterer_8cxx_source.html#l00087">testTPCHwClusterer.cxx:87</a></div></div>
<div class="ttc" id="namespaceo2_1_1tpc_html_abd1b3f7d3ef0de1a2e596809644bbb13"><div class="ttname"><a href="../../d0/d0a/namespaceo2_1_1tpc.html#abd1b3f7d3ef0de1a2e596809644bbb13">o2::tpc::end</a></div><div class="ttdeci">Enum&lt; T &gt;::Iterator end(Enum&lt; T &gt;)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d73/Defs_8h_source.html#l00132">Defs.h:132</a></div></div>
<div class="ttc" id="qconfigoptions_8h_html_a00dc28d5db1371df938f63ad9eb450df"><div class="ttname"><a href="../../d8/de9/qconfigoptions_8h.html#a00dc28d5db1371df938f63ad9eb450df">clusters</a></div><div class="ttdeci">Visualize clusters only Timeframe settings Average distance in cm of events merged into Randomize distance around average distance of merged events Simulate correct bunch interactions instead of placing only the average number of events A value [n] sets TFlen for [n] collisions in Number of bunches per train Number of bunch trains Instantaneous interaction rate Do not simulate border Total number of collisions to be placed in the interior of all time Do not select random but walk over array of events in stride steps h QA settings const char Legend entries for data from comparison histogram files const char Store histograms in output root Do not run but just create PDFs from input root files Set cut for Q Compute the efficiency including impure tracks with fake contamination Maxmimum Create resolution histograms in the native fit Filter for Filter for Particle Store mc labels to file for later matching Minimum Pt of a matched track to be displayed Compare QA QAonly Event generator settings h Reconstruction settings Enable TRD processing Enable TPC Compression Mask to disable certain attachment steps during Enable rejection of TPC clusters for Pt threshold to reject clusters of TPC tracks Sort order of TPC Force early TPC transformation also for continuous Forward TPC digits as clusters(if they pass the ZS threshold)&quot;) AddOption(dropLoopers</div></div>
<div class="ttc" id="classo2_1_1tpc_1_1Mapper_html_a750b7412728e537ff85ea3dd430ffb4e"><div class="ttname"><a href="../../de/db6/classo2_1_1tpc_1_1Mapper.html#a750b7412728e537ff85ea3dd430ffb4e">o2::tpc::Mapper::instance</a></div><div class="ttdeci">static Mapper &amp; instance(const std::string mappingDir=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d1d/TPC_2base_2include_2TPCBase_2Mapper_8h_source.html#l00041">Mapper.h:41</a></div></div>
<div class="ttc" id="namespaceo2_1_1tpc_html_a6058326f702b3486039e2e0e0e3a2b0d"><div class="ttname"><a href="../../d0/d0a/namespaceo2_1_1tpc.html#a6058326f702b3486039e2e0e0e3a2b0d">o2::tpc::t_pre_fp</a></div><div class="ttdeci">float t_pre_fp(std::array&lt; float, 25 &gt; &amp;data)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d47/testTPCHwClusterer_8cxx_source.html#l00109">testTPCHwClusterer.cxx:109</a></div></div>
<div class="ttc" id="namespaceo2_1_1tpc_html_af0a73aac97b31c66edd0faa054e0a943"><div class="ttname"><a href="../../d0/d0a/namespaceo2_1_1tpc.html#af0a73aac97b31c66edd0faa054e0a943">o2::tpc::sigma_t_pre</a></div><div class="ttdeci">float sigma_t_pre(std::array&lt; int, 25 &gt; &amp;data)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d47/testTPCHwClusterer_8cxx_source.html#l00076">testTPCHwClusterer.cxx:76</a></div></div>
<div class="ttc" id="classo2_1_1dataformats_1_1MCTruthContainer_html"><div class="ttname"><a href="../../dc/daa/classo2_1_1dataformats_1_1MCTruthContainer.html">o2::dataformats::MCTruthContainer&lt; o2::MCCompLabel &gt;</a></div></div>
<div class="ttc" id="MCCompLabel_8h_html"><div class="ttname"><a href="../../d7/dcd/MCCompLabel_8h.html">MCCompLabel.h</a></div></div>
<div class="ttc" id="HwClusterer_8h_html"><div class="ttname"><a href="../../de/df6/HwClusterer_8h.html">HwClusterer.h</a></div><div class="ttdoc">Class for TPC HW cluster finding. </div></div>
<div class="ttc" id="TPC_2base_2include_2TPCBase_2Mapper_8h_html"><div class="ttname"><a href="../../d5/d1d/TPC_2base_2include_2TPCBase_2Mapper_8h.html">Mapper.h</a></div></div>
<div class="ttc" id="classo2_1_1dataformats_1_1MCTruthContainer_html_a48909c36a47bc704d7d58672cb0e27fb"><div class="ttname"><a href="../../dc/daa/classo2_1_1dataformats_1_1MCTruthContainer.html#a48909c36a47bc704d7d58672cb0e27fb">o2::dataformats::MCTruthContainer::addElement</a></div><div class="ttdeci">void addElement(uint32_t dataindex, TruthElement const &amp;element)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d14/MCTruthContainer_8h_source.html#l00170">MCTruthContainer.h:170</a></div></div>
<div class="ttc" id="classo2_1_1tpc_1_1HwClusterer_html_a8492607b3362cb43919a32c94bb13292"><div class="ttname"><a href="../../d2/d09/classo2_1_1tpc_1_1HwClusterer.html#a8492607b3362cb43919a32c94bb13292">o2::tpc::HwClusterer::setContinuousReadout</a></div><div class="ttdeci">void setContinuousReadout(bool isContinuous)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df6/HwClusterer_8h_source.html#l00229">HwClusterer.h:229</a></div></div>
<div class="ttc" id="MCTruthContainer_8h_html"><div class="ttname"><a href="../../db/d14/MCTruthContainer_8h.html">MCTruthContainer.h</a></div><div class="ttdoc">Definition of a container to keep Monte Carlo truth external to simulation objects. </div></div>
<div class="ttc" id="structo2_1_1tpc_1_1sortTime_html_a28f7f268014bb38429a50a95468a6154"><div class="ttname"><a href="../../d9/d6b/structo2_1_1tpc_1_1sortTime.html#a28f7f268014bb38429a50a95468a6154">o2::tpc::sortTime::operator()</a></div><div class="ttdeci">bool operator()(const o2::tpc::Digit &amp;d1, const o2::tpc::Digit &amp;d2)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d47/testTPCHwClusterer_8cxx_source.html#l00037">testTPCHwClusterer.cxx:37</a></div></div>
<div class="ttc" id="namespaceo2_1_1tpc_html_a040c4bfa70ddfb0a6910de9e479a05a4"><div class="ttname"><a href="../../d0/d0a/namespaceo2_1_1tpc.html#a040c4bfa70ddfb0a6910de9e479a05a4">o2::tpc::BOOST_AUTO_TEST_CASE</a></div><div class="ttdeci">BOOST_AUTO_TEST_CASE(ClusterHardware_test1)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d04/testClusterHardware_8cxx_source.html#l00027">testClusterHardware.cxx:27</a></div></div>
<div class="ttc" id="DataFormats_2Detectors_2TPC_2include_2DataFormatsTPC_2Helpers_8h_html"><div class="ttname"><a href="../../d9/d7c/DataFormats_2Detectors_2TPC_2include_2DataFormatsTPC_2Helpers_8h.html">Helpers.h</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a8922a680b00df660c57f47c1971d04c5"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a></div><div class="ttdeci">GLboolean * data</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00298">glcorearb.h:298</a></div></div>
<div class="ttc" id="structo2_1_1tpc_1_1sortTime_html"><div class="ttname"><a href="../../d9/d6b/structo2_1_1tpc_1_1sortTime.html">o2::tpc::sortTime</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d47/testTPCHwClusterer_8cxx_source.html#l00036">testTPCHwClusterer.cxx:36</a></div></div>
<div class="ttc" id="classo2_1_1tpc_1_1Digit_html"><div class="ttname"><a href="../../d1/d46/classo2_1_1tpc_1_1Digit.html">o2::tpc::Digit</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d7d/DataFormats_2Detectors_2TPC_2include_2DataFormatsTPC_2Digit_8h_source.html#l00034">Digit.h:34</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_051dca18e802f8e9474f2e30d29c04e0.html">Detectors</a></li><li class="navelem"><a class="el" href="../../dir_a597e8e061b11201a1dff411feb10d0b.html">TPC</a></li><li class="navelem"><a class="el" href="../../dir_a5de047958dd458e809773c6ffaa8478.html">reconstruction</a></li><li class="navelem"><a class="el" href="../../dir_064d7f478c030df51e47c94b08ab25b1.html">test</a></li><li class="navelem"><a class="el" href="../../df/d47/testTPCHwClusterer_8cxx.html">testTPCHwClusterer.cxx</a></li>
    <li class="footer">Generated on Thu Jun 4 2020 09:30:31 for Project by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
