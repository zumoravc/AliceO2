<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Project: CMake Instructions</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../o2_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d5/d61/refdocCMakeInstructions.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">CMake Instructions </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>CMake and CTest tips for AliceO2</h1>
<h2>CMake</h2>
<blockquote class="doxtable">
<p>Note that this document describe the <a class="el" href="../../dc/d3f/CMakeMigration_8md.html">new CMake system</a> : the one based on buckets has been discontinued. </p>
</blockquote>
<h3>Instructions for contributors (aka developers' documentation)</h3>
<p><a class="el" href="../../d2/d88/classA.html">A</a> sub-module <code>CMakeLists.txt</code> defines one or more <em>targets</em>. <a class="el" href="../../d2/d88/classA.html">A</a> target generally corresponds to an actual build artifact like a (static or shared) library or an executable. Targets are the cornerstone of any modern cmake build system.</p>
<h3>Typical CMakeLists.txt</h3>
<p><a class="el" href="../../d2/d88/classA.html">A</a> typical module's <code>CMakeLists.txt</code> contains</p>
<ul>
<li>a call to <a href="../../../cmake/O2AddLibrary.cmake">o2_add_library</a> to define a library (and its dependencies)</li>
<li>call(s) to <a href="../../../cmake/O2AddExecutable.cmake">o2_add_executable</a> to define one or more executables (and their dependencies)</li>
<li>call(s) to <a href="../../../cmake/O2AddTest.cmake">o2_add_test</a> to define one or more tests (and their dependencies)</li>
</ul>
<p>Optionally it might contain a call to <a href="../../../cmake/O2TargetRootDictionary.cmake">o2_target_root_dictionary</a> if the module's library requires a Root dictionary.</p>
<p>All <em>direct</em> dependencies must be <em>explicitely</em> defined with the <code>PUBLIC_LINK_LIBRARIES</code> keyword of the various o2_xxx functions.</p>
<p>Note that despite the parameter name, the <code>PUBLIC_LINK_LIBRARIES</code> should refer to <em>target</em> names, not library names. You <em>have to</em> use the fully qualified <code>O2::targetName</code> and not the short <code>basename</code> you might have used to <em>create</em> the target. Note also that if the referenced target does not exist, CMake will tell you right away at the configure stage (which is a good thing).</p>
<p>Note also CMakeLists.txt should be considered as code and so the same care you put into writing code (e.g. do not repeat yourself, comments, etc...) should be applied to CMakeLists.txt. Also, like the rest of our code, we can take of the formatting using the <a href="https://github.com/cheshirekow/cmake_format">cmake-format</a> tool (that tool is certainly not as robust as <code>clang-format</code> but it can get most of the job done easily).</p>
<h3>Examples</h3>
<p>The example outputs below are from a Mac, so the shared library extension is <code>dylib</code>. On Linux it would be <code>so</code>.</p>
<h4><a href="../../../Examples/Ex1">Ex1</a> Adding a basic library</h4>
<p>Using the following source dir : </p><pre class="fragment">Ex1
├── CMakeLists.txt
├── include
│   └── Ex1
│       └── A.h
└── src
    ├── A.cxx
    ├── B.cxx
    └── B.h
</pre><p>With that <code>CMakeLists.txt</code> : </p><pre class="fragment">o2_add_library(Ex1 SOURCES src/A.cxx src/B.cxx PUBLIC_LINK_LIBRARIES FairMQ::FairMQ)
</pre><p>will define a library with 2 source files, that depends on the FairMQ::FairMQ target.</p>
<p>When doing a <code>cmake --build .</code> you'll find the library in the <code>stage/lib</code> dir. For instance, on a Mac : </p><pre class="fragment">&gt; ls stage/lib/*Ex1*
stage/lib/libO2Ex1.dylib
</pre><p>The built library dependencies can be inspected with <code>otool -L</code> (macos) or <code>ldd</code> (linux) </p><pre class="fragment">&gt; otool -L stage/lib/libO2Ex1.dylib
stage/lib/libO2Ex1.dylib:
        @rpath/libO2Ex1.dylib (compatibility version 0.0.0, current version 0.0.0)
        @rpath/libFairMQ.1.4.dylib (compatibility version 1.4.0, current version 1.4.2)
        /Users/laurent/alice/cmake/sw/osx_x86-64/boost/v1.68.0-1/lib/libboost_container.dylib (compatibility version 0.0.0, current version 0.0.0)
        /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1252.250.1)
        /Users/laurent/alice/cmake/sw/osx_x86-64/boost/v1.68.0-1/lib/libboost_program_options.dylib (compatibility version 0.0.0, current version 0.0.0)
        /Users/laurent/alice/cmake/sw/osx_x86-64/boost/v1.68.0-1/lib/libboost_filesystem.dylib (compatibility version 0.0.0, current version 0.0.0)
        /Users/laurent/alice/cmake/sw/osx_x86-64/boost/v1.68.0-1/lib/libboost_system.dylib (compatibility version 0.0.0, current version 0.0.0)
        /Users/laurent/alice/cmake/sw/osx_x86-64/boost/v1.68.0-1/lib/libboost_regex.dylib (compatibility version 0.0.0, current version 0.0.0)
        @rpath/libFairLogger.1.2.dylib (compatibility version 1.2.0, current version 1.2.0)
        /usr/lib/libc++.1.dylib (compatibility version 1.0.0, current version 400.9.4)
</pre><p>Where you can find the direct dependency you've specified on <code>FairMQ</code>. The rest (boost, FairLogger) are transitive dependencies (coming from FairMQ) that CMake automatically added.</p>
<p>And upon install <code>cmake --build . -- install</code> (the lonely <code>--</code> is not a typo) the library will be in the installation path <code>lib</code> dir and its public includes (only <code>A.h</code> in this case, not <code>B.h</code>) in the <code>include/Ex1</code> dir : </p><pre class="fragment">&gt; ls [install_topdir]
├── include
│   ├── Ex1
│       └── A.h
├── lib
│   ├── libO2Ex1.dylib
</pre><h4><a href="../../../Examples/Ex2">Ex2</a> Adding a basic library with a Root dictionary</h4>
<p>Using a slightly modified version of the previous example (the <a href="../../../Examples/Ex2/include/Ex2/A.h">A.h</a> now uses ClassDef for instance), we'll now add a Root dictionary : </p><pre class="fragment">Ex2
├── CMakeLists.txt
├── include
│   └── Ex2
│       └── A.h
└── src
    ├── A.cxx
    ├── B.cxx
    ├── B.h
    └── Ex2LinkDef.h

o2_add_library(Ex2 SOURCES src/A.cxx src/B.cxx PUBLIC_LINK_LIBRARIES FairMQ::FairMQ)
o2_target_root_dictionary(Ex2 HEADERS include/Ex2/A.h src/B.h LINKDEF src/Ex2LinkDef.h)
</pre><p>will define a library, that depends on the <code>FairMQ::FairMQ</code> target, with 3 source files (the provided <code>A.cxx</code> and <code>B.cxx</code> plus a dictionary added by the <code>o2_target_root_dictionary</code>). In addition to create a dictionary source file, the <code>o2_target_root_dictionary</code> function also appends a dependency on <code>ROOT::RIO</code> target to <code>Ex2</code> because it's needed at link time for the dictionary part.</p>
<p>While the <code>HEADERS</code> parameter to <code>o2_target_root_dictionary</code> is mandatory, the <code>LINKDEF</code> one can be omitted if the LinkDef file is named [targetBaseName]LinkDef.h and is located in the [targetBaseName] source directory (so in the above example it could have been omitted).</p>
<p>When doing a <code>cmake --build .</code> you'll now find, in addition to the library in the <code>stage/lib</code> dir, a <code>rootmap</code> file and a <code>pcm</code> file. Those two files must be collocated with the library if you want to be able to load that library easily from the Root prompt. </p><pre class="fragment">&gt; ls stage/lib/*Ex2*
stage/lib/G__O2ExDict_rdict.pcm
stage/lib/libO2Ex2.dylib
stage/lib/libO2Ex2.rootmap
</pre><p>If you look at the dependencies for libO2Ex2, you'll find the same ones as libO2Ex1, plus some <a class="el" href="../../d0/d10/namespaceROOT.html">ROOT</a> ones, due to the dictionary inclusion. </p><pre class="fragment">&gt; otool -L stage/lib/libO2Ex2.dylib
stage/lib/libO2Ex2.dylib:
        @rpath/libO2Ex2.dylib (compatibility version 0.0.0, current version 0.0.0)
        @rpath/libFairMQ.1.4.dylib (compatibility version 1.4.0, current version 1.4.2)
        @rpath/libRIO.6.16.so (compatibility version 6.16.0, current version 6.16.0)
        /Users/laurent/alice/cmake/sw/osx_x86-64/boost/v1.68.0-1/lib/libboost_container.dylib (compatibility version 0.0.0, current version 0.0.0)
        /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1252.250.1)
        /Users/laurent/alice/cmake/sw/osx_x86-64/boost/v1.68.0-1/lib/libboost_program_options.dylib (compatibility version 0.0.0, current version 0.0.0)
        /Users/laurent/alice/cmake/sw/osx_x86-64/boost/v1.68.0-1/lib/libboost_filesystem.dylib (compatibility version 0.0.0, current version 0.0.0)
        /Users/laurent/alice/cmake/sw/osx_x86-64/boost/v1.68.0-1/lib/libboost_system.dylib (compatibility version 0.0.0, current version 0.0.0)
        /Users/laurent/alice/cmake/sw/osx_x86-64/boost/v1.68.0-1/lib/libboost_regex.dylib (compatibility version 0.0.0, current version 0.0.0)
        @rpath/libFairLogger.1.2.dylib (compatibility version 1.2.0, current version 1.2.0)
        @rpath/libThread.6.16.so (compatibility version 6.16.0, current version 6.16.0)
        @rpath/libCore.6.16.so (compatibility version 6.16.0, current version 6.16.0)
        /usr/lib/libc++.1.dylib (compatibility version 1.0.0, current version 400.9.4)
</pre><p>The include installation will be similar to Ex1 : the <code>LinkDef.h</code> file is <em>not</em> installed (unless you put it under include/Ex2 but that would not be wise). </p><pre class="fragment">&gt; ls [install_topdir]
├── include
│   ├── Ex2
│       └── A.h
├── lib
│   ├── G__O2ExDict_rdict.pcm
│   ├── libO2Ex2.dylib
│   ├── libO2Ex2.rootmap
</pre><h4><a href="../../../Examples/Ex3">Ex3</a> Adding an executable</h4>
<p>Adding an executable to previous example : </p><pre class="fragment">Ex3
├── CMakeLists.txt
├── include
│   └── Ex3
│       └── A.h
└── src
    ├── A.cxx
    ├── B.cxx
    ├── B.h
    ├── Ex2LinkDef.h
    └── run.cxx

o2_add_library(Ex3
        SOURCES src/A.cxx src/B.cxx
        PUBLIC_LINK_LIBRARIES FairMQ::FairMQ)

o2_target_root_dictionary(Ex3
        HEADERS include/Ex3/A.h src/B.h)

o2_add_executable(ex3
        SOURCES src/run.cxx
        PUBLIC_LINK_LIBRARIES O2::Ex3 O2::Ex2
        COMPONENT_NAME example)
</pre><p>There are three things to note in the <code>o2_add_executable</code>.</p>
<p>First, we reference the <code>Ex3</code> library, built in the same module, using its fully qualified name <code>O2::Ex3</code>. Using just <code>Ex3</code> would not work, as there is no target named <code>Ex3</code> (Ex3 is just the basename of the target). Likewise, the "external" (to this module) Ex2 library is also referenced by its fully qualified name <code>O2::Ex2</code>. The target dependencies gather the link dependencies (to the relevant libraries used during linking) but also the include dependencies (so that the relevant include directories, e.g. <code>include/Ex2</code> are found when compiling).</p>
<p>Second, we used the optional <code>COMPONENT_NAME</code> argument, that will be used as part of the executable name. The output executable name will be <code>o2-example-ex3</code>, following our <a href="https://rawgit.com/AliceO2Group/CodingGuidelines/master/naming_formatting.html#Executable_Names">naming convention for executable</a>.</p>
<p>Runtime dependencies of the executable can be seen with the same <code>otool -L</code> (mac) or <code>ldd</code> (linux) command : </p><pre class="fragment">&gt; otool -L stage/bin/o2-example-ex3
stage/bin/o2-example-ex3:
        @rpath/libO2Ex3.dylib (compatibility version 0.0.0, current version 0.0.0)
        @rpath/libO2Ex2.dylib (compatibility version 0.0.0, current version 0.0.0)
        @rpath/libFairMQ.1.4.dylib (compatibility version 1.4.0, current version 1.4.2)
        /Users/laurent/alice/cmake/sw/osx_x86-64/boost/v1.68.0-1/lib/libboost_container.dylib (compatibility version 0.0.0, current version 0.0.0)
        /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1252.250.1)
        /Users/laurent/alice/cmake/sw/osx_x86-64/boost/v1.68.0-1/lib/libboost_program_options.dylib (compatibility version 0.0.0, current version 0.0.0)
        /Users/laurent/alice/cmake/sw/osx_x86-64/boost/v1.68.0-1/lib/libboost_filesystem.dylib (compatibility version 0.0.0, current version 0.0.0)
        /Users/laurent/alice/cmake/sw/osx_x86-64/boost/v1.68.0-1/lib/libboost_system.dylib (compatibility version 0.0.0, current version 0.0.0)
        /Users/laurent/alice/cmake/sw/osx_x86-64/boost/v1.68.0-1/lib/libboost_regex.dylib (compatibility version 0.0.0, current version 0.0.0)
        @rpath/libFairLogger.1.2.dylib (compatibility version 1.2.0, current version 1.2.0)
        @rpath/libRIO.6.16.so (compatibility version 6.16.0, current version 6.16.0)
        @rpath/libThread.6.16.so (compatibility version 6.16.0, current version 6.16.0)
        @rpath/libCore.6.16.so (compatibility version 6.16.0, current version 6.16.0)
        /usr/lib/libc++.1.dylib (compatibility version 1.0.0, current version 400.9.4)
</pre><p>where you can see the dependencies on our two Ex2 and Ex3 libraries, as well as their dependencies (FairMQ, <a class="el" href="../../d0/d10/namespaceROOT.html">ROOT</a>) and their dependencies (FairLogger).</p>
<p>Third, the created executable can be launched "as is" from the build tree, without having to setup the <code>PATH</code> and/or <code>LD_LIBRARY_PATH</code> environment variables. </p><pre class="fragment">&gt; stage/bin/o2-example-ex3
Hello from ex2::A ctor
Hello from ex3::A ctor
</pre><p>That is because the <a href="https://gitlab.kitware.com/cmake/community/wikis/doc/cmake/RPATH-handling">RPATH</a> was correctly set by CMake for the build tree. It should be set correctly also when installing.</p>
<h4><a href="../../../Examples/Ex4">Ex4</a> Adding a couple of tests</h4>
<p>Let's add two basic test2 to our previous example. </p><pre class="fragment">o2_add_test(test1
            SOURCES test/test1.cxx
            PUBLIC_LINK_LIBRARIES O2::Ex4
            COMPONENT_NAME Ex4
            LABELS fast dummy obvious
            INSTALL)

o2_add_test(test2
            SOURCES test/test2.cxx
            PUBLIC_LINK_LIBRARIES O2::Ex4 O2::Ex3 O2::Ex2
            COMPONENT_NAME Ex4
            LABELS fast dummy)
</pre><p>Those two test executables will be under <code>stage/bin</code> with a name starting with <code>o2-test-ex4</code> (i.e. the COMPONENT_NAME is used but transformed into lowercase) : </p><pre class="fragment">stage/
├── bin
│   ├── o2-example-ex3
│   ├── o2-example-ex4
│   ├── o2-test-ex4-test1
│   └── o2-test-ex4-test2
└── lib
    ├── libO2Ex1.dylib
    ├── libO2Ex2.dylib
    ├── libO2Ex3.dylib
    └── libO2Ex4.dylib
</pre><p>By default tests are <em>not</em> installed, unless the <code>INSTALL</code> option is given to <code>o2_add_test</code>. So in the installation zone only the first test will be available, under the <code>tests</code> subdirectory. So the full installation of our 4 examples would give : </p><pre class="fragment">../install-Debug/
├── bin
│   ├── o2-example-ex3
│   └── o2-example-ex4
├── include
│   ├── Ex1
│   │   └── A.h
│   ├── Ex2
│   │   └── A.h
│   ├── Ex3
│   │   └── A.h
│   └── Ex4
│       └── A.h
├── lib
│   ├── G__O2Ex2Dict_rdict.pcm
│   ├── G__O2Ex3Dict_rdict.pcm
│   ├── G__O2Ex4Dict_rdict.pcm
│   ├── libO2Ex1.dylib
│   ├── libO2Ex2.dylib
│   ├── libO2Ex2.rootmap
│   ├── libO2Ex3.dylib
│   ├── libO2Ex3.rootmap
│   ├── libO2Ex4.dylib
│   └── libO2Ex4.rootmap
├── share
│   └── config
│       └── rootmanager.dat
└── tests
    └── o2-test-ex4-test1
</pre><p>As normally our tests are based on the <a href="https://www.boost.org/doc/libs/1_70_0/libs/test/doc/html/index.html">Boost.Test</a> the dependency to the <code>Boost::unit_test_framework</code> is added automatically by the <code>o2_add_test</code> function (unless the <code>NO_BOOST</code> option is specified).</p>
<p>Finally, note the usage of the <code>LABELS</code> (plural) option, which can be used to categorize the tests and/or to select which tests to be ran. </p><pre class="fragment">&gt; ctest
Test project /Users/laurent/alice/cmake/standalone/O2/build-Debug
    Start 1: O2test-ex4-test1
1/3 Test #1: O2test-ex4-test1 ......................   Passed    0.07 sec
    Start 2: O2test-ex4-test2
2/3 Test #2: O2test-ex4-test2 ......................   Passed    0.07 sec
    Start 3: ensure-executable-naming-convention
3/3 Test #3: ensure-executable-naming-convention ...   Passed    0.03 sec

100% tests passed, 0 tests failed out of 3

Label Time Summary:
dummy      =   0.14 sec*proc (2 tests)
fast       =   0.14 sec*proc (2 tests)
obvious    =   0.07 sec*proc (1 test)

&gt; ctest -L obvious # run only tests with a label of "obvious"
Test project /Users/laurent/alice/cmake/standalone/O2/build-Debug
    Start 1: O2test-ex4-test1
1/3 Test #1: O2test-ex4-test1 ......................   Passed    0.07 sec

100% tests passed, 0 tests failed out of 1

Label Time Summary:
dummy      =   0.07 sec*proc (1 test)
fast       =   0.07 sec*proc (1 test)
obvious    =   0.07 sec*proc (1 test)
</pre><p>Note that tests can also be selected by name using regexp (<code>-R</code>). Tests can also be <em>excluded</em> based on label (<code>-LE</code>) or name (<code>-RE</code>). </p><pre class="fragment">Test project /Users/laurent/alice/cmake/standalone/O2/build-Debug
    Start 2: O2test-ex4-test2
1/2 Test #2: O2test-ex4-test2 ......................   Passed    0.07 sec
    Start 3: ensure-executable-naming-convention
2/2 Test #3: ensure-executable-naming-convention ...   Passed    0.03 sec

100% tests passed, 0 tests failed out of 2

Label Time Summary:
dummy    =   0.07 sec*proc (1 test)
fast     =   0.07 sec*proc (1 test)
</pre><h4><a href="../../../Examples/Ex5">Ex5</a> Adding a man page</h4>
<p>If a module provides one or more executables, it might be of interest for the users of those executables to have access to a man page for them. Ex5 illustates that use case. </p><pre class="fragment">.
├── CMakeLists.txt
├── README.md
├── doc
│   └── ex5.7.in
└── src
    └── run.cxx
</pre><p>The <a class="el" href="../../d5/d56/ManPages_8md.html">man page</a> is created using : </p><pre class="fragment">o2_target_man_page([targetName] NAME ex5 SECTION 7)
</pre><p>where <code>NAME xx</code> refers to a file <code>doc/xx.[SECTION].in</code>, and the actual <code>targetName</code> can be found from the base target name (ex5 in that case) using the <a href="../../../cmake/O2NameTarget.cmake">o2_name_target</a> function.</p>
<h2>CTest</h2>
<p>In the build directory of O2, if you launch the <code>ctest</code> command, all the O2 tests will be ran, which is not always what you want/need, in particular during development.</p>
<p>As shown above in <a href="../../#ex4-adding-a-couple-of-tests">Ex4</a>, there are fortunately various ways to narrow the set of tests which are ran by <code>ctest</code>.</p>
<p>Note that in all the commands below, the <code>-N</code> option is used to show the list of test that would be selected, without running them. Remove that option to actually run the tests.</p>
<h3>Selecting/excluding by test name (-R/-E)</h3>
<p>Probably the simplest is to select the test name, using the <code>-R</code> (regexp) option :</p>
<div class="fragment"><div class="line">&gt; ctest -N -R test/Contour</div><div class="line">  Test #269: Detectors/MUON/MCH/Contour/test/Contour.cxx</div><div class="line">  Test #270: Detectors/MUON/MCH/Contour/test/ContourCreator.cxx</div><div class="line"></div><div class="line">&gt;  ctest -N -R &quot;test/Contour\.(.)&quot;</div><div class="line">  Test #269: Detectors/MUON/MCH/Contour/test/Contour.cxx</div></div><!-- fragment --><p>Instead of selecting the tests to run, you can invert the logic and exclude tests matching a regular expression using <code>-E</code> instead of <code>-R</code>.</p>
<h3>Selecting/excluding by label (-L/-LE)</h3>
<p>Assuming the tests have been labelled, you can use <code>-L</code> (to include) or <code>-LE</code> (to exclude) tests based on their labels. The full list of defined labels can be shown using the <code>--print-labels</code> option.</p>
<div class="fragment"><div class="line">&gt; ctest -N -L mch</div><div class="line">  Test #268: Detectors/MUON/MCH/Contour/test/BBox.cxx</div><div class="line">  Test #269: Detectors/MUON/MCH/Contour/test/Contour.cxx</div><div class="line">  Test #270: Detectors/MUON/MCH/Contour/test/ContourCreator.cxx</div><div class="line">  Test #271: Detectors/MUON/MCH/Contour/test/Edge.cxx</div><div class="line">  Test #272: Detectors/MUON/MCH/Contour/test/Interval.cxx</div><div class="line">  Test #273: Detectors/MUON/MCH/Contour/test/Polygon.cxx</div><div class="line">  Test #274: Detectors/MUON/MCH/Contour/test/SegmentTree.cxx</div><div class="line">  Test #275: Detectors/MUON/MCH/Contour/test/Vertex.cxx</div><div class="line">  Test #276: Detectors/MUON/MCH/Simulation/macros/drawMCHGeometry.C</div><div class="line">  Test #277: Detectors/MUON/MCH/Simulation/macros/drawMCHGeometry.C_compiled</div></div><!-- fragment --><h3>Speeding up ctest execution</h3>
<p>Finally, note that <code>ctest</code> can run tests in parallel (unless those that are explicitely marked as not safe to run in parallel) using the <code>-j n</code> option, where <code>n</code> is the max number of tests to run in parallel.</p>
<p>Serial execution :</p>
<div class="fragment"><div class="line">&gt; ctest -L mch -LE long -E Raw</div><div class="line">    Start 265: Detectors/MUON/MCH/Contour/test/BBox.cxx</div><div class="line">1/8 Test #265: Detectors/MUON/MCH/Contour/test/BBox.cxx .............   Passed    0.04 sec</div><div class="line">    Start 266: Detectors/MUON/MCH/Contour/test/Contour.cxx</div><div class="line">2/8 Test #266: Detectors/MUON/MCH/Contour/test/Contour.cxx ..........   Passed    0.05 sec</div><div class="line">    Start 267: Detectors/MUON/MCH/Contour/test/ContourCreator.cxx</div><div class="line">3/8 Test #267: Detectors/MUON/MCH/Contour/test/ContourCreator.cxx ...   Passed    0.05 sec</div><div class="line">    Start 268: Detectors/MUON/MCH/Contour/test/Edge.cxx</div><div class="line">4/8 Test #268: Detectors/MUON/MCH/Contour/test/Edge.cxx .............   Passed    0.05 sec</div><div class="line">    Start 269: Detectors/MUON/MCH/Contour/test/Interval.cxx</div><div class="line">5/8 Test #269: Detectors/MUON/MCH/Contour/test/Interval.cxx .........   Passed    0.05 sec</div><div class="line">    Start 270: Detectors/MUON/MCH/Contour/test/Polygon.cxx</div><div class="line">6/8 Test #270: Detectors/MUON/MCH/Contour/test/Polygon.cxx ..........   Passed    0.05 sec</div><div class="line">    Start 271: Detectors/MUON/MCH/Contour/test/SegmentTree.cxx</div><div class="line">7/8 Test #271: Detectors/MUON/MCH/Contour/test/SegmentTree.cxx ......   Passed    0.05 sec</div><div class="line">    Start 272: Detectors/MUON/MCH/Contour/test/Vertex.cxx</div><div class="line">8/8 Test #272: Detectors/MUON/MCH/Contour/test/Vertex.cxx ...........   Passed    0.05 sec</div><div class="line"></div><div class="line">100% tests passed, 0 tests failed out of 8</div><div class="line"></div><div class="line">Label Time Summary:</div><div class="line">mch     =   0.38 sec*proc (8 tests)</div><div class="line">muon    =   0.38 sec*proc (8 tests)</div><div class="line"></div><div class="line">Total Test time (real) =   0.49 sec</div></div><!-- fragment --><p>Parallel execution (on a machine with 16 cores) :</p>
<div class="fragment"><div class="line">&gt; ctest -L mch -LE long -E Raw -j 16</div><div class="line">    Start 270: Detectors/MUON/MCH/Contour/test/Polygon.cxx</div><div class="line">    Start 271: Detectors/MUON/MCH/Contour/test/SegmentTree.cxx</div><div class="line">    Start 268: Detectors/MUON/MCH/Contour/test/Edge.cxx</div><div class="line">    Start 267: Detectors/MUON/MCH/Contour/test/ContourCreator.cxx</div><div class="line">    Start 269: Detectors/MUON/MCH/Contour/test/Interval.cxx</div><div class="line">    Start 266: Detectors/MUON/MCH/Contour/test/Contour.cxx</div><div class="line">    Start 265: Detectors/MUON/MCH/Contour/test/BBox.cxx</div><div class="line">    Start 272: Detectors/MUON/MCH/Contour/test/Vertex.cxx</div><div class="line">1/8 Test #270: Detectors/MUON/MCH/Contour/test/Polygon.cxx ..........   Passed    0.08 sec</div><div class="line">2/8 Test #271: Detectors/MUON/MCH/Contour/test/SegmentTree.cxx ......   Passed    0.08 sec</div><div class="line">3/8 Test #268: Detectors/MUON/MCH/Contour/test/Edge.cxx .............   Passed    0.08 sec</div><div class="line">4/8 Test #269: Detectors/MUON/MCH/Contour/test/Interval.cxx .........   Passed    0.08 sec</div><div class="line">5/8 Test #267: Detectors/MUON/MCH/Contour/test/ContourCreator.cxx ...   Passed    0.08 sec</div><div class="line">6/8 Test #266: Detectors/MUON/MCH/Contour/test/Contour.cxx ..........   Passed    0.08 sec</div><div class="line">7/8 Test #265: Detectors/MUON/MCH/Contour/test/BBox.cxx .............   Passed    0.08 sec</div><div class="line">8/8 Test #272: Detectors/MUON/MCH/Contour/test/Vertex.cxx ...........   Passed    0.08 sec</div><div class="line"></div><div class="line">100% tests passed, 0 tests failed out of 8</div><div class="line"></div><div class="line">Label Time Summary:</div><div class="line">mch     =   0.65 sec*proc (8 tests)</div><div class="line">muon    =   0.65 sec*proc (8 tests)</div><div class="line"></div><div class="line">Total Test time (real) =   0.19 sec</div></div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d7/d16/refdoc.html">Documentation pages</a></li>
    <li class="footer">Generated on Thu Jun 4 2020 09:30:40 for Project by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
