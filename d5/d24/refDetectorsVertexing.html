<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Project: Detectors Vertexing</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../o2_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d5/d24/refDetectorsVertexing.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Detectors Vertexing </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>Classes for Vertexing</h1>
<h2>DCAFitterN</h2>
<p>Templated class to fit the Point of Closest Approach (PCA) of secondary vertex with N prongs. Allows minimization of either absolute or weighted Distances of Closest Approach (DCA) of N tracks to their common PCA.</p>
<p>For every N (prongs) a separate specialization must be instantiated, e.g. </p><div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="../../d0/d82/namespaceo2_1_1aod.html#ac79ecbd153242801250b9982b0b46664">Track</a> = <a class="code" href="../../de/dea/classo2_1_1track_1_1TrackParCov.html">o2::track::TrackParCov</a>;</div><div class="line"><a class="code" href="../../de/dec/classo2_1_1vertexing_1_1DCAFitterN.html">o2::vertexing::DCAFitterN&lt;2,Track&gt;</a> ft2; <span class="comment">// 2-prongs fitter</span></div><div class="line"><span class="comment">// or, to set at once some parameters</span></div><div class="line"><span class="keywordtype">float</span> bz = 5.;           <span class="comment">// field in kGauss</span></div><div class="line"><span class="keywordtype">bool</span> useAbsDCA = <span class="keyword">true</span>;   <span class="comment">// use abs. DCA minimizaition instead of default weighted</span></div><div class="line"><span class="keywordtype">bool</span> propToDCA = <span class="keyword">true</span>;   <span class="comment">// after fit, create a copy of tracks at the found PCA</span></div><div class="line"><a class="code" href="../../de/dec/classo2_1_1vertexing_1_1DCAFitterN.html">o2::vertexing::DCAFitterN&lt;3,Track&gt;</a> ft3(bz, useAbsDCA, propToDCA); <span class="comment">// 3-prongs fitter</span></div></div><!-- fragment --><p> One can also use predefined aliases <code><a class="el" href="../../d9/d33/namespaceo2_1_1vertexing.html#a2a0295ffe1b402d2ff9bfeb9ee62740f">o2::vertexing::DCAFitter2</a></code> and <code><a class="el" href="../../d9/d33/namespaceo2_1_1vertexing.html#a291a53b08ca00fc8c84c25d25e4454f8">o2::vertexing::DCAFitter3</a></code>; The main processing method is </p><div class="fragment"><div class="line"><a class="code" href="../../de/dec/classo2_1_1vertexing_1_1DCAFitterN.html#a5f9cd58e3ec6f46225a983ef1f6f3b6c">o2::vertexing::DCAFitterN&lt;N,Track&gt;::process</a>(<span class="keyword">const</span> <a class="code" href="../../d0/d82/namespaceo2_1_1aod.html#ac79ecbd153242801250b9982b0b46664">Track</a>&amp; trc1,..., cons <a class="code" href="../../d0/d82/namespaceo2_1_1aod.html#ac79ecbd153242801250b9982b0b46664">Track</a>&amp; trcN);</div></div><!-- fragment --><p>The typical use case is (for e.g. 3-prong fitter): </p><div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="../../d9/d33/namespaceo2_1_1vertexing.html#a0fe2c4ea7eb00b7431ab158b9e7a2bc9">Vec3D</a>    =  ROOT::Math::SVector&lt;double,3&gt;; <span class="comment">// this is a type of the fitted vertex</span></div><div class="line"><a class="code" href="../../de/dec/classo2_1_1vertexing_1_1DCAFitterN.html">o2::vertexing::DCAFitter3</a> ft;</div><div class="line">ft.<a class="code" href="../../de/dec/classo2_1_1vertexing_1_1DCAFitterN.html#a18ccf21937e432eb187df626453b73f8">setBz</a>(5.0);</div><div class="line">ft.<a class="code" href="../../de/dec/classo2_1_1vertexing_1_1DCAFitterN.html#a95651f323beb1818b102f33f59dfb229">setPropagateToPCA</a>(<span class="keyword">true</span>); <span class="comment">// After finding the vertex, propagate tracks to the DCA. This is default anyway</span></div><div class="line">ft.<a class="code" href="../../de/dec/classo2_1_1vertexing_1_1DCAFitterN.html#a0c3dc5298ec093fd2c0e96d7b6ff1164">setMaxR</a>(200);            <span class="comment">// do not consider V0 seeds with 2D circles crossing above this R. This is default anyway</span></div><div class="line">ft.<a class="code" href="../../de/dec/classo2_1_1vertexing_1_1DCAFitterN.html#a509278fd99259267668d82fb14991a72">setMaxDZIni</a>(4);          <span class="comment">// do not consider V0 seeds with tracks Z-distance exceeding this. This is default anyway</span></div><div class="line">ft.<a class="code" href="../../de/dec/classo2_1_1vertexing_1_1DCAFitterN.html#a9a5632de5c43bb296826c37391ec73a8">setMinParamChange</a>(1<a class="code" href="../../d8/de9/qconfigoptions_8h.html#acc2760558000045ec0803d60d4d01c98">e</a>-3); <span class="comment">// stop iterations if max correction is below this value. This is default anyway</span></div><div class="line">ft.<a class="code" href="../../de/dec/classo2_1_1vertexing_1_1DCAFitterN.html#ac35a577a4d86cb8c4878f5bd014f2fc7">setMinRelChi2Change</a>(0.9);<span class="comment">// stop iterations if chi2 improves by less that this factor</span></div><div class="line">ft.<a class="code" href="../../de/dec/classo2_1_1vertexing_1_1DCAFitterN.html#a2d94e23c33cff2f9f20702acb2a70d6e">setMaxChi2</a>(10);          <span class="comment">// discard vertices with chi2/Nprongs (or sum{DCAi^2}/Nprongs for abs. distance minimization) </span></div><div class="line"></div><div class="line"><a class="code" href="../../d0/d82/namespaceo2_1_1aod.html#ac79ecbd153242801250b9982b0b46664">Track</a> tr0,tr1,tr2;                  <span class="comment">// decide candidate tracks</span></div><div class="line"><span class="keywordtype">int</span> nc = ft.<a class="code" href="../../de/dec/classo2_1_1vertexing_1_1DCAFitterN.html#a5f9cd58e3ec6f46225a983ef1f6f3b6c">process</a>(tr0,tr1,tr2);   <span class="comment">// one can have up to 2 candidates, though the 2nd (if any) will have worse quality</span></div><div class="line"><span class="keywordflow">if</span> (nc) {</div><div class="line">   <a class="code" href="../../d9/d33/namespaceo2_1_1vertexing.html#a0fe2c4ea7eb00b7431ab158b9e7a2bc9">Vec3D</a> vtx = ft.<a class="code" href="../../de/dec/classo2_1_1vertexing_1_1DCAFitterN.html#a0ce5d9f5aa268a771641a396309cdcc1">getPCACandidate</a>(); <span class="comment">// same as ft.getPCACandidate(0);</span></div><div class="line">   <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(INFO) &lt;&lt; <span class="stringliteral">&quot;found vertex &quot;</span> &lt;&lt; vtx[0] &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; vtx[1] &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; vtx[2];</div><div class="line">   <span class="comment">// access the track&#39;s X parameters at PCA</span></div><div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;3;i++) {</div><div class="line">    <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(INFO) &lt;&lt; <span class="stringliteral">&quot;Track &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; at PCA for X = &quot;</span> &lt;&lt; ft.<a class="code" href="../../de/dec/classo2_1_1vertexing_1_1DCAFitterN.html#a148032a6c9d9e255e5077c29ddb00b0b">getTrackX</a>(i);</div><div class="line">   }</div><div class="line">   <span class="comment">// access directly the tracks propagated to the DCA</span></div><div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;3;i++) {</div><div class="line">     <span class="keyword">const</span> <span class="keyword">auto</span>&amp; track = ft.<a class="code" href="../../de/dec/classo2_1_1vertexing_1_1DCAFitterN.html#a71ea1956221814ae55680932be5c93a1">getTrack</a>(i);</div><div class="line">     track.<a class="code" href="../../de/dea/classo2_1_1track_1_1TrackParCov.html#a19c2f0a3d1d3425fad353b1c83517e22">print</a>();</div><div class="line">   }</div><div class="line">}</div></div><!-- fragment --><p>See <code>O2/Detectors/Base/test/testDCAFitterN.cxx</code> for more extended example. Currently only 2 and 3 prongs permitted, thought this can be changed by modifying <code>DCAFitterN::NMax</code> constant. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d0/d2f/refDetectors.html">Module &#39;Detectors&#39;</a></li>
    <li class="footer">Generated on Thu Jun 4 2020 09:30:40 for Project by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
