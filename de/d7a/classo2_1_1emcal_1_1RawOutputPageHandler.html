<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Project: o2::emcal::RawOutputPageHandler Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../o2_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('de/d7a/classo2_1_1emcal_1_1RawOutputPageHandler.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="../../d2/d7d/classo2_1_1emcal_1_1RawOutputPageHandler-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">o2::emcal::RawOutputPageHandler Class Reference<div class="ingroups"><a class="el" href="../../db/d07/group__DetectorEMCAL.html">EMCAL</a> &raquo; <a class="el" href="../../d4/d72/group__EMCALsimulation.html">EMCAL simulation</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Handler for EMCAL raw page buffering, timeframe building and output streaming.  
 <a href="../../de/d7a/classo2_1_1emcal_1_1RawOutputPageHandler.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../d9/d87/RawOutputPageHandler_8h_source.html">RawOutputPageHandler.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for o2::emcal::RawOutputPageHandler:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d97/classo2_1_1emcal_1_1RawOutputPageHandler__coll__graph.svg" width="223" height="147"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dcc/classo2_1_1emcal_1_1RawOutputPageHandler_1_1LinkIDException.html">LinkIDException</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Exception handling invalid link IDs (outside the range of EMCAL links)  <a href="../../de/dcc/classo2_1_1emcal_1_1RawOutputPageHandler_1_1LinkIDException.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dd7/classo2_1_1emcal_1_1RawOutputPageHandler_1_1RawPageBuffer.html">RawPageBuffer</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer for raw pages.  <a href="../../de/dd7/classo2_1_1emcal_1_1RawOutputPageHandler_1_1RawPageBuffer.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:ad7fafa46efb5ea58986ecd7d11296d51"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d7a/classo2_1_1emcal_1_1RawOutputPageHandler.html#ad7fafa46efb5ea58986ecd7d11296d51">RawHeader</a> = <a class="el" href="../../d8/d47/structo2_1_1header_1_1RAWDataHeaderV4.html">o2::header::RAWDataHeaderV4</a></td></tr>
<tr class="separator:ad7fafa46efb5ea58986ecd7d11296d51"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a7684a9ae00e5e12e59b61d2b06267856"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d7a/classo2_1_1emcal_1_1RawOutputPageHandler.html#a7684a9ae00e5e12e59b61d2b06267856">RawOutputPageHandler</a> (const char *rawfilename)</td></tr>
<tr class="memdesc:a7684a9ae00e5e12e59b61d2b06267856"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor, initializing page handler with output filename and HBF utils.  <a href="#a7684a9ae00e5e12e59b61d2b06267856">More...</a><br /></td></tr>
<tr class="separator:a7684a9ae00e5e12e59b61d2b06267856"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d2b887c73c61edceaa1ce19b137ea0a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d7a/classo2_1_1emcal_1_1RawOutputPageHandler.html#a2d2b887c73c61edceaa1ce19b137ea0a">~RawOutputPageHandler</a> ()</td></tr>
<tr class="memdesc:a2d2b887c73c61edceaa1ce19b137ea0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="#a2d2b887c73c61edceaa1ce19b137ea0a">More...</a><br /></td></tr>
<tr class="separator:a2d2b887c73c61edceaa1ce19b137ea0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49153b52d323feef0b95d995c4dc4e17"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/da3/glcorearb_8h.html#a950fc91edb4504f62f1c577bf4727c29">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d7a/classo2_1_1emcal_1_1RawOutputPageHandler.html#a49153b52d323feef0b95d995c4dc4e17">initTrigger</a> (const <a class="el" href="../../d1/d21/structo2_1_1InteractionRecord.html">o2::InteractionRecord</a> &amp;currentIR)</td></tr>
<tr class="memdesc:a49153b52d323feef0b95d995c4dc4e17"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize new trigger.  <a href="#a49153b52d323feef0b95d995c4dc4e17">More...</a><br /></td></tr>
<tr class="separator:a49153b52d323feef0b95d995c4dc4e17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac8ac089fa876a1cb2960ccb9fb46097"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/da3/glcorearb_8h.html#a950fc91edb4504f62f1c577bf4727c29">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d7a/classo2_1_1emcal_1_1RawOutputPageHandler.html#aac8ac089fa876a1cb2960ccb9fb46097">addPageForLink</a> (<a class="el" href="../../d8/de9/qconfigoptions_8h.html#ad08a37964429d340d966dfa679443e8f">int</a> linkID, const <a class="el" href="../../de/d7a/classo2_1_1emcal_1_1RawOutputPageHandler.html#ad7fafa46efb5ea58986ecd7d11296d51">RawHeader</a> &amp;header, const std::vector&lt; char &gt; &amp;dmapage)</td></tr>
<tr class="memdesc:aac8ac089fa876a1cb2960ccb9fb46097"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add new page for link to the page buffer.  <a href="#aac8ac089fa876a1cb2960ccb9fb46097">More...</a><br /></td></tr>
<tr class="separator:aac8ac089fa876a1cb2960ccb9fb46097"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Handler for EMCAL raw page buffering, timeframe building and output streaming. </p>
<dl class="section author"><dt>Author</dt><dd>Markus Fasel <a href="#" onclick="location.href='mai'+'lto:'+'mar'+'ku'+'s.f'+'as'+'el@'+'ce'+'rn.'+'ch'; return false;">marku<span style="display: none;">.nosp@m.</span>s.fa<span style="display: none;">.nosp@m.</span>sel@c<span style="display: none;">.nosp@m.</span>ern.<span style="display: none;">.nosp@m.</span>ch</a>, Oak Ridge National Laboratory </dd></dl>
<dl class="section since"><dt>Since</dt><dd>March 22, 2020</dd></dl>
<h1>General</h1>
<p>The raw format for EMCAL consists of separate superpages of timeframes arranged per (DDL) link. Each timeframe consists of</p><ul>
<li>Empty RDH without payload indicating start of timeframe. Counters are reset</li>
<li>Pages with RDH and payload for each trigger BC within the timeframe</li>
<li>Empty RDH without payload indicating end of timeframe. Contains the number of pages in the timeframe, the stop bit and the timeframe trigger. At the start of data an empty timeframe (without pages) consisting only of star and stop RDH will mark the beginning of the data stream.</li>
</ul>
<h1>Usage</h1>
<p>For each new trigger the function initTrigger is to be called with the <a class="el" href="../../d1/d21/structo2_1_1InteractionRecord.html">InteractionRecord</a> of the bunch crossing corresponding to the trigger. Pages created by the raw writer and added via addPageForLink are buffered per link. The HBFUtils, provided from outside, decide on whether a new timeframe is triggered. In case of a new timeframe raw timeframes are created for all links with pages, containing all pages of a link and streamed to file (in initTrigger). In case the buffer still contains pages when the destructor is called, the pages are streamed as remaining pages of the last timeframe (in the destructor). </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d87/RawOutputPageHandler_8h_source.html#l00047">47</a> of file <a class="el" href="../../d9/d87/RawOutputPageHandler_8h_source.html">RawOutputPageHandler.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="ad7fafa46efb5ea58986ecd7d11296d51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7fafa46efb5ea58986ecd7d11296d51">&#9670;&nbsp;</a></span>RawHeader</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="../../de/d7a/classo2_1_1emcal_1_1RawOutputPageHandler.html#ad7fafa46efb5ea58986ecd7d11296d51">o2::emcal::RawOutputPageHandler::RawHeader</a> =  <a class="el" href="../../d8/d47/structo2_1_1header_1_1RAWDataHeaderV4.html">o2::header::RAWDataHeaderV4</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/d87/RawOutputPageHandler_8h_source.html#l00050">50</a> of file <a class="el" href="../../d9/d87/RawOutputPageHandler_8h_source.html">RawOutputPageHandler.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a7684a9ae00e5e12e59b61d2b06267856"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7684a9ae00e5e12e59b61d2b06267856">&#9670;&nbsp;</a></span>RawOutputPageHandler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">RawOutputPageHandler::RawOutputPageHandler </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>rawfilename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor, initializing page handler with output filename and HBF utils. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rawfilename</td><td>Name of the output file </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d98/RawOutputPageHandler_8cxx_source.html#l00018">18</a> of file <a class="el" href="../../d3/d98/RawOutputPageHandler_8cxx_source.html">RawOutputPageHandler.cxx</a>.</p>

</div>
</div>
<a id="a2d2b887c73c61edceaa1ce19b137ea0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d2b887c73c61edceaa1ce19b137ea0a">&#9670;&nbsp;</a></span>~RawOutputPageHandler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">RawOutputPageHandler::~RawOutputPageHandler </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor. </p>
<p>In case buffers contain payload the page is streamed as last timeframe for the links containing payload pages. </p>

<p class="definition">Definition at line <a class="el" href="../../d3/d98/RawOutputPageHandler_8cxx_source.html#l00026">26</a> of file <a class="el" href="../../d3/d98/RawOutputPageHandler_8cxx_source.html">RawOutputPageHandler.cxx</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aac8ac089fa876a1cb2960ccb9fb46097"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac8ac089fa876a1cb2960ccb9fb46097">&#9670;&nbsp;</a></span>addPageForLink()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/da3/glcorearb_8h.html#a950fc91edb4504f62f1c577bf4727c29">void</a> RawOutputPageHandler::addPageForLink </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/de9/qconfigoptions_8h.html#ad08a37964429d340d966dfa679443e8f">int</a>&#160;</td>
          <td class="paramname"><em>linkID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/d7a/classo2_1_1emcal_1_1RawOutputPageHandler.html#ad7fafa46efb5ea58986ecd7d11296d51">RawHeader</a> &amp;&#160;</td>
          <td class="paramname"><em>header</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; char &gt; &amp;&#160;</td>
          <td class="paramname"><em>dmapage</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add new page for link to the page buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">linkID</td><td>ID of the link </td></tr>
    <tr><td class="paramname">header</td><td>Template raw header of the page </td></tr>
    <tr><td class="paramname">dmapage</td><td>Payload page </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="../../de/dcc/classo2_1_1emcal_1_1RawOutputPageHandler_1_1LinkIDException.html" title="Exception handling invalid link IDs (outside the range of EMCAL links) ">LinkIDException</a></td><td>in case link ID is invalid </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d98/RawOutputPageHandler_8cxx_source.html#l00073">73</a> of file <a class="el" href="../../d3/d98/RawOutputPageHandler_8cxx_source.html">RawOutputPageHandler.cxx</a>.</p>

</div>
</div>
<a id="a49153b52d323feef0b95d995c4dc4e17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49153b52d323feef0b95d995c4dc4e17">&#9670;&nbsp;</a></span>initTrigger()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/da3/glcorearb_8h.html#a950fc91edb4504f62f1c577bf4727c29">void</a> RawOutputPageHandler::initTrigger </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d1/d21/structo2_1_1InteractionRecord.html">o2::InteractionRecord</a> &amp;&#160;</td>
          <td class="paramname"><em>currentIR</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize new trigger. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">currentIR</td><td>Interaction record of the collision triggering</td></tr>
  </table>
  </dd>
</dl>
<p>Initialize new trigger. In case the Timeframe changes with the trigger the buffers belonging to the previous buffer are streamed to file. For each link a separate timeframe is created, starting with empty open/close raw data header. Timeframes are only created for links which buffer pages. </p>

<p class="definition">Definition at line <a class="el" href="../../d3/d98/RawOutputPageHandler_8cxx_source.html#l00036">36</a> of file <a class="el" href="../../d3/d98/RawOutputPageHandler_8cxx_source.html">RawOutputPageHandler.cxx</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/travis/build/AliceO2Group/AliceO2/Detectors/EMCAL/simulation/include/EMCALSimulation/<a class="el" href="../../d9/d87/RawOutputPageHandler_8h_source.html">RawOutputPageHandler.h</a></li>
<li>/home/travis/build/AliceO2Group/AliceO2/Detectors/EMCAL/simulation/src/<a class="el" href="../../d3/d98/RawOutputPageHandler_8cxx_source.html">RawOutputPageHandler.cxx</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d4/d7c/namespaceo2.html">o2</a></li><li class="navelem"><a class="el" href="../../db/dc1/namespaceo2_1_1emcal.html">emcal</a></li><li class="navelem"><a class="el" href="../../de/d7a/classo2_1_1emcal_1_1RawOutputPageHandler.html">RawOutputPageHandler</a></li>
    <li class="footer">Generated on Thu Jun 4 2020 09:30:43 for Project by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
