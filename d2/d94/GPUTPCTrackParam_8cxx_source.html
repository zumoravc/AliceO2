<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Project: /home/travis/build/AliceO2Group/AliceO2/GPU/GPUTracking/SliceTracker/GPUTPCTrackParam.cxx Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../o2_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d2/d94/GPUTPCTrackParam_8cxx_source.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">GPUTPCTrackParam.cxx</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d2/d94/GPUTPCTrackParam_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Copyright CERN and copyright holders of ALICE O2. This software is</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// distributed under the terms of the GNU General Public License v3 (GPL</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Version 3), copied verbatim in the file &quot;COPYING&quot;.</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// See http://alice-o2.web.cern.ch/license for full licensing information.</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// In applying this license CERN does not waive the privileges and immunities</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// granted to it by virtue of its status as an Intergovernmental Organization</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// or submit itself to any jurisdiction.</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/d52/GPUTPCTrackLinearisation_8h.html">GPUTPCTrackLinearisation.h</a>&quot;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d15/GPUTPCTrackParam_8h.html">GPUTPCTrackParam.h</a>&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="keyword">using namespace </span><a class="code" href="../../d8/dde/namespaceGPUCA__NAMESPACE_1_1gpu.html">GPUCA_NAMESPACE::gpu</a>;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// Circle in XY:</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// kCLight = 0.000299792458;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">// Kappa = -Bz*kCLight*QPt;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">// R  = 1/fabsf(Kappa);</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">// Xc = X - sin(Phi)/Kappa;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">// Yc = Y + cos(Phi)/Kappa;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#aed5cddc2b3dcfd3fee827ae94a244699">MEM_CLASS_PRE</a>()</div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="../../d2/d94/GPUTPCTrackParam_8cxx.html#a0901d6ea731b5d98e828e49f829904b2">   30</a></span>&#160;<a class="code" href="../../d8/dde/namespaceGPUCA__NAMESPACE_1_1gpu.html#a93fe70d5398168e15a525612430670c0">GPUd</a>() <span class="keywordtype">float</span> <a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#ab4bab4f5ae1444c8f9a44b1ece558215">MEM_LG</a>(<a class="code" href="../../d2/dc0/classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackParam.html">GPUTPCTrackParam</a>)::GetDist2(const <a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#ab4bab4f5ae1444c8f9a44b1ece558215">MEM_LG</a>(<a class="code" href="../../d2/dc0/classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackParam.html">GPUTPCTrackParam</a>) &amp; <a class="code" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a2cdbb9508b46bd8f3a6039b702ebd16d">t</a>)<span class="keyword"> const</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="comment">// get squared distance between tracks</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">float</span> dx = GetX() - t.GetX();</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordtype">float</span> dy = GetY() - t.GetY();</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordtype">float</span> dz = GetZ() - t.GetZ();</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordflow">return</span> dx * dx + dy * dy + dz * dz;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;}</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#aed5cddc2b3dcfd3fee827ae94a244699">MEM_CLASS_PRE</a>()</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<a class="code" href="../../d8/dde/namespaceGPUCA__NAMESPACE_1_1gpu.html#a93fe70d5398168e15a525612430670c0">GPUd</a>() <span class="keywordtype">float</span> <a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#ab4bab4f5ae1444c8f9a44b1ece558215">MEM_LG</a>(<a class="code" href="../../d2/dc0/classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackParam.html">GPUTPCTrackParam</a>)::GetDistXZ2(<span class="keyword">const</span> <a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#ab4bab4f5ae1444c8f9a44b1ece558215">MEM_LG</a>(<a class="code" href="../../d2/dc0/classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackParam.html">GPUTPCTrackParam</a>) &amp; <a class="code" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a2cdbb9508b46bd8f3a6039b702ebd16d">t</a>)<span class="keyword"> const</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="comment">// get squared distance between tracks in X&amp;Z</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordtype">float</span> dx = GetX() - <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a2cdbb9508b46bd8f3a6039b702ebd16d">t</a>.GetX();</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordtype">float</span> dz = GetZ() - <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a2cdbb9508b46bd8f3a6039b702ebd16d">t</a>.GetZ();</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordflow">return</span> dx * dx + dz * dz;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;}</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#aed5cddc2b3dcfd3fee827ae94a244699">MEM_CLASS_PRE</a>()</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<a class="code" href="../../d8/dde/namespaceGPUCA__NAMESPACE_1_1gpu.html#a93fe70d5398168e15a525612430670c0">GPUd</a>() <span class="keywordtype">float</span> <a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#ab4bab4f5ae1444c8f9a44b1ece558215">MEM_LG</a>(<a class="code" href="../../d2/dc0/classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackParam.html">GPUTPCTrackParam</a>)::GetS(<span class="keywordtype">float</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a>, <span class="keywordtype">float</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a74d80fd479c0f6d0153c709949a089ef">y</a>, <span class="keywordtype">float</span> Bz)<span class="keyword"> const</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="comment">//* Get XY path length to the given point</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordtype">float</span> k = GetKappa(Bz);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordtype">float</span> ex = GetCosPhi();</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordtype">float</span> ey = GetSinPhi();</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  x -= GetX();</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  y -= GetY();</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keywordtype">float</span> dS = x * ex + y * ey;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215">CAMath::Abs</a>(k) &gt; 1.<a class="code" href="../../d8/de9/qconfigoptions_8h.html#acc2760558000045ec0803d60d4d01c98">e</a>-4<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a>) {</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    dS = CAMath::ATan2(k * dS, 1 + k * (x * ey - y * ex)) / k;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  }</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordflow">return</span> dS;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;}</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#aed5cddc2b3dcfd3fee827ae94a244699">MEM_CLASS_PRE</a>()</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<a class="code" href="../../d8/dde/namespaceGPUCA__NAMESPACE_1_1gpu.html#a93fe70d5398168e15a525612430670c0">GPUd</a>() <span class="keywordtype">void</span> <a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#ab4bab4f5ae1444c8f9a44b1ece558215">MEM_LG</a>(<a class="code" href="../../d2/dc0/classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackParam.html">GPUTPCTrackParam</a>)::GetDCAPoint(<span class="keywordtype">float</span> x, <span class="keywordtype">float</span> y, <span class="keywordtype">float</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#aee38b51639b577753f6a92029fb92000">z</a>, <span class="keywordtype">float</span>&amp; <a class="code" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() xp, <span class="keywordtype">float</span>&amp; <a class="code" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() yp, <span class="keywordtype">float</span>&amp; <a class="code" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() zp, <span class="keywordtype">float</span> Bz)<span class="keyword"> const</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">//* Get the track point closest to the (x,y,z)</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keywordtype">float</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a98ac434677655cc8438bb72de2719f39">x0</a> = GetX();</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordtype">float</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#ae7f97ed6c9c8e502fcbc44c7cb8a8312">y0</a> = GetY();</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordtype">float</span> k = GetKappa(Bz);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordtype">float</span> ex = GetCosPhi();</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordtype">float</span> ey = GetSinPhi();</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordtype">float</span> dx = x - <a class="code" href="../../dc/da3/glcorearb_8h.html#a98ac434677655cc8438bb72de2719f39">x0</a>;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordtype">float</span> dy = y - <a class="code" href="../../dc/da3/glcorearb_8h.html#ae7f97ed6c9c8e502fcbc44c7cb8a8312">y0</a>;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordtype">float</span> ax = dx * k + ey;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordtype">float</span> ay = dy * k - ex;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keywordtype">float</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#ac8729153468b5dcf13f971b21d84d4e5">a</a> = sqrt(ax * ax + ay * ay);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  xp = x0 + (dx - ey * ((dx * dx + dy * dy) * k - 2 * (-dx * ey + dy * ex)) / (a + 1)) / a;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  yp = y0 + (dy + ex * ((dx * dx + dy * dy) * k - 2 * (-dx * ey + dy * ex)) / (a + 1)) / a;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordtype">float</span> s = GetS(x, y, Bz);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  zp = GetZ() + GetDzDs() * s;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215">CAMath::Abs</a>(k) &gt; 1.<a class="code" href="../../d8/de9/qconfigoptions_8h.html#acc2760558000045ec0803d60d4d01c98">e</a>-2<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a>) {</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordtype">float</span> dZ = <a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215">CAMath::Abs</a>(GetDzDs() * <a class="code" href="../../d3/df6/namespaceo2_1_1its_1_1constants_1_1math.html#ab8ae067bdc328b3dede71d13994af907">CAMath::TwoPi</a>() / k);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">if</span> (dZ &gt; .1<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a>) {</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      zp += CAMath::Nint((z - zp) / dZ) * dZ;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    }</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  }</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">//*</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">//* Transport routines</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">//*</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#aed5cddc2b3dcfd3fee827ae94a244699">MEM_CLASS_PRE</a>()</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<a class="code" href="../../d8/dde/namespaceGPUCA__NAMESPACE_1_1gpu.html#a93fe70d5398168e15a525612430670c0">GPUd</a>() <span class="keywordtype">bool</span> <a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#ab4bab4f5ae1444c8f9a44b1ece558215">MEM_LG</a>(<a class="code" href="../../d2/dc0/classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackParam.html">GPUTPCTrackParam</a>)::TransportToX(<span class="keywordtype">float</span> x, <a class="code" href="../../df/de6/classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackLinearisation.html">GPUTPCTrackLinearisation</a>&amp; <a class="code" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() <a class="code" href="../../dc/da3/glcorearb_8h.html#abf0ea7853561a9028dbbc4caeb2f8ff1">t0</a>, <span class="keywordtype">float</span> Bz, <span class="keywordtype">float</span> maxSinPhi, <span class="keywordtype">float</span>* <a class="code" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() DL)</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;{</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="comment">//* Transport the track parameters to X=x, using linearization at t0, and the field value Bz</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="comment">//* maxSinPhi is the max. allowed value for |t0.SinPhi()|</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="comment">//* linearisation of trajectory t0 is also transported to X=x,</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="comment">//* returns 1 if OK</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="comment">//*</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordtype">float</span> ex = <a class="code" href="../../dc/da3/glcorearb_8h.html#abf0ea7853561a9028dbbc4caeb2f8ff1">t0</a>.CosPhi();</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordtype">float</span> ey = <a class="code" href="../../dc/da3/glcorearb_8h.html#abf0ea7853561a9028dbbc4caeb2f8ff1">t0</a>.SinPhi();</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordtype">float</span> k = -<a class="code" href="../../dc/da3/glcorearb_8h.html#abf0ea7853561a9028dbbc4caeb2f8ff1">t0</a>.QPt() * Bz;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordtype">float</span> dx = x - <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a77854b1fceea9fca2fa33736d20fae6a">X</a>();</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordtype">float</span> ey1 = k * dx + ey;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordtype">float</span> ex1;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="comment">// check for intersection with X=x</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215">CAMath::Abs</a>(ey1) &gt; maxSinPhi) {</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  }</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  ex1 = CAMath::Sqrt(1 - ey1 * ey1);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">if</span> (ex &lt; 0) {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    ex1 = -ex1;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  }</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordtype">float</span> dx2 = dx * dx;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordtype">float</span> ss = ey + ey1;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordtype">float</span> cc = ex + ex1;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215">CAMath::Abs</a>(cc) &lt; 1.<a class="code" href="../../d8/de9/qconfigoptions_8h.html#acc2760558000045ec0803d60d4d01c98">e</a>-4<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a> || <a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215">CAMath::Abs</a>(ex) &lt; 1.<a class="code" href="../../d8/de9/qconfigoptions_8h.html#acc2760558000045ec0803d60d4d01c98">e</a>-4<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a> || <a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215">CAMath::Abs</a>(ex1) &lt; 1.<a class="code" href="../../d8/de9/qconfigoptions_8h.html#acc2760558000045ec0803d60d4d01c98">e</a>-4<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a>) {</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  }</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordtype">float</span> tg = ss / cc; <span class="comment">// tanf((phi1+phi)/2)</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keywordtype">float</span> dy = dx * tg;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordtype">float</span> dl = dx * CAMath::Sqrt(1 + tg * tg);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="keywordflow">if</span> (cc &lt; 0) {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    dl = -dl;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordtype">float</span> dSin = dl * k / 2;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="keywordflow">if</span> (dSin &gt; 1) {</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    dSin = 1;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  }</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="keywordflow">if</span> (dSin &lt; -1) {</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    dSin = -1;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  }</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keywordtype">float</span> dS = (<a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215">CAMath::Abs</a>(k) &gt; 1.e-4<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a>) ? (2 * CAMath::ASin(dSin) / k) : dl;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordtype">float</span> dz = dS * <a class="code" href="../../dc/da3/glcorearb_8h.html#abf0ea7853561a9028dbbc4caeb2f8ff1">t0</a>.DzDs();</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordflow">if</span> (DL) {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    *DL = -dS * CAMath::Sqrt(1 + <a class="code" href="../../dc/da3/glcorearb_8h.html#abf0ea7853561a9028dbbc4caeb2f8ff1">t0</a>.DzDs() * <a class="code" href="../../dc/da3/glcorearb_8h.html#abf0ea7853561a9028dbbc4caeb2f8ff1">t0</a>.DzDs());</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  }</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordtype">float</span> cci = 1.f / cc;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordtype">float</span> exi = 1.f / ex;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordtype">float</span> ex1i = 1.f / ex1;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordtype">float</span> <a class="code" href="../../d8/de9/qconfigoptions_8h.html#aa614ae9e8ec8f5346ac88d0be625fa22">d</a>[5] = {0, 0, GetPar(2) - <a class="code" href="../../dc/da3/glcorearb_8h.html#abf0ea7853561a9028dbbc4caeb2f8ff1">t0</a>.SinPhi(), GetPar(3) - <a class="code" href="../../dc/da3/glcorearb_8h.html#abf0ea7853561a9028dbbc4caeb2f8ff1">t0</a>.DzDs(), GetPar(4) - <a class="code" href="../../dc/da3/glcorearb_8h.html#abf0ea7853561a9028dbbc4caeb2f8ff1">t0</a>.QPt()};</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="comment">// float H0[5] = { 1,0, h2,  0, h4 };</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="comment">// float H1[5] = { 0, 1, 0, dS,  0 };</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="comment">// float H2[5] = { 0, 0, 1,  0, dxBz };</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="comment">// float H3[5] = { 0, 0, 0,  1,  0 };</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="comment">// float H4[5] = { 0, 0, 0,  0,  1 };</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="keywordtype">float</span> h2 = dx * (1 + ey * ey1 + ex * ex1) * exi * ex1i * cci;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keywordtype">float</span> h4 = dx2 * (cc + ss * ey1 * ex1i) * cci * cci * (-Bz);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keywordtype">float</span> dxBz = dx * (-Bz);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <a class="code" href="../../dc/da3/glcorearb_8h.html#abf0ea7853561a9028dbbc4caeb2f8ff1">t0</a>.SetCosPhi(ex1);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <a class="code" href="../../dc/da3/glcorearb_8h.html#abf0ea7853561a9028dbbc4caeb2f8ff1">t0</a>.SetSinPhi(ey1);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  SetX(<a class="code" href="../../d8/de9/qconfigoptions_8h.html#a77854b1fceea9fca2fa33736d20fae6a">X</a>() + dx);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  SetPar(0, Y() + dy + h2 * d[2] + h4 * d[4]);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  SetPar(1, Z() + dz + dS * d[3]);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  SetPar(2, <a class="code" href="../../dc/da3/glcorearb_8h.html#abf0ea7853561a9028dbbc4caeb2f8ff1">t0</a>.SinPhi() + d[2] + dxBz * d[4]);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordtype">float</span> c00 = mParam.mC[0];</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keywordtype">float</span> c10 = mParam.mC[1];</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keywordtype">float</span> c11 = mParam.mC[2];</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordtype">float</span> c20 = mParam.mC[3];</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keywordtype">float</span> c21 = mParam.mC[4];</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordtype">float</span> c22 = mParam.mC[5];</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keywordtype">float</span> c30 = mParam.mC[6];</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordtype">float</span> c31 = mParam.mC[7];</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordtype">float</span> c32 = mParam.mC[8];</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keywordtype">float</span> c33 = mParam.mC[9];</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keywordtype">float</span> c40 = mParam.mC[10];</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordtype">float</span> c41 = mParam.mC[11];</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="keywordtype">float</span> c42 = mParam.mC[12];</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keywordtype">float</span> c43 = mParam.mC[13];</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keywordtype">float</span> c44 = mParam.mC[14];</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  mParam.mC[0] = c00 + h2 * h2 * c22 + h4 * h4 * c44 + 2 * (h2 * c20 + h4 * c40 + h2 * h4 * c42);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  mParam.mC[1] = c10 + h2 * c21 + h4 * c41 + dS * (c30 + h2 * c32 + h4 * c43);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  mParam.mC[2] = c11 + 2 * dS * c31 + dS * dS * c33;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  mParam.mC[3] = c20 + h2 * c22 + h4 * c42 + dxBz * (c40 + h2 * c42 + h4 * c44);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  mParam.mC[4] = c21 + dS * c32 + dxBz * (c41 + dS * c43);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  mParam.mC[5] = c22 + 2 * dxBz * c42 + dxBz * dxBz * c44;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  mParam.mC[6] = c30 + h2 * c32 + h4 * c43;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  mParam.mC[7] = c31 + dS * c33;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  mParam.mC[8] = c32 + dxBz * c43;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  mParam.mC[9] = c33;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  mParam.mC[10] = c40 + h2 * c42 + h4 * c44;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  mParam.mC[11] = c41 + dS * c43;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  mParam.mC[12] = c42 + dxBz * c44;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  mParam.mC[13] = c43;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  mParam.mC[14] = c44;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;}</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#aed5cddc2b3dcfd3fee827ae94a244699">MEM_CLASS_PRE</a>()</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<a class="code" href="../../d8/dde/namespaceGPUCA__NAMESPACE_1_1gpu.html#a93fe70d5398168e15a525612430670c0">GPUd</a>() <span class="keywordtype">bool</span> <a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#ab4bab4f5ae1444c8f9a44b1ece558215">MEM_LG</a>(<a class="code" href="../../d2/dc0/classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackParam.html">GPUTPCTrackParam</a>)::TransportToX(<span class="keywordtype">float</span> x, <span class="keywordtype">float</span> sinPhi0, <span class="keywordtype">float</span> cosPhi0, <span class="keywordtype">float</span> Bz, <span class="keywordtype">float</span> maxSinPhi)</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;{</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="comment">//* Transport the track parameters to X=x, using linearization at phi0 with 0 curvature,</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="comment">//* and the field value Bz</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="comment">//* maxSinPhi is the max. allowed value for |t0.SinPhi()|</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="comment">//* linearisation of trajectory t0 is also transported to X=x,</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="comment">//* returns 1 if OK</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="comment">//*</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keywordtype">float</span> ex = cosPhi0;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keywordtype">float</span> ey = sinPhi0;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keywordtype">float</span> dx = x - <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a77854b1fceea9fca2fa33736d20fae6a">X</a>();</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215">CAMath::Abs</a>(ex) &lt; 1.<a class="code" href="../../d8/de9/qconfigoptions_8h.html#acc2760558000045ec0803d60d4d01c98">e</a>-4<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a>) {</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  }</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordtype">float</span> exi = 1.f / ex;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keywordtype">float</span> dxBz = dx * (-Bz);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keywordtype">float</span> dS = dx * exi;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordtype">float</span> h2 = dS * exi * exi;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keywordtype">float</span> h4 = .5f * h2 * dxBz;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="comment">// float H0[5] = { 1,0, h2,  0, h4 };</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="comment">// float H1[5] = { 0, 1, 0, dS,  0 };</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="comment">// float H2[5] = { 0, 0, 1,  0, dxBz };</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="comment">// float H3[5] = { 0, 0, 0,  1,  0 };</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="comment">// float H4[5] = { 0, 0, 0,  0,  1 };</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="keywordtype">float</span> sinPhi = SinPhi() + dxBz * QPt();</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keywordflow">if</span> (maxSinPhi &gt; 0 &amp;&amp; <a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215">CAMath::Abs</a>(sinPhi) &gt; maxSinPhi) {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  }</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  SetX(<a class="code" href="../../d8/de9/qconfigoptions_8h.html#a77854b1fceea9fca2fa33736d20fae6a">X</a>() + dx);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  SetPar(0, GetPar(0) + dS * ey + h2 * (SinPhi() - ey) + h4 * QPt());</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  SetPar(1, GetPar(1) + dS * DzDs());</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  SetPar(2, sinPhi);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="keywordtype">float</span> c00 = mParam.mC[0];</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keywordtype">float</span> c10 = mParam.mC[1];</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keywordtype">float</span> c11 = mParam.mC[2];</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="keywordtype">float</span> c20 = mParam.mC[3];</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keywordtype">float</span> c21 = mParam.mC[4];</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keywordtype">float</span> c22 = mParam.mC[5];</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keywordtype">float</span> c30 = mParam.mC[6];</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keywordtype">float</span> c31 = mParam.mC[7];</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keywordtype">float</span> c32 = mParam.mC[8];</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="keywordtype">float</span> c33 = mParam.mC[9];</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keywordtype">float</span> c40 = mParam.mC[10];</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordtype">float</span> c41 = mParam.mC[11];</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keywordtype">float</span> c42 = mParam.mC[12];</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keywordtype">float</span> c43 = mParam.mC[13];</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keywordtype">float</span> c44 = mParam.mC[14];</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="comment">// This is not the correct propagation!!! The max ensures the positional error does not decrease during track finding.</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="comment">// A different propagation method is used for the fit.</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  mParam.mC[0] = CAMath::Max(c00, c00 + h2 * h2 * c22 + h4 * h4 * c44 + 2 * (h2 * c20 + h4 * c40 + h2 * h4 * c42));</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  mParam.mC[1] = c10 + h2 * c21 + h4 * c41 + dS * (c30 + h2 * c32 + h4 * c43);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  mParam.mC[2] = CAMath::Max(c11, c11 + 2 * dS * c31 + dS * dS * c33);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  mParam.mC[3] = c20 + h2 * c22 + h4 * c42 + dxBz * (c40 + h2 * c42 + h4 * c44);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  mParam.mC[4] = c21 + dS * c32 + dxBz * (c41 + dS * c43);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  mParam.mC[5] = c22 + 2 * dxBz * c42 + dxBz * dxBz * c44;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  mParam.mC[6] = c30 + h2 * c32 + h4 * c43;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  mParam.mC[7] = c31 + dS * c33;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  mParam.mC[8] = c32 + dxBz * c43;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  mParam.mC[9] = c33;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  mParam.mC[10] = c40 + h2 * c42 + h4 * c44;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  mParam.mC[11] = c41 + dS * c43;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  mParam.mC[12] = c42 + dxBz * c44;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  mParam.mC[13] = c43;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  mParam.mC[14] = c44;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;}</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#aed5cddc2b3dcfd3fee827ae94a244699">MEM_CLASS_PRE</a>()</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<a class="code" href="../../d8/dde/namespaceGPUCA__NAMESPACE_1_1gpu.html#a93fe70d5398168e15a525612430670c0">GPUd</a>() <span class="keywordtype">bool</span> <a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#ab4bab4f5ae1444c8f9a44b1ece558215">MEM_LG</a>(<a class="code" href="../../d2/dc0/classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackParam.html">GPUTPCTrackParam</a>)::TransportToX(<span class="keywordtype">float</span> x, <span class="keywordtype">float</span> Bz, <span class="keywordtype">float</span> maxSinPhi)</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;{</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="comment">//* Transport the track parameters to X=x</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <a class="code" href="../../df/de6/classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackLinearisation.html">GPUTPCTrackLinearisation</a> <a class="code" href="../../dc/da3/glcorearb_8h.html#abf0ea7853561a9028dbbc4caeb2f8ff1">t0</a>(*<span class="keyword">this</span>);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="keywordflow">return</span> TransportToX(x, t0, Bz, maxSinPhi);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;}</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#aed5cddc2b3dcfd3fee827ae94a244699">MEM_CLASS_PRE</a>()</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<a class="code" href="../../d8/dde/namespaceGPUCA__NAMESPACE_1_1gpu.html#a93fe70d5398168e15a525612430670c0">GPUd</a>() <span class="keywordtype">bool</span> <a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#ab4bab4f5ae1444c8f9a44b1ece558215">MEM_LG</a>(<a class="code" href="../../d2/dc0/classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackParam.html">GPUTPCTrackParam</a>)::TransportToXWithMaterial(<span class="keywordtype">float</span> x, <a class="code" href="../../df/de6/classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackLinearisation.html">GPUTPCTrackLinearisation</a>&amp; <a class="code" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() <a class="code" href="../../dc/da3/glcorearb_8h.html#abf0ea7853561a9028dbbc4caeb2f8ff1">t0</a>, GPUTPCTrackFitParam&amp; <a class="code" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() par, <span class="keywordtype">float</span> Bz, <span class="keywordtype">float</span> maxSinPhi)</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;{</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="comment">//* Transport the track parameters to X=x  taking into account material budget</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="keyword">static</span> constexpr <span class="keywordtype">float</span> kRho = 1.025e-3<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a>;   <span class="comment">// [g/cm^3]</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keyword">static</span> constexpr <span class="keywordtype">float</span> kRadLen = 28811.7f; <span class="comment">//[cm]</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="keyword">static</span> constexpr <span class="keywordtype">float</span> kRadLenInv = 1. / kRadLen;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordtype">float</span> dl;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keywordflow">if</span> (!TransportToX(x, <a class="code" href="../../dc/da3/glcorearb_8h.html#abf0ea7853561a9028dbbc4caeb2f8ff1">t0</a>, Bz, maxSinPhi, &amp;dl)) {</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  }</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  CorrectForMeanMaterial(dl * kRadLenInv, dl * kRho, par);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;}</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#aed5cddc2b3dcfd3fee827ae94a244699">MEM_CLASS_PRE</a>()</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<a class="code" href="../../d8/dde/namespaceGPUCA__NAMESPACE_1_1gpu.html#a93fe70d5398168e15a525612430670c0">GPUd</a>() <span class="keywordtype">bool</span> <a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#ab4bab4f5ae1444c8f9a44b1ece558215">MEM_LG</a>(<a class="code" href="../../d2/dc0/classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackParam.html">GPUTPCTrackParam</a>)::TransportToXWithMaterial(<span class="keywordtype">float</span> x, GPUTPCTrackFitParam&amp; <a class="code" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() par, <span class="keywordtype">float</span> Bz, <span class="keywordtype">float</span> maxSinPhi)</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;{</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="comment">//* Transport the track parameters to X=x  taking into account material budget</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <a class="code" href="../../df/de6/classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackLinearisation.html">GPUTPCTrackLinearisation</a> <a class="code" href="../../dc/da3/glcorearb_8h.html#abf0ea7853561a9028dbbc4caeb2f8ff1">t0</a>(*<span class="keyword">this</span>);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="keywordflow">return</span> TransportToXWithMaterial(x, t0, par, Bz, maxSinPhi);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;}</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#aed5cddc2b3dcfd3fee827ae94a244699">MEM_CLASS_PRE</a>()</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<a class="code" href="../../d8/dde/namespaceGPUCA__NAMESPACE_1_1gpu.html#a93fe70d5398168e15a525612430670c0">GPUd</a>() <span class="keywordtype">bool</span> <a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#ab4bab4f5ae1444c8f9a44b1ece558215">MEM_LG</a>(<a class="code" href="../../d2/dc0/classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackParam.html">GPUTPCTrackParam</a>)::TransportToXWithMaterial(<span class="keywordtype">float</span> x, <span class="keywordtype">float</span> Bz, <span class="keywordtype">float</span> maxSinPhi)</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;{</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="comment">//* Transport the track parameters to X=x taking into account material budget</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  GPUTPCTrackFitParam par;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  CalculateFitParameters(par);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="keywordflow">return</span> TransportToXWithMaterial(x, par, Bz, maxSinPhi);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;}</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">//*</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">//*  Multiple scattering and energy losses</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">//*</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#aed5cddc2b3dcfd3fee827ae94a244699">MEM_CLASS_PRE</a>()</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<a class="code" href="../../d8/dde/namespaceGPUCA__NAMESPACE_1_1gpu.html#a93fe70d5398168e15a525612430670c0">GPUd</a>() <span class="keywordtype">float</span> <a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#ab4bab4f5ae1444c8f9a44b1ece558215">MEM_LG</a>(<a class="code" href="../../d2/dc0/classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackParam.html">GPUTPCTrackParam</a>)::BetheBlochGeant(<span class="keywordtype">float</span> bg2, <span class="keywordtype">float</span> kp0, <span class="keywordtype">float</span> kp1, <span class="keywordtype">float</span> kp2, <span class="keywordtype">float</span> kp3, <span class="keywordtype">float</span> kp4)</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;{</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="comment">// This is the parameterization of the Bethe-Bloch formula inspired by Geant.</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="comment">// bg2  - (beta*gamma)^2</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="comment">// kp0 - density [g/cm^3]</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="comment">// kp1 - density effect first junction point</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="comment">// kp2 - density effect second junction point</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="comment">// kp3 - mean excitation energy [GeV]</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="comment">// kp4 - mean Z/A</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="comment">// The default values for the kp* parameters are for silicon.</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="comment">// The returned value is in [GeV/(g/cm^2)].</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> mK = 0.307075e-3<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a>; <span class="comment">// [GeV*cm^2/g]</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> me = 0.511e-3<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a>;    <span class="comment">// [GeV/c^2]</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> rho = kp0;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a98ac434677655cc8438bb72de2719f39">x0</a> = kp1 * 2.303f;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a49825216c96caaeb09237b36651181c5">x1</a> = kp2 * 2.303f;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> mI = kp3;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> mZA = kp4;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> maxT = 2 * me * bg2; <span class="comment">// neglecting the electron mass</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="comment">//*** Density effect</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="keywordtype">float</span> d2 = 0.f;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> x = 0.5f * <a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739ae557705aebad579817e10aa4fdcfaa00">CAMath::Log</a>(bg2);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> lhwI = <a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739ae557705aebad579817e10aa4fdcfaa00">CAMath::Log</a>(28.816<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a> * 1<a class="code" href="../../d8/de9/qconfigoptions_8h.html#acc2760558000045ec0803d60d4d01c98">e</a>-9<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a> * CAMath::Sqrt(rho * mZA) / mI);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="keywordflow">if</span> (x &gt; x1) {</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    d2 = lhwI + x - 0.5f;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (x &gt; x0) {</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#abe08814c2f72843fde4d8df41440d5a0">r</a> = (x1 - <a class="code" href="../../dc/da3/glcorearb_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a>) / (x1 - x0);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    d2 = lhwI + x - 0.5f + (0.5f - lhwI - <a class="code" href="../../dc/da3/glcorearb_8h.html#a98ac434677655cc8438bb72de2719f39">x0</a>) * r * r * r;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  }</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="keywordflow">return</span> mK * mZA * (1 + bg2) / bg2 * (0.5<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a> * <a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739ae557705aebad579817e10aa4fdcfaa00">CAMath::Log</a>(2 * me * bg2 * maxT / (mI * mI)) - bg2 / (1 + bg2) - d2);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;}</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#aed5cddc2b3dcfd3fee827ae94a244699">MEM_CLASS_PRE</a>()</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<a class="code" href="../../d8/dde/namespaceGPUCA__NAMESPACE_1_1gpu.html#a93fe70d5398168e15a525612430670c0">GPUd</a>() <span class="keywordtype">float</span> <a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#ab4bab4f5ae1444c8f9a44b1ece558215">MEM_LG</a>(<a class="code" href="../../d2/dc0/classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackParam.html">GPUTPCTrackParam</a>)::<a class="code" href="../../d1/dec/namespaceo2_1_1track.html#ab380cc4c4b60c0cf7e812cacc343abd3">BetheBlochSolid</a>(<span class="keywordtype">float</span> bg)</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;{</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="comment">//------------------------------------------------------------------</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="comment">// This is an approximation of the Bethe-Bloch formula,</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="comment">// reasonable for solid materials.</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="comment">// All the parameters are, in fact, for Si.</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="comment">// The returned value is in [GeV]</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="comment">//------------------------------------------------------------------</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="keywordflow">return</span> BetheBlochGeant(bg);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;}</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#aed5cddc2b3dcfd3fee827ae94a244699">MEM_CLASS_PRE</a>()</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<a class="code" href="../../d8/dde/namespaceGPUCA__NAMESPACE_1_1gpu.html#a93fe70d5398168e15a525612430670c0">GPUd</a>() <span class="keywordtype">float</span> <a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#ab4bab4f5ae1444c8f9a44b1ece558215">MEM_LG</a>(<a class="code" href="../../d2/dc0/classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackParam.html">GPUTPCTrackParam</a>)::BetheBlochGas(<span class="keywordtype">float</span> bg)</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;{</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="comment">//------------------------------------------------------------------</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="comment">// This is an approximation of the Bethe-Bloch formula,</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="comment">// reasonable for gas materials.</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="comment">// All the parameters are, in fact, for Ne.</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="comment">// The returned value is in [GeV]</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="comment">//------------------------------------------------------------------</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> rho = 0.9e-3<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a>;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a98ac434677655cc8438bb72de2719f39">x0</a> = 2.f;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a49825216c96caaeb09237b36651181c5">x1</a> = 4.f;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> mI = 140.e-9<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a>;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> mZA = 0.49555f;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordflow">return</span> BetheBlochGeant(bg, rho, x0, x1, mI, mZA);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;}</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#aed5cddc2b3dcfd3fee827ae94a244699">MEM_CLASS_PRE</a>()</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<a class="code" href="../../d8/dde/namespaceGPUCA__NAMESPACE_1_1gpu.html#a93fe70d5398168e15a525612430670c0">GPUd</a>() <span class="keywordtype">float</span> <a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#ab4bab4f5ae1444c8f9a44b1ece558215">MEM_LG</a>(<a class="code" href="../../d2/dc0/classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackParam.html">GPUTPCTrackParam</a>)::ApproximateBetheBloch(<span class="keywordtype">float</span> beta2)</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;{</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="comment">//------------------------------------------------------------------</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="comment">// This is an approximation of the Bethe-Bloch formula with</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="comment">// the density effect taken into account at beta*gamma &gt; 3.5</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="comment">// (the approximation is reasonable only for solid materials)</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="comment">//------------------------------------------------------------------</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="keywordflow">if</span> (beta2 &gt;= 1) {</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  }</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="keywordflow">if</span> (beta2 / (1 - beta2) &gt; 3.5<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a> * 3.5<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a>) {</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">return</span> 0.153e-3f / beta2 * (log(3.5f * 5940) + 0.5f * log(beta2 / (1 - beta2)) - beta2);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  }</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="keywordflow">return</span> 0.153e-3f / beta2 * (log(5940 * beta2 / (1 - beta2)) - beta2);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;}</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#aed5cddc2b3dcfd3fee827ae94a244699">MEM_CLASS_PRE</a>()</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<a class="code" href="../../d8/dde/namespaceGPUCA__NAMESPACE_1_1gpu.html#a93fe70d5398168e15a525612430670c0">GPUd</a>() <span class="keywordtype">void</span> <a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#ab4bab4f5ae1444c8f9a44b1ece558215">MEM_LG</a>(<a class="code" href="../../d2/dc0/classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackParam.html">GPUTPCTrackParam</a>)::CalculateFitParameters(GPUTPCTrackFitParam&amp; par, <span class="keywordtype">float</span> mass)</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;{</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="comment">//*!</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="keywordtype">float</span> <a class="code" href="../../d8/de9/qconfigoptions_8h.html#aea939160667cc03fe767732bf705f1d4">qpt</a> = GetPar(4);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <span class="keywordflow">if</span> (mParam.mC[14] &gt;= 1.f) {</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    qpt = 1.f / 0.35f;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  }</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordtype">float</span> <a class="code" href="../../d2/d26/namespaceo2_1_1mch_1_1raw.html#a859cecde6a68c7d7355a79c71e593895">p2</a> = (1.f + GetPar(3) * GetPar(3));</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="keywordtype">float</span> k2 = qpt * <a class="code" href="../../d8/de9/qconfigoptions_8h.html#aea939160667cc03fe767732bf705f1d4">qpt</a>;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="keywordtype">float</span> mass2 = mass * mass;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="keywordtype">float</span> beta2 = p2 / (p2 + mass2 * k2);</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="keywordtype">float</span> pp2 = (k2 &gt; 1.e-8<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a>) ? p2 / k2 : 10000; <span class="comment">// impuls 2</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="comment">// par.bethe = BetheBlochGas( pp2/mass2);</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  par.bethe = ApproximateBetheBloch(pp2 / mass2);</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  par.e = CAMath::Sqrt(pp2 + mass2);</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  par.theta2 = 14.1f * 14.1f / (beta2 * pp2 * 1e6f);</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  par.EP2 = par.e / pp2;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="comment">// Approximate energy loss fluctuation (M.Ivanov)</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> knst = 0.07f; <span class="comment">// To be tuned.</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  par.sigmadE2 = knst * par.EP2 * <a class="code" href="../../d8/de9/qconfigoptions_8h.html#aea939160667cc03fe767732bf705f1d4">qpt</a>;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  par.sigmadE2 = par.sigmadE2 * par.sigmadE2;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  par.k22 = (1.f + GetPar(3) * GetPar(3));</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  par.k33 = par.k22 * par.k22;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  par.k43 = 0;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  par.k44 = GetPar(3) * GetPar(3) * k2;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;}</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#aed5cddc2b3dcfd3fee827ae94a244699">MEM_CLASS_PRE</a>()</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<a class="code" href="../../d8/dde/namespaceGPUCA__NAMESPACE_1_1gpu.html#a93fe70d5398168e15a525612430670c0">GPUd</a>() <span class="keywordtype">bool</span> <a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#ab4bab4f5ae1444c8f9a44b1ece558215">MEM_LG</a>(<a class="code" href="../../d2/dc0/classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackParam.html">GPUTPCTrackParam</a>)::CorrectForMeanMaterial(<span class="keywordtype">float</span> xOverX0, <span class="keywordtype">float</span> xTimesRho, <span class="keyword">const</span> GPUTPCTrackFitParam&amp; par)</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;{</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="comment">//------------------------------------------------------------------</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="comment">// This function corrects the track parameters for the crossed material.</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="comment">// &quot;xOverX0&quot;   - X/X0, the thickness in units of the radiation length.</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="comment">// &quot;xTimesRho&quot; - is the product length*density (g/cm^2).</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="comment">//------------------------------------------------------------------</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="keywordtype">float</span>&amp; mC22 = mParam.mC[5];</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="keywordtype">float</span>&amp; mC33 = mParam.mC[9];</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="keywordtype">float</span>&amp; mC40 = mParam.mC[10];</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="keywordtype">float</span>&amp; mC41 = mParam.mC[11];</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="keywordtype">float</span>&amp; mC42 = mParam.mC[12];</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="keywordtype">float</span>&amp; mC43 = mParam.mC[13];</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="keywordtype">float</span>&amp; mC44 = mParam.mC[14];</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="comment">// Energy losses************************</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="keywordtype">float</span> dE = par.bethe * xTimesRho;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215">CAMath::Abs</a>(dE) &gt; 0.3<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a> * par.e) {</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">return</span> 0; <span class="comment">// 30% energy loss is too much!</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  }</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="keywordtype">float</span> corr = (1.f - par.EP2 * dE);</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="keywordflow">if</span> (corr &lt; 0.3f || corr &gt; 1.3<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a>) {</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  }</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  SetPar(4, GetPar(4) * corr);</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  mC40 *= corr;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  mC41 *= corr;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  mC42 *= corr;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  mC43 *= corr;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  mC44 *= corr * corr;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  mC44 += par.sigmadE2 * <a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215">CAMath::Abs</a>(dE);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="comment">// Multiple scattering******************</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="keywordtype">float</span> theta2 = par.theta2 * <a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215">CAMath::Abs</a>(xOverX0);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  mC22 += theta2 * par.k22 * (1.f - GetPar(2)) * (1.f + GetPar(2));</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  mC33 += theta2 * par.k33;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  mC43 += theta2 * par.k43;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  mC44 += theta2 * par.k44;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;}</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">//*</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">//* Rotation</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">//*</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#aed5cddc2b3dcfd3fee827ae94a244699">MEM_CLASS_PRE</a>()</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<a class="code" href="../../d8/dde/namespaceGPUCA__NAMESPACE_1_1gpu.html#a93fe70d5398168e15a525612430670c0">GPUd</a>() <span class="keywordtype">bool</span> <a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#ab4bab4f5ae1444c8f9a44b1ece558215">MEM_LG</a>(<a class="code" href="../../d2/dc0/classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackParam.html">GPUTPCTrackParam</a>)::Rotate(<span class="keywordtype">float</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a090ebe65994a3ee4bb60ae3472abffc5">alpha</a>, <span class="keywordtype">float</span> maxSinPhi)</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;{</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="comment">//* Rotate the coordinate system in XY on the angle alpha</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="keywordtype">float</span> cA = CAMath::Cos(alpha);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="keywordtype">float</span> sA = CAMath::Sin(alpha);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="keywordtype">float</span> x = <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a77854b1fceea9fca2fa33736d20fae6a">X</a>(), y = Y(), sP = SinPhi(), cP = GetCosPhi();</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="keywordtype">float</span> cosPhi = cP * cA + sP * sA;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="keywordtype">float</span> sinPhi = -cP * sA + sP * cA;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215">CAMath::Abs</a>(sinPhi) &gt; maxSinPhi || <a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215">CAMath::Abs</a>(cosPhi) &lt; 1.<a class="code" href="../../d8/de9/qconfigoptions_8h.html#acc2760558000045ec0803d60d4d01c98">e</a>-2<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a> || <a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215">CAMath::Abs</a>(cP) &lt; 1.<a class="code" href="../../d8/de9/qconfigoptions_8h.html#acc2760558000045ec0803d60d4d01c98">e</a>-2<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a>) {</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  }</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  <span class="keywordtype">float</span> j0 = cP / cosPhi;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="keywordtype">float</span> j2 = cosPhi / cP;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  SetX(x * cA + y * sA);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  SetY(-x * sA + y * cA);</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  SetSignCosPhi(cosPhi);</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  SetSinPhi(sinPhi);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="comment">// float J[5][5] = { { j0, 0, 0,  0,  0 }, // Y</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <span class="comment">//                      {  0, 1, 0,  0,  0 }, // Z</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="comment">//                      {  0, 0, j2, 0,  0 }, // SinPhi</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="comment">//                    {  0, 0, 0,  1,  0 }, // DzDs</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="comment">//                    {  0, 0, 0,  0,  1 } }; // Kappa</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="comment">// cout&lt;&lt;&quot;alpha=&quot;&lt;&lt;alpha&lt;&lt;&quot; &quot;&lt;&lt;x&lt;&lt;&quot; &quot;&lt;&lt;y&lt;&lt;&quot; &quot;&lt;&lt;sP&lt;&lt;&quot; &quot;&lt;&lt;cP&lt;&lt;&quot; &quot;&lt;&lt;j0&lt;&lt;&quot; &quot;&lt;&lt;j2&lt;&lt;endl;</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  <span class="comment">// cout&lt;&lt;&quot;      &quot;&lt;&lt;mParam.mC[0]&lt;&lt;&quot; &quot;&lt;&lt;mParam.mC[1]&lt;&lt;&quot; &quot;&lt;&lt;mParam.mC[6]&lt;&lt;&quot; &quot;&lt;&lt;mParam.mC[10]&lt;&lt;&quot; &quot;&lt;&lt;mParam.mC[4]&lt;&lt;&quot; &quot;&lt;&lt;mParam.mC[5]&lt;&lt;&quot; &quot;&lt;&lt;mParam.mC[8]&lt;&lt;&quot; &quot;&lt;&lt;mParam.mC[12]&lt;&lt;endl;</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  mParam.mC[0] *= j0 * j0;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  mParam.mC[1] *= j0;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  mParam.mC[3] *= j0;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  mParam.mC[6] *= j0;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  mParam.mC[10] *= j0;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  mParam.mC[3] *= j2;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  mParam.mC[4] *= j2;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  mParam.mC[5] *= j2 * j2;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  mParam.mC[8] *= j2;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  mParam.mC[12] *= j2;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="keywordflow">if</span> (cosPhi &lt; 0) {</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    SetSinPhi(-SinPhi());</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    SetDzDs(-DzDs());</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    SetQPt(-QPt());</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    mParam.mC[3] = -mParam.mC[3];</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    mParam.mC[4] = -mParam.mC[4];</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    mParam.mC[6] = -mParam.mC[6];</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    mParam.mC[7] = -mParam.mC[7];</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    mParam.mC[10] = -mParam.mC[10];</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    mParam.mC[11] = -mParam.mC[11];</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  }</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="comment">// cout&lt;&lt;&quot;      &quot;&lt;&lt;mParam.mC[0]&lt;&lt;&quot; &quot;&lt;&lt;mParam.mC[1]&lt;&lt;&quot; &quot;&lt;&lt;mParam.mC[6]&lt;&lt;&quot; &quot;&lt;&lt;mParam.mC[10]&lt;&lt;&quot; &quot;&lt;&lt;mParam.mC[4]&lt;&lt;&quot; &quot;&lt;&lt;mParam.mC[5]&lt;&lt;&quot; &quot;&lt;&lt;mParam.mC[8]&lt;&lt;&quot; &quot;&lt;&lt;mParam.mC[12]&lt;&lt;endl;</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;}</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#aed5cddc2b3dcfd3fee827ae94a244699">MEM_CLASS_PRE</a>()</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<a class="code" href="../../d8/dde/namespaceGPUCA__NAMESPACE_1_1gpu.html#a93fe70d5398168e15a525612430670c0">GPUd</a>() <span class="keywordtype">bool</span> <a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#ab4bab4f5ae1444c8f9a44b1ece558215">MEM_LG</a>(<a class="code" href="../../d2/dc0/classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackParam.html">GPUTPCTrackParam</a>)::Rotate(<span class="keywordtype">float</span> alpha, <a class="code" href="../../df/de6/classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackLinearisation.html">GPUTPCTrackLinearisation</a>&amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#abf0ea7853561a9028dbbc4caeb2f8ff1">t0</a>, <span class="keywordtype">float</span> maxSinPhi)</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;{</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <span class="comment">//* Rotate the coordinate system in XY on the angle alpha</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <span class="keywordtype">float</span> cA = CAMath::Cos(alpha);</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <span class="keywordtype">float</span> sA = CAMath::Sin(alpha);</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="keywordtype">float</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a98ac434677655cc8438bb72de2719f39">x0</a> = <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a77854b1fceea9fca2fa33736d20fae6a">X</a>(), <a class="code" href="../../dc/da3/glcorearb_8h.html#ae7f97ed6c9c8e502fcbc44c7cb8a8312">y0</a> = Y(), sP = t0.SinPhi(), cP = t0.CosPhi();</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="keywordtype">float</span> cosPhi = cP * cA + sP * sA;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="keywordtype">float</span> sinPhi = -cP * sA + sP * cA;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215">CAMath::Abs</a>(sinPhi) &gt; maxSinPhi || <a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215">CAMath::Abs</a>(cosPhi) &lt; 1.<a class="code" href="../../d8/de9/qconfigoptions_8h.html#acc2760558000045ec0803d60d4d01c98">e</a>-2<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a> || <a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215">CAMath::Abs</a>(cP) &lt; 1.<a class="code" href="../../d8/de9/qconfigoptions_8h.html#acc2760558000045ec0803d60d4d01c98">e</a>-2<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a>) {</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  }</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <span class="comment">// float J[5][5] = { { j0, 0, 0,  0,  0 }, // Y</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <span class="comment">//                    {  0, 1, 0,  0,  0 }, // Z</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="comment">//                    {  0, 0, j2, 0,  0 }, // SinPhi</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="comment">//                  {  0, 0, 0,  1,  0 }, // DzDs</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="comment">//                  {  0, 0, 0,  0,  1 } }; // Kappa</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="keywordtype">float</span> j0 = cP / cosPhi;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="keywordtype">float</span> j2 = cosPhi / cP;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  <span class="keywordtype">float</span> <a class="code" href="../../d8/de9/qconfigoptions_8h.html#aa614ae9e8ec8f5346ac88d0be625fa22">d</a>[2] = {Y() - <a class="code" href="../../dc/da3/glcorearb_8h.html#ae7f97ed6c9c8e502fcbc44c7cb8a8312">y0</a>, SinPhi() - sP};</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  SetX(x0 * cA + <a class="code" href="../../dc/da3/glcorearb_8h.html#ae7f97ed6c9c8e502fcbc44c7cb8a8312">y0</a> * sA);</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  SetY(-x0 * sA + <a class="code" href="../../dc/da3/glcorearb_8h.html#ae7f97ed6c9c8e502fcbc44c7cb8a8312">y0</a> * cA + j0 * d[0]);</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  t0.SetCosPhi(cosPhi);</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  t0.SetSinPhi(sinPhi);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  SetSinPhi(sinPhi + j2 * d[1]);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  mParam.mC[0] *= j0 * j0;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  mParam.mC[1] *= j0;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  mParam.mC[3] *= j0;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  mParam.mC[6] *= j0;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  mParam.mC[10] *= j0;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  mParam.mC[3] *= j2;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  mParam.mC[4] *= j2;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  mParam.mC[5] *= j2 * j2;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  mParam.mC[8] *= j2;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  mParam.mC[12] *= j2;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;}</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#aed5cddc2b3dcfd3fee827ae94a244699">MEM_CLASS_PRE</a>()</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<a class="code" href="../../d8/dde/namespaceGPUCA__NAMESPACE_1_1gpu.html#a93fe70d5398168e15a525612430670c0">GPUd</a>() <span class="keywordtype">bool</span> <a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#ab4bab4f5ae1444c8f9a44b1ece558215">MEM_LG</a>(<a class="code" href="../../d2/dc0/classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackParam.html">GPUTPCTrackParam</a>)::Filter(<span class="keywordtype">float</span> y, <span class="keywordtype">float</span> z, <span class="keywordtype">float</span> err2Y, <span class="keywordtype">float</span> err2Z, <span class="keywordtype">float</span> maxSinPhi, <span class="keywordtype">bool</span> paramOnly)</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;{</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <span class="comment">//* Add the y,z measurement with the Kalman filter</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <span class="keywordtype">float</span> c00 = mParam.mC[0], c11 = mParam.mC[2], c20 = mParam.mC[3], c31 = mParam.mC[7], c40 = mParam.mC[10];</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  err2Y += c00;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  err2Z += c11;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <span class="keywordtype">float</span> z0 = y - GetPar(0), <a class="code" href="../../d2/dc1/namespaceo2_1_1its_1_1math__utils.html#ac713be41b5cad67abc4e4d0581961905">z1</a> = z - GetPar(1);</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="keywordflow">if</span> (err2Y &lt; 1.<a class="code" href="../../d8/de9/qconfigoptions_8h.html#acc2760558000045ec0803d60d4d01c98">e</a>-8<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a> || err2Z &lt; 1.<a class="code" href="../../d8/de9/qconfigoptions_8h.html#acc2760558000045ec0803d60d4d01c98">e</a>-8<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a>) {</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  }</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <span class="keywordtype">float</span> mS0 = 1.f / err2Y;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <span class="keywordtype">float</span> mS2 = 1.f / err2Z;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <span class="comment">// K = CHtS</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="keywordtype">float</span> k00, k11, k20, k31, k40;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  k00 = c00 * mS0;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  k20 = c20 * mS0;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  k40 = c40 * mS0;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  k11 = c11 * mS2;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  k31 = c31 * mS2;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  <span class="keywordtype">float</span> sinPhi = GetPar(2) + k20 * z0;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="keywordflow">if</span> (maxSinPhi &gt; 0 &amp;&amp; <a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215">CAMath::Abs</a>(sinPhi) &gt;= maxSinPhi) {</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  }</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  SetPar(0, GetPar(0) + k00 * z0);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  SetPar(1, GetPar(1) + k11 * z1);</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  SetPar(2, sinPhi);</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  SetPar(3, GetPar(3) + k31 * z1);</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  SetPar(4, GetPar(4) + k40 * z0);</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <span class="keywordflow">if</span> (paramOnly) {</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  }</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  mNDF += 2;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  mChi2 += mS0 * z0 * z0 + mS2 * z1 * <a class="code" href="../../d2/dc1/namespaceo2_1_1its_1_1math__utils.html#ac713be41b5cad67abc4e4d0581961905">z1</a>;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  mParam.mC[0] -= k00 * c00;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  mParam.mC[3] -= k20 * c00;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  mParam.mC[5] -= k20 * c20;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  mParam.mC[10] -= k40 * c00;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  mParam.mC[12] -= k40 * c20;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  mParam.mC[14] -= k40 * c40;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  mParam.mC[2] -= k11 * c11;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  mParam.mC[7] -= k31 * c11;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  mParam.mC[9] -= k31 * c31;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;}</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#aed5cddc2b3dcfd3fee827ae94a244699">MEM_CLASS_PRE</a>()</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<a class="code" href="../../d8/dde/namespaceGPUCA__NAMESPACE_1_1gpu.html#a93fe70d5398168e15a525612430670c0">GPUd</a>() <span class="keywordtype">bool</span> <a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#ab4bab4f5ae1444c8f9a44b1ece558215">MEM_LG</a>(<a class="code" href="../../d2/dc0/classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackParam.html">GPUTPCTrackParam</a>)::CheckNumericalQuality()<span class="keyword"> const</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  <span class="comment">//* Check that the track parameters and covariance matrix are reasonable</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <span class="keywordtype">bool</span> ok = CAMath::Finite(GetX()) &amp;&amp; CAMath::Finite(mSignCosPhi) &amp;&amp; CAMath::Finite(mChi2);</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span>* c = Cov();</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 15; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    ok = ok &amp;&amp; CAMath::Finite(c[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  }</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 5; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    ok = ok &amp;&amp; CAMath::Finite(Par()[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  }</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  <span class="keywordflow">if</span> (c[0] &lt;= 0 || c[2] &lt;= 0 || c[5] &lt;= 0 || c[9] &lt;= 0 || c[14] &lt;= 0) {</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    ok = 0;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  }</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <span class="keywordflow">if</span> (c[0] &gt; 5.<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a> || c[2] &gt; 5.<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a> || c[5] &gt; 2.<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a> || c[9] &gt; 2</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      <span class="comment">//|| ( CAMath::Abs( QPt() ) &gt; 1.e-2 &amp;&amp; c[14] &gt; 2. )</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  ) {</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    ok = 0;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  }</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215">CAMath::Abs</a>(SinPhi()) &gt; <a class="code" href="../../d2/d37/GPUDefConstantsAndSettings_8h.html#aedc77e1cb7b30e9a388720ee3493c36c">GPUCA_MAX_SIN_PHI</a>) {</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    ok = 0;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  }</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215">CAMath::Abs</a>(QPt()) &gt; 1.<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a> / 0.05<a class="code" href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a>) {</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    ok = 0;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  }</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  <span class="keywordflow">if</span> (ok) {</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    ok = ok &amp;&amp; (c[1] * c[1] &lt;= c[2] * c[0]) &amp;&amp; (c[3] * c[3] &lt;= c[5] * c[0]) &amp;&amp; (c[4] * c[4] &lt;= c[5] * c[2]) &amp;&amp; (c[6] * c[6] &lt;= c[9] * c[0]) &amp;&amp; (c[7] * c[7] &lt;= c[9] * c[2]) &amp;&amp; (c[8] * c[8] &lt;= c[9] * c[5]) &amp;&amp; (c[10] * c[10] &lt;= c[14] * c[0]) &amp;&amp; (c[11] * c[11] &lt;= c[14] * c[2]) &amp;&amp;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;         (c[12] * c[12] &lt;= c[14] * c[5]) &amp;&amp; (c[13] * c[13] &lt;= c[14] * c[9]);</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  }</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="keywordflow">return</span> ok;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;}</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="preprocessor">#if !defined(GPUCA_GPUCODE)</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#aed5cddc2b3dcfd3fee827ae94a244699">MEM_CLASS_PRE</a>()</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<a class="code" href="../../d8/dde/namespaceGPUCA__NAMESPACE_1_1gpu.html#a93fe70d5398168e15a525612430670c0">GPUd</a>() <span class="keywordtype">void</span> <a class="code" href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#ab4bab4f5ae1444c8f9a44b1ece558215">MEM_LG</a>(<a class="code" href="../../d2/dc0/classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackParam.html">GPUTPCTrackParam</a>)::Print()<span class="keyword"> const</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <span class="comment">//* print parameters</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="preprocessor">#if !defined(GPUCA_GPUCODE)</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;track: x=&quot;</span> &lt;&lt; GetX() &lt;&lt; <span class="stringliteral">&quot; c=&quot;</span> &lt;&lt; GetSignCosPhi() &lt;&lt; <span class="stringliteral">&quot;, P= &quot;</span> &lt;&lt; GetY() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; GetZ() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; GetSinPhi() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; GetDzDs() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; GetQPt() &lt;&lt; std::endl;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;errs2: &quot;</span> &lt;&lt; Err2Y() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; Err2Z() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; Err2SinPhi() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; Err2DzDs() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; Err2QPt() &lt;&lt; std::endl;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;}</div><div class="ttc" id="glcorearb_8h_html_abf0ea7853561a9028dbbc4caeb2f8ff1"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#abf0ea7853561a9028dbbc4caeb2f8ff1">t0</a></div><div class="ttdeci">GLuint GLfloat GLfloat GLfloat GLfloat GLfloat GLfloat GLfloat t0</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l05034">glcorearb.h:5034</a></div></div>
<div class="ttc" id="GPUDefOpenCL12Templates_8h_html_aed5cddc2b3dcfd3fee827ae94a244699"><div class="ttname"><a href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#aed5cddc2b3dcfd3fee827ae94a244699">MEM_CLASS_PRE</a></div><div class="ttdeci">#define MEM_CLASS_PRE()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d4c/GPUDefOpenCL12Templates_8h_source.html#l00059">GPUDefOpenCL12Templates.h:59</a></div></div>
<div class="ttc" id="GPUCommonDefAPI_8h_html_ac23bf29d429046b4c46c45fca80b546e"><div class="ttname"><a href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a></div><div class="ttdeci">#define GPUrestrict()</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d5a/GPUCommonDefAPI_8h_source.html#l00188">GPUCommonDefAPI.h:188</a></div></div>
<div class="ttc" id="classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackLinearisation_html"><div class="ttname"><a href="../../df/de6/classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackLinearisation.html">GPUCA_NAMESPACE::gpu::GPUTPCTrackLinearisation</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d52/GPUTPCTrackLinearisation_8h_source.html#l00037">GPUTPCTrackLinearisation.h:37</a></div></div>
<div class="ttc" id="glcorearb_8h_html_aee38b51639b577753f6a92029fb92000"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#aee38b51639b577753f6a92029fb92000">z</a></div><div class="ttdeci">GLdouble GLdouble GLdouble z</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00843">glcorearb.h:843</a></div></div>
<div class="ttc" id="qconfigoptions_8h_html_a2cdbb9508b46bd8f3a6039b702ebd16d"><div class="ttname"><a href="../../d8/de9/qconfigoptions_8h.html#a2cdbb9508b46bd8f3a6039b702ebd16d">t</a></div><div class="ttdeci">Visualize clusters only t</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/de9/qconfigoptions_8h_source.html#l00020">qconfigoptions.h:20</a></div></div>
<div class="ttc" id="glcorearb_8h_html_ac8729153468b5dcf13f971b21d84d4e5"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#ac8729153468b5dcf13f971b21d84d4e5">a</a></div><div class="ttdeci">GLboolean GLboolean GLboolean GLboolean a</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l01233">glcorearb.h:1233</a></div></div>
<div class="ttc" id="namespaceo2_1_1its_1_1constants_1_1math_html_ab8ae067bdc328b3dede71d13994af907"><div class="ttname"><a href="../../d3/df6/namespaceo2_1_1its_1_1constants_1_1math.html#ab8ae067bdc328b3dede71d13994af907">o2::its::constants::math::TwoPi</a></div><div class="ttdeci">constexpr float TwoPi</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d86/Detectors_2ITSMFT_2ITS_2tracking_2include_2ITStracking_2Constants_8h_source.html#l00038">Constants.h:38</a></div></div>
<div class="ttc" id="namespaceo2_1_1mch_1_1raw_html_a859cecde6a68c7d7355a79c71e593895"><div class="ttname"><a href="../../d2/d26/namespaceo2_1_1mch_1_1raw.html#a859cecde6a68c7d7355a79c71e593895">o2::mch::raw::p2</a></div><div class="ttdeci">std::array&lt; int, 23 &gt; p2</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d5b/SampaHeader_8cxx_source.html#l00480">SampaHeader.cxx:480</a></div></div>
<div class="ttc" id="GPUDefConstantsAndSettings_8h_html_aedc77e1cb7b30e9a388720ee3493c36c"><div class="ttname"><a href="../../d2/d37/GPUDefConstantsAndSettings_8h.html#aedc77e1cb7b30e9a388720ee3493c36c">GPUCA_MAX_SIN_PHI</a></div><div class="ttdeci">#define GPUCA_MAX_SIN_PHI</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d37/GPUDefConstantsAndSettings_8h_source.html#l00056">GPUDefConstantsAndSettings.h:56</a></div></div>
<div class="ttc" id="namespaceGPUCA__NAMESPACE_1_1gpu_html_a93fe70d5398168e15a525612430670c0"><div class="ttname"><a href="../../d8/dde/namespaceGPUCA__NAMESPACE_1_1gpu.html#a93fe70d5398168e15a525612430670c0">GPUCA_NAMESPACE::gpu::GPUd</a></div><div class="ttdeci">GPUd() MEM_CLASS_PRE2() inline GPUTPCTrackLinearisation</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d52/GPUTPCTrackLinearisation_8h_source.html#l00069">GPUTPCTrackLinearisation.h:69</a></div></div>
<div class="ttc" id="glcorearb_8h_html_ae7f97ed6c9c8e502fcbc44c7cb8a8312"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#ae7f97ed6c9c8e502fcbc44c7cb8a8312">y0</a></div><div class="ttdeci">GLuint GLfloat GLfloat y0</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l05034">glcorearb.h:5034</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a1fe2b9d716f80da76adb19505d583dc1"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a1fe2b9d716f80da76adb19505d583dc1">f</a></div><div class="ttdeci">GLdouble f</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00310">glcorearb.h:310</a></div></div>
<div class="ttc" id="qconfigoptions_8h_html_aa614ae9e8ec8f5346ac88d0be625fa22"><div class="ttname"><a href="../../d8/de9/qconfigoptions_8h.html#aa614ae9e8ec8f5346ac88d0be625fa22">d</a></div><div class="ttdeci">Run track merging Number of iterations to Number of iterations to Number of initial iterations excluded from const char Directory with events to Number of OMP threads to d</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/de9/qconfigoptions_8h_source.html#l00142">qconfigoptions.h:142</a></div></div>
<div class="ttc" id="qconfigoptions_8h_html_a77854b1fceea9fca2fa33736d20fae6a"><div class="ttname"><a href="../../d8/de9/qconfigoptions_8h.html#a77854b1fceea9fca2fa33736d20fae6a">X</a></div><div class="ttdeci">Visualize clusters only Timeframe settings Average distance in cm of events merged into Randomize distance around average distance of merged events Simulate correct bunch interactions instead of placing only the average number of events A value [n] sets TFlen for [n] collisions in Number of bunches per train Number of bunch trains Instantaneous interaction rate Do not simulate border Total number of collisions to be placed in the interior of all time Do not select random but walk over array of events in stride steps h QA settings const char Legend entries for data from comparison histogram files const char Store histograms in output root Do not run but just create PDFs from input root files Set cut for Q Compute the efficiency including impure tracks with fake contamination Maxmimum X(~radius) for reconstructed track position to take into accound for resolution QA in cm&quot;) AddOption(resPrimaries</div></div>
<div class="ttc" id="namespaceo2_1_1track_html_ab380cc4c4b60c0cf7e812cacc343abd3"><div class="ttname"><a href="../../d1/dec/namespaceo2_1_1track.html#ab380cc4c4b60c0cf7e812cacc343abd3">o2::track::BetheBlochSolid</a></div><div class="ttdeci">float BetheBlochSolid(float bg, float rho=2.33f, float kp1=0.20f, float kp2=3.00f, float meanI=173e-9f, float meanZA=0.49848f)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d18/DataFormats_2Reconstruction_2src_2Track_8cxx_source.html#l01598">Track.cxx:1598</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a090ebe65994a3ee4bb60ae3472abffc5"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a090ebe65994a3ee4bb60ae3472abffc5">alpha</a></div><div class="ttdeci">GLfloat GLfloat GLfloat alpha</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00279">glcorearb.h:279</a></div></div>
<div class="ttc" id="classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackParam_html"><div class="ttname"><a href="../../d2/dc0/classGPUCA__NAMESPACE_1_1gpu_1_1GPUTPCTrackParam.html">GPUCA_NAMESPACE::gpu::GPUTPCTrackParam</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d15/GPUTPCTrackParam_8h_source.html#l00035">GPUTPCTrackParam.h:35</a></div></div>
<div class="ttc" id="GPUTPCTrackParam_8h_html"><div class="ttname"><a href="../../de/d15/GPUTPCTrackParam_8h.html">GPUTPCTrackParam.h</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a98ac434677655cc8438bb72de2719f39"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a98ac434677655cc8438bb72de2719f39">x0</a></div><div class="ttdeci">GLuint GLfloat x0</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l05034">glcorearb.h:5034</a></div></div>
<div class="ttc" id="qconfigoptions_8h_html_acc2760558000045ec0803d60d4d01c98"><div class="ttname"><a href="../../d8/de9/qconfigoptions_8h.html#acc2760558000045ec0803d60d4d01c98">e</a></div><div class="ttdeci">Run track merging Number of iterations to Number of iterations to Number of initial iterations excluded from const char e</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/de9/qconfigoptions_8h_source.html#l00140">qconfigoptions.h:140</a></div></div>
<div class="ttc" id="GPUDefOpenCL12Templates_8h_html_ab4bab4f5ae1444c8f9a44b1ece558215"><div class="ttname"><a href="../../d3/d4c/GPUDefOpenCL12Templates_8h.html#ab4bab4f5ae1444c8f9a44b1ece558215">MEM_LG</a></div><div class="ttdeci">#define MEM_LG(type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d4c/GPUDefOpenCL12Templates_8h_source.html#l00061">GPUDefOpenCL12Templates.h:61</a></div></div>
<div class="ttc" id="namespaceo2_1_1framework_html_ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215"><div class="ttname"><a href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215">o2::framework::Abs</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dc2/BasicOps_8h_source.html#l00031">BasicOps.h:31</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a0cdec8e97a75ee9458b23d152bf962d4"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a></div><div class="ttdeci">GLint GLenum GLint x</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00403">glcorearb.h:403</a></div></div>
<div class="ttc" id="GPUTPCTrackLinearisation_8h_html"><div class="ttname"><a href="../../db/d52/GPUTPCTrackLinearisation_8h.html">GPUTPCTrackLinearisation.h</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a49825216c96caaeb09237b36651181c5"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a49825216c96caaeb09237b36651181c5">x1</a></div><div class="ttdeci">GLuint GLfloat GLfloat GLfloat x1</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l05034">glcorearb.h:5034</a></div></div>
<div class="ttc" id="namespaceGPUCA__NAMESPACE_1_1gpu_html"><div class="ttname"><a href="../../d8/dde/namespaceGPUCA__NAMESPACE_1_1gpu.html">GPUCA_NAMESPACE::gpu</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d0b/GPUCommonAlgorithm_8h_source.html#l00029">GPUCommonAlgorithm.h:29</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a74d80fd479c0f6d0153c709949a089ef"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a74d80fd479c0f6d0153c709949a089ef">y</a></div><div class="ttdeci">GLint y</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00270">glcorearb.h:270</a></div></div>
<div class="ttc" id="namespaceo2_1_1framework_html_ac2569e9658701f4fc5b687da9dacb739ae557705aebad579817e10aa4fdcfaa00"><div class="ttname"><a href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739ae557705aebad579817e10aa4fdcfaa00">o2::framework::Log</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dc2/BasicOps_8h_source.html#l00029">BasicOps.h:29</a></div></div>
<div class="ttc" id="glcorearb_8h_html_abe08814c2f72843fde4d8df41440d5a0"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#abe08814c2f72843fde4d8df41440d5a0">r</a></div><div class="ttdeci">GLboolean r</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l01233">glcorearb.h:1233</a></div></div>
<div class="ttc" id="GPUCommonAlgorithm_8h_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d0b/GPUCommonAlgorithm_8h_source.html#l00385">GPUCommonAlgorithm.h:385</a></div></div>
<div class="ttc" id="qconfigoptions_8h_html_aea939160667cc03fe767732bf705f1d4"><div class="ttname"><a href="../../d8/de9/qconfigoptions_8h.html#aea939160667cc03fe767732bf705f1d4">qpt</a></div><div class="ttdeci">Visualize clusters only Timeframe settings Average distance in cm of events merged into Randomize distance around average distance of merged events Simulate correct bunch interactions instead of placing only the average number of events A value [n] sets TFlen for [n] collisions in Number of bunches per train Number of bunch trains Instantaneous interaction rate Do not simulate border Total number of collisions to be placed in the interior of all time Do not select random but walk over array of events in stride steps h QA settings const char Legend entries for data from comparison histogram files const char Store histograms in output root Do not run but just create PDFs from input root files qpt</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/de9/qconfigoptions_8h_source.html#l00047">qconfigoptions.h:47</a></div></div>
<div class="ttc" id="namespaceo2_1_1its_1_1math__utils_html_ac713be41b5cad67abc4e4d0581961905"><div class="ttname"><a href="../../d2/dc1/namespaceo2_1_1its_1_1math__utils.html#ac713be41b5cad67abc4e4d0581961905">o2::its::math_utils::z1</a></div><div class="ttdeci">float float float float z1</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d3e/MathUtils_8h_source.html#l00043">MathUtils.h:43</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_f511f1e9c03c071966ae594f00bbc5e0.html">GPU</a></li><li class="navelem"><a class="el" href="../../dir_77030b149987c946eb2e85728f65acc0.html">GPUTracking</a></li><li class="navelem"><a class="el" href="../../dir_b1a191f241d56beebc4ffdb42af892eb.html">SliceTracker</a></li><li class="navelem"><a class="el" href="../../d2/d94/GPUTPCTrackParam_8cxx.html">GPUTPCTrackParam.cxx</a></li>
    <li class="footer">Generated on Thu Jun 4 2020 09:30:35 for Project by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
