<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Project: /home/travis/build/AliceO2Group/AliceO2/Detectors/PHOS/reconstruction/src/FullCluster.cxx Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../o2_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d3/d64/PHOS_2reconstruction_2src_2FullCluster_8cxx_source.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">FullCluster.cxx</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d3/d64/PHOS_2reconstruction_2src_2FullCluster_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Copyright CERN and copyright holders of ALICE O2. This software is</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// distributed under the terms of the GNU General Public License v3 (GPL</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Version 3), copied verbatim in the file &quot;COPYING&quot;.</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// See http://alice-o2.web.cern.ch/license for full licensing information.</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// In applying this license CERN does not waive the privileges and immunities</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// granted to it by virtue of its status as an Intergovernmental Organization</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// or submit itself to any jurisdiction.</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/d50/DataFormats_2Detectors_2PHOS_2include_2DataFormatsPHOS_2Cluster_8h.html">DataFormatsPHOS/Cluster.h</a>&quot;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d32/PHOS_2reconstruction_2include_2PHOSReconstruction_2FullCluster_8h.html">PHOSReconstruction/FullCluster.h</a>&quot;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/d7f/PHOS_2base_2include_2PHOSBase_2Geometry_8h.html">PHOSBase/Geometry.h</a>&quot;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d62/PHOSSimParams_8h.html">PHOSBase/PHOSSimParams.h</a>&quot;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;FairLogger.h&quot;</span> <span class="comment">// for LOG</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="keyword">using namespace </span><a class="code" href="../../dd/d57/namespaceo2_1_1phos.html">o2::phos</a>;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<a class="code" href="../../d9/d63/CPV_2reconstruction_2src_2FullCluster_8cxx.html#ab0ae05a4170e25fd65298d94d86d335f">ClassImp</a>(<a class="code" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html">FullCluster</a>);</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#a5031a5d519aa90fc37190a7ee9aaf29d">   22</a></span>&#160;<a class="code" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#ac81c4ef468069d8130d93db89045484c">FullCluster::FullCluster</a>(<span class="keywordtype">short</span> digitAbsId, <span class="keywordtype">float</span> <a class="code" href="../../dd/ddf/SecondaryVertex_8h.html#a7effbf82c50caa2e6b11dd6c61317195">energy</a>, <span class="keywordtype">float</span> time, <span class="keywordtype">int</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a9371a1f53f8067997cd15aaf657c62d0">label</a>, <span class="keywordtype">float</span> scale)</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  : <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html">Cluster</a>()</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;{</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <a class="code" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#a9acc167899424997098bfe7e17c89301">addDigit</a>(digitAbsId, energy, time, label, scale);</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;}</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">//____________________________________________________________________________</span></div><div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#a9acc167899424997098bfe7e17c89301">   28</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#a9acc167899424997098bfe7e17c89301">FullCluster::addDigit</a>(<span class="keywordtype">short</span> digitIndex, <span class="keywordtype">float</span> <a class="code" href="../../dd/ddf/SecondaryVertex_8h.html#a7effbf82c50caa2e6b11dd6c61317195">energy</a>, <span class="keywordtype">float</span> time, <span class="keywordtype">int</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a9371a1f53f8067997cd15aaf657c62d0">label</a>, <span class="keywordtype">float</span> scale)</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;{</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="comment">// Adds digit to the FullCluster</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="comment">// and accumulates the total amplitude and the multiplicity, list of primaries</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordtype">float</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a> = 0., <a class="code" href="../../dc/da3/glcorearb_8h.html#aee38b51639b577753f6a92029fb92000">z</a> = 0.;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <a class="code" href="../../d4/d6c/classo2_1_1phos_1_1Geometry.html">Geometry</a>* phosGeom = <a class="code" href="../../d4/d6c/classo2_1_1phos_1_1Geometry.html#a5beceefc4ad5b551a86e46e3efe6d243">Geometry::GetInstance</a>();</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  phosGeom-&gt;<a class="code" href="../../d4/d6c/classo2_1_1phos_1_1Geometry.html#aaabcf52bf9adf70112937e889e6dc7e9">absIdToRelPosInModule</a>(digitIndex, x, <a class="code" href="../../dc/da3/glcorearb_8h.html#aee38b51639b577753f6a92029fb92000">z</a>);</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  mElementList.emplace_back(digitIndex, energy, time, x, <a class="code" href="../../dc/da3/glcorearb_8h.html#aee38b51639b577753f6a92029fb92000">z</a>, label, scale);</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#adccdf190b4baff75c15edd8acd8695ef">mFullEnergy</a> += <a class="code" href="../../dd/ddf/SecondaryVertex_8h.html#a7effbf82c50caa2e6b11dd6c61317195">energy</a>; <span class="comment">//To be updated when calculate cluster properties.</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a9c4840ce318d0e100fa940354fcc3bcf">mMulDigit</a>++;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;}</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">//____________________________________________________________________________</span></div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#ada0d0b5bff07a255176975eb4c730146">   42</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#ada0d0b5bff07a255176975eb4c730146">FullCluster::evalAll</a>()</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;{</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="comment">// Evaluate cluster parameters</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <a class="code" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#af2033e518123f22c061155b5adf9c75a">evalCoreEnergy</a>();</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <a class="code" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#a71f170b58ebf892db558c3427546dcd9">evalLocalPosition</a>();</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <a class="code" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#a640fcc0645425e05646f907af16b47a1">evalElipsAxis</a>();</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <a class="code" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#abf2956ac7fa4e3f82ad4201b5384f859">evalDispersion</a>();</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <a class="code" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#a0923b72140704941d8993fd5da58a6e4">evalTime</a>();</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;}</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">//____________________________________________________________________________</span></div><div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#af521be4e9272437484559d7bb9dd3649">   52</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#af521be4e9272437484559d7bb9dd3649">FullCluster::purify</a>()</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;{</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="comment">// Removes digits below threshold</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordtype">float</span> <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a2b8298cdaa115e10085952184e21fa2f">threshold</a> = <a class="code" href="../../d7/d50/classo2_1_1conf_1_1ConfigurableParamHelper.html#acd640717f419212c67fecff71d876d39">o2::phos::PHOSSimParams::Instance</a>().<a class="code" href="../../d1/d8d/structo2_1_1phos_1_1PHOSSimParams.html#a78e61019dd71792e6f58f5854fd3ea09">mDigitMinEnergy</a>;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <a class="code" href="../../d4/d6c/classo2_1_1phos_1_1Geometry.html">Geometry</a>* phosGeom = <a class="code" href="../../d4/d6c/classo2_1_1phos_1_1Geometry.html#a5beceefc4ad5b551a86e46e3efe6d243">Geometry::GetInstance</a>();</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  std::vector&lt;CluElement&gt;::iterator itEl = mElementList.begin();</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keywordflow">while</span> (itEl != mElementList.end()) {</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordflow">if</span> ((*itEl).energy &lt; threshold) { <span class="comment">//very rare case</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      itEl = mElementList.erase(itEl);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      ++itEl;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    }</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  }</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a9c4840ce318d0e100fa940354fcc3bcf">mMulDigit</a> = mElementList.size();</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a9c4840ce318d0e100fa940354fcc3bcf">mMulDigit</a> == 0) { <span class="comment">// too soft cluster</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#adccdf190b4baff75c15edd8acd8695ef">mFullEnergy</a> = 0.;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  }</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="comment">// Remove non-connected cells</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a9c4840ce318d0e100fa940354fcc3bcf">mMulDigit</a> &gt; 1) {</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#adccdf190b4baff75c15edd8acd8695ef">mFullEnergy</a> = 0.; <span class="comment">// Recalculate total energy</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keyword">auto</span> it = mElementList.begin();</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">while</span> (it != mElementList.end()) {</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <span class="keywordtype">bool</span> hasNeighbours = <span class="keyword">false</span>;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> jt = mElementList.begin(); jt != mElementList.end(); ++jt) {</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordflow">if</span> (it == jt) {</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        }</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keywordflow">if</span> (phosGeom-&gt;<a class="code" href="../../d4/d6c/classo2_1_1phos_1_1Geometry.html#aa5272e2f0bce58f2a1ead0108832223a">areNeighbours</a>((*it).absId, (*jt).absId) == 1) {</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;          hasNeighbours = <span class="keyword">true</span>;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      }</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <span class="keywordflow">if</span> (!hasNeighbours) { <span class="comment">//Isolated digits are rare</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        it = mElementList.erase(it);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        --<a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a9c4840ce318d0e100fa940354fcc3bcf">mMulDigit</a>;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#adccdf190b4baff75c15edd8acd8695ef">mFullEnergy</a> += (*it).energy;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        ++it;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      }</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    }</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#adccdf190b4baff75c15edd8acd8695ef">mFullEnergy</a> = mElementList[0].energy;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  }</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;}</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">//____________________________________________________________________________</span></div><div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#af2033e518123f22c061155b5adf9c75a">  103</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#af2033e518123f22c061155b5adf9c75a">FullCluster::evalCoreEnergy</a>()</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;{</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="comment">// This function calculates energy in the core,</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="comment">// i.e. within a radius coreRadius (~3cm) around the center. Beyond this radius</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="comment">// in accordance with shower profile the energy deposition</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="comment">// should be less than 2%</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a828244098ee8b1061af96ccf457eb169">mLocalPosX</a> &lt; -900.) <span class="comment">// local position was not calculated yiet</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  {</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#a71f170b58ebf892db558c3427546dcd9">evalLocalPosition</a>();</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  }</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordtype">float</span> coreRadius = <a class="code" href="../../d7/d50/classo2_1_1conf_1_1ConfigurableParamHelper.html#acd640717f419212c67fecff71d876d39">o2::phos::PHOSSimParams::Instance</a>().<a class="code" href="../../d1/d8d/structo2_1_1phos_1_1PHOSSimParams.html#a4b8d3c6c204aa3303526923c56986737">mCoreR</a>;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> it : mElementList) {</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="../../d9/d7d/classFloat__t.html">Float_t</a> <a class="code" href="../../dc/da3/glcorearb_8h.html#a744fbed01658cb96bb8ba7e85a86d1dc">distance</a> = std::sqrt((it.localX - <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a828244098ee8b1061af96ccf457eb169">mLocalPosX</a>) * (it.localX - <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a828244098ee8b1061af96ccf457eb169">mLocalPosX</a>) +</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                                 (it.localZ - <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a43b9631e4fc7fe236e978f92b98802ca">mLocalPosZ</a>) * (it.localZ - <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a828244098ee8b1061af96ccf457eb169">mLocalPosX</a>));</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">if</span> (distance &lt; coreRadius) {</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a1508b4fcbb5ab7848322fbea98e6fc6d">mCoreEnergy</a> += it.energy;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    }</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  }</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;}</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">//____________________________________________________________________________</span></div><div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#a71f170b58ebf892db558c3427546dcd9">  125</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#a71f170b58ebf892db558c3427546dcd9">FullCluster::evalLocalPosition</a>()</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;{</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="comment">// Calculates the center of gravity in the local PHOS-module coordinates</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="comment">// Note that correction for non-perpendicular incidence will be applied later</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="comment">// when vertex will be known.</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#adccdf190b4baff75c15edd8acd8695ef">mFullEnergy</a> &lt;= 0.) { <span class="comment">// zero energy cluster, position undefined</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a828244098ee8b1061af96ccf457eb169">mLocalPosX</a> = -999.;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a43b9631e4fc7fe236e978f92b98802ca">mLocalPosZ</a> = -999.;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  }</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="comment">// find module number</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <a class="code" href="../../d4/d6c/classo2_1_1phos_1_1Geometry.html">Geometry</a>* phosGeom = <a class="code" href="../../d4/d6c/classo2_1_1phos_1_1Geometry.html#a5beceefc4ad5b551a86e46e3efe6d243">Geometry::GetInstance</a>();</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#aed5d33f6e9bad82a629d584fe5e4dda4">mModule</a> = phosGeom-&gt;<a class="code" href="../../d4/d6c/classo2_1_1phos_1_1Geometry.html#a9f7c7e8696b8c8e0bd3821fb90ec7bc7">absIdToModule</a>(mElementList[0].absId);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keywordtype">float</span> wtot = 0.;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a828244098ee8b1061af96ccf457eb169">mLocalPosX</a> = 0.;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a43b9631e4fc7fe236e978f92b98802ca">mLocalPosZ</a> = 0.;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordtype">float</span> invE = 1. / <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#adccdf190b4baff75c15edd8acd8695ef">mFullEnergy</a>;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> it : mElementList) {</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#adb12a0d439f32ca388b2c806150cc54d">w</a> = <a class="code" href="../../d2/d0e/test__Algorithm_8cxx.html#a5216308b2bcc588018b96379974d290c">std::max</a>(<span class="keywordtype">float</span>(0.), <a class="code" href="../../d7/d50/classo2_1_1conf_1_1ConfigurableParamHelper.html#acd640717f419212c67fecff71d876d39">o2::phos::PHOSSimParams::Instance</a>().mLogWeight + std::log(it.energy * invE));</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a828244098ee8b1061af96ccf457eb169">mLocalPosX</a> += it.localX * <a class="code" href="../../dc/da3/glcorearb_8h.html#adb12a0d439f32ca388b2c806150cc54d">w</a>;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a43b9631e4fc7fe236e978f92b98802ca">mLocalPosZ</a> += it.localZ * <a class="code" href="../../dc/da3/glcorearb_8h.html#adb12a0d439f32ca388b2c806150cc54d">w</a>;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    wtot += <a class="code" href="../../dc/da3/glcorearb_8h.html#adb12a0d439f32ca388b2c806150cc54d">w</a>;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  }</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keywordflow">if</span> (wtot &gt; 0) {</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    wtot = 1. / wtot;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a828244098ee8b1061af96ccf457eb169">mLocalPosX</a> *= wtot;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a43b9631e4fc7fe236e978f92b98802ca">mLocalPosZ</a> *= wtot;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  }</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;}</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">//____________________________________________________________________________</span></div><div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#abf2956ac7fa4e3f82ad4201b5384f859">  158</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#abf2956ac7fa4e3f82ad4201b5384f859">FullCluster::evalDispersion</a>()</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;{ <span class="comment">// computes the dispersion of the shower</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a8a215c88f201989a7abe3c4c1a089a36">mDispersion</a> = 0.;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#adccdf190b4baff75c15edd8acd8695ef">mFullEnergy</a> &lt;= 0.) { <span class="comment">// zero energy cluster, dispersion undefined</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  }</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a828244098ee8b1061af96ccf457eb169">mLocalPosX</a> &lt; -900.) <span class="comment">// local position was not calculated yiet</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#a71f170b58ebf892db558c3427546dcd9">evalLocalPosition</a>();</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  }</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keywordtype">float</span> wtot = 0.;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keywordtype">float</span> invE = 1. / <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#adccdf190b4baff75c15edd8acd8695ef">mFullEnergy</a>;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> it : mElementList) {</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#adb12a0d439f32ca388b2c806150cc54d">w</a> = <a class="code" href="../../d2/d0e/test__Algorithm_8cxx.html#a5216308b2bcc588018b96379974d290c">std::max</a>(<span class="keywordtype">float</span>(0.), <a class="code" href="../../d7/d50/classo2_1_1conf_1_1ConfigurableParamHelper.html#acd640717f419212c67fecff71d876d39">o2::phos::PHOSSimParams::Instance</a>().mLogWeight + std::log(it.energy * invE));</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a8a215c88f201989a7abe3c4c1a089a36">mDispersion</a> += w * ((it.localX - <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a828244098ee8b1061af96ccf457eb169">mLocalPosX</a>) * (it.localX - <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a828244098ee8b1061af96ccf457eb169">mLocalPosX</a>) +</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                        (it.localZ - <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a43b9631e4fc7fe236e978f92b98802ca">mLocalPosZ</a>) * (it.localZ - <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a43b9631e4fc7fe236e978f92b98802ca">mLocalPosZ</a>));</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    wtot += <a class="code" href="../../dc/da3/glcorearb_8h.html#adb12a0d439f32ca388b2c806150cc54d">w</a>;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  }</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordflow">if</span> (wtot &gt; 0) {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a8a215c88f201989a7abe3c4c1a089a36">mDispersion</a> /= wtot;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a8a215c88f201989a7abe3c4c1a089a36">mDispersion</a> &gt;= 0)</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a8a215c88f201989a7abe3c4c1a089a36">mDispersion</a> = std::sqrt(<a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a8a215c88f201989a7abe3c4c1a089a36">mDispersion</a>);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a8a215c88f201989a7abe3c4c1a089a36">mDispersion</a> = 0.;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;}</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">//____________________________________________________________________________</span></div><div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#a640fcc0645425e05646f907af16b47a1">  189</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#a640fcc0645425e05646f907af16b47a1">FullCluster::evalElipsAxis</a>()</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;{ <span class="comment">// computes the axis of shower ellipsoide</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="comment">// Calculates the axis of the shower ellipsoid</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#adccdf190b4baff75c15edd8acd8695ef">mFullEnergy</a> &lt;= 0.) { <span class="comment">// zero energy cluster, dispersion undefined</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#ac00abe4bf7af5cd9af6f621f79d67f56">mLambdaLong</a> = <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a75124fb64045031b51474fd86de3209d">mLambdaShort</a> = 0.;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  }</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keywordtype">float</span> wtot = 0., <a class="code" href="../../dc/da3/glcorearb_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a> = 0., <a class="code" href="../../dc/da3/glcorearb_8h.html#aee38b51639b577753f6a92029fb92000">z</a> = 0., dxx = 0., dxz = 0., dzz = 0.;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keywordtype">float</span> invE = 1. / <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#adccdf190b4baff75c15edd8acd8695ef">mFullEnergy</a>;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> it : mElementList) {</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordtype">float</span> xi = 0., zi = 0.;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#adb12a0d439f32ca388b2c806150cc54d">w</a> = <a class="code" href="../../d2/d0e/test__Algorithm_8cxx.html#a5216308b2bcc588018b96379974d290c">std::max</a>(<span class="keywordtype">float</span>(0.), <a class="code" href="../../d7/d50/classo2_1_1conf_1_1ConfigurableParamHelper.html#acd640717f419212c67fecff71d876d39">o2::phos::PHOSSimParams::Instance</a>().mLogWeight + std::log(it.energy * invE));</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    dxx += w * it.localX * it.localX;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <a class="code" href="../../dc/da3/glcorearb_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a> += w * it.localX;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    dzz += w * it.localZ * it.localZ;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <a class="code" href="../../dc/da3/glcorearb_8h.html#aee38b51639b577753f6a92029fb92000">z</a> += w * it.localZ;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    dxz += w * it.localX * it.localZ;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    wtot += <a class="code" href="../../dc/da3/glcorearb_8h.html#adb12a0d439f32ca388b2c806150cc54d">w</a>;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  }</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keywordflow">if</span> (wtot &gt; 0) {</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    wtot = 1. / wtot;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    dxx *= wtot;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="../../dc/da3/glcorearb_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a> *= wtot;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    dxx -= <a class="code" href="../../dc/da3/glcorearb_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a> * <a class="code" href="../../dc/da3/glcorearb_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a>;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    dzz *= wtot;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="../../dc/da3/glcorearb_8h.html#aee38b51639b577753f6a92029fb92000">z</a> *= wtot;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    dzz -= <a class="code" href="../../dc/da3/glcorearb_8h.html#aee38b51639b577753f6a92029fb92000">z</a> * <a class="code" href="../../dc/da3/glcorearb_8h.html#aee38b51639b577753f6a92029fb92000">z</a>;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    dxz *= wtot;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    dxz -= x * <a class="code" href="../../dc/da3/glcorearb_8h.html#aee38b51639b577753f6a92029fb92000">z</a>;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#ac00abe4bf7af5cd9af6f621f79d67f56">mLambdaLong</a> = 0.5 * (dxx + dzz) + std::sqrt(0.25 * (dxx - dzz) * (dxx - dzz) + dxz * dxz);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#ac00abe4bf7af5cd9af6f621f79d67f56">mLambdaLong</a> &gt; 0)</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#ac00abe4bf7af5cd9af6f621f79d67f56">mLambdaLong</a> = std::sqrt(<a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#ac00abe4bf7af5cd9af6f621f79d67f56">mLambdaLong</a>);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a75124fb64045031b51474fd86de3209d">mLambdaShort</a> = 0.5 * (dxx + dzz) - std::sqrt(0.25 * (dxx - dzz) * (dxx - dzz) + dxz * dxz);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a75124fb64045031b51474fd86de3209d">mLambdaShort</a> &gt; 0) <span class="comment">// To avoid exception if numerical errors lead to negative lambda.</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a75124fb64045031b51474fd86de3209d">mLambdaShort</a> = std::sqrt(<a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a75124fb64045031b51474fd86de3209d">mLambdaShort</a>);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a75124fb64045031b51474fd86de3209d">mLambdaShort</a> = 0.;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#ac00abe4bf7af5cd9af6f621f79d67f56">mLambdaLong</a> = <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a75124fb64045031b51474fd86de3209d">mLambdaShort</a> = 0.;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  }</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;}</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">//____________________________________________________________________________</span></div><div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#a0923b72140704941d8993fd5da58a6e4">  235</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#a0923b72140704941d8993fd5da58a6e4">FullCluster::evalTime</a>()</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;{</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="comment">// Calculate time as time in the digit with maximal energy</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordtype">float</span> eMax = 0.;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> it : mElementList) {</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">if</span> (it.energy &gt; eMax) {</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a826275e7e1a2a0fbca59d716eea34651">mTime</a> = it.time;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      eMax = it.energy;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    }</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  }</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;}</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">//____________________________________________________________________________</span></div><div class="line"><a name="l00249"></a><span class="lineno"><a class="line" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#a54c9efc361435168df23b35578a61e12">  249</a></span>&#160;std::vector&lt;Digit&gt;::const_iterator <a class="code" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#a54c9efc361435168df23b35578a61e12">FullCluster::BinarySearch</a>(<span class="keyword">const</span> std::vector&lt;Digit&gt;* container, <a class="code" href="../../df/dbc/classo2_1_1phos_1_1Digit.html">Digit</a>&amp; element)</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;{</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="keyword">const</span> std::vector&lt;Digit&gt;::const_iterator endIt = container-&gt;end();</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  std::vector&lt;Digit&gt;::const_iterator <a class="code" href="../../dc/da3/glcorearb_8h.html#a85b8f6c07fbc1fb5d77c2ae090f21995">left</a> = container-&gt;begin();</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  std::vector&lt;Digit&gt;::const_iterator <a class="code" href="../../dc/da3/glcorearb_8h.html#a5ffadbbacc6b89cf6218bc43b384d3fe">right</a> = endIt;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keywordflow">if</span> (container-&gt;size() == 0 || container-&gt;front() &gt; element || container-&gt;back() &lt; element) {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">return</span> endIt;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  }</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keywordflow">while</span> (<a class="code" href="../../dc/da3/glcorearb_8h.html#a744fbed01658cb96bb8ba7e85a86d1dc">distance</a>(left, right) &gt; 0) {</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keyword">const</span> std::vector&lt;Digit&gt;::const_iterator mid = left + <a class="code" href="../../dc/da3/glcorearb_8h.html#a744fbed01658cb96bb8ba7e85a86d1dc">distance</a>(left, right) / 2;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">if</span> (element &gt; *mid) {</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      left = mid + 1;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      right = mid;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    }</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  }</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordflow">if</span> (*right == element) {</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a5ffadbbacc6b89cf6218bc43b384d3fe">right</a>;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  }</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="keywordflow">return</span> endIt;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;}</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">//____________________________________________________________________________</span></div><div class="line"><a name="l00277"></a><span class="lineno"><a class="line" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#a37510fdb5997bab190e3e09173251c87">  277</a></span>&#160;<span class="keywordtype">char</span> <a class="code" href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#a37510fdb5997bab190e3e09173251c87">FullCluster::getNumberOfLocalMax</a>(gsl::span&lt;int&gt; maxAt)<span class="keyword"> const</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="comment">// Calculates the number of local maxima in the cluster using LocalMaxCut as the minimum</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="comment">// energy difference between maximum and surrounding digits</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="keywordtype">float</span> locMaxCut = <a class="code" href="../../d7/d50/classo2_1_1conf_1_1ConfigurableParamHelper.html#acd640717f419212c67fecff71d876d39">o2::phos::PHOSSimParams::Instance</a>().<a class="code" href="../../d1/d8d/structo2_1_1phos_1_1PHOSSimParams.html#aad6b7e6eb1d3ed7865071828c1798517">mLocalMaximumCut</a>;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  std::unique_ptr&lt;bool[]&gt; isLocalMax = std::make_unique&lt;bool[]&gt;(<a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a9c4840ce318d0e100fa940354fcc3bcf">mMulDigit</a>);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a9c4840ce318d0e100fa940354fcc3bcf">mMulDigit</a>; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">if</span> (mElementList[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../dd/ddf/SecondaryVertex_8h.html#a7effbf82c50caa2e6b11dd6c61317195">energy</a> &gt; <a class="code" href="../../d7/d50/classo2_1_1conf_1_1ConfigurableParamHelper.html#acd640717f419212c67fecff71d876d39">o2::phos::PHOSSimParams::Instance</a>().<a class="code" href="../../d1/d8d/structo2_1_1phos_1_1PHOSSimParams.html#a9783f6ddc64c30e6e3c0a9ad55e9d691">mClusteringThreshold</a>) {</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      isLocalMax[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <span class="keyword">true</span>;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      isLocalMax[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <span class="keyword">false</span>;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    }</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  }</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a9c4840ce318d0e100fa940354fcc3bcf">mMulDigit</a>; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1; j &lt; <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a9c4840ce318d0e100fa940354fcc3bcf">mMulDigit</a>; j++) {</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d4/d6c/classo2_1_1phos_1_1Geometry.html#a5beceefc4ad5b551a86e46e3efe6d243">Geometry::GetInstance</a>()-&gt;<a class="code" href="../../d4/d6c/classo2_1_1phos_1_1Geometry.html#aa5272e2f0bce58f2a1ead0108832223a">areNeighbours</a>(mElementList[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].absId, mElementList[j].absId) == 1) {</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="keywordflow">if</span> (mElementList[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../dd/ddf/SecondaryVertex_8h.html#a7effbf82c50caa2e6b11dd6c61317195">energy</a> &gt; mElementList[j].<a class="code" href="../../dd/ddf/SecondaryVertex_8h.html#a7effbf82c50caa2e6b11dd6c61317195">energy</a>) {</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;          isLocalMax[j] = <span class="keyword">false</span>;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;          <span class="comment">// but may be digit too is not local max ?</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;          <span class="keywordflow">if</span> (mElementList[j].energy &gt; mElementList[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].energy - locMaxCut) {</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            isLocalMax[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <span class="keyword">false</span>;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;          }</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;          isLocalMax[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <span class="keyword">false</span>;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;          <span class="comment">// but may be digitN is not local max too?</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;          <span class="keywordflow">if</span> (mElementList[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].energy &gt; mElementList[j].energy - locMaxCut) {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            isLocalMax[j] = <span class="keyword">false</span>;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;          }</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        }</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      } <span class="comment">// if areneighbours</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    }   <span class="comment">// digit j</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  }     <span class="comment">// digit i</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keywordtype">int</span> iDigitN = 0;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a9c4840ce318d0e100fa940354fcc3bcf">mMulDigit</a>; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">if</span> (isLocalMax[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]) {</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      maxAt[iDigitN] = <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      iDigitN++;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <span class="keywordflow">if</span> (iDigitN &gt;= <a class="code" href="../../d7/d50/classo2_1_1conf_1_1ConfigurableParamHelper.html#acd640717f419212c67fecff71d876d39">o2::phos::PHOSSimParams::Instance</a>().<a class="code" href="../../d1/d8d/structo2_1_1phos_1_1PHOSSimParams.html#a42277a2d8bda7b98db54fece48459ce2">mNLMMax</a>) { <span class="comment">// Note that size of output arrays is limited:</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(<a class="code" href="../../d1/df4/namespaceo2_1_1data__flow.html#a3a67fd76d9a0e56c332aebc06a41e8e8ad6e1b2dd08ee0161c09b9dffb4f99873">ERROR</a>) &lt;&lt; <span class="stringliteral">&quot;Too many local maxima, cluster multiplicity &quot;</span> &lt;&lt; <a class="code" href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a9c4840ce318d0e100fa940354fcc3bcf">mMulDigit</a>;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      }</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    }</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  }</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="keywordflow">return</span> iDigitN;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;}</div><div class="ttc" id="PHOS_2reconstruction_2include_2PHOSReconstruction_2FullCluster_8h_html"><div class="ttname"><a href="../../d3/d32/PHOS_2reconstruction_2include_2PHOSReconstruction_2FullCluster_8h.html">FullCluster.h</a></div></div>
<div class="ttc" id="structo2_1_1phos_1_1PHOSSimParams_html_a78e61019dd71792e6f58f5854fd3ea09"><div class="ttname"><a href="../../d1/d8d/structo2_1_1phos_1_1PHOSSimParams.html#a78e61019dd71792e6f58f5854fd3ea09">o2::phos::PHOSSimParams::mDigitMinEnergy</a></div><div class="ttdeci">float mDigitMinEnergy</div><div class="ttdoc">Minimal energy of digits to be used in cluster (GeV) </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d62/PHOSSimParams_8h_source.html#l00055">PHOSSimParams.h:55</a></div></div>
<div class="ttc" id="structo2_1_1phos_1_1PHOSSimParams_html_a4b8d3c6c204aa3303526923c56986737"><div class="ttname"><a href="../../d1/d8d/structo2_1_1phos_1_1PHOSSimParams.html#a4b8d3c6c204aa3303526923c56986737">o2::phos::PHOSSimParams::mCoreR</a></div><div class="ttdeci">float mCoreR</div><div class="ttdoc">Radius to caluclate core energy. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d62/PHOSSimParams_8h_source.html#l00063">PHOSSimParams.h:63</a></div></div>
<div class="ttc" id="glcorearb_8h_html_aee38b51639b577753f6a92029fb92000"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#aee38b51639b577753f6a92029fb92000">z</a></div><div class="ttdeci">GLdouble GLdouble GLdouble z</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00843">glcorearb.h:843</a></div></div>
<div class="ttc" id="classo2_1_1phos_1_1Cluster_html_a75124fb64045031b51474fd86de3209d"><div class="ttname"><a href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a75124fb64045031b51474fd86de3209d">o2::phos::Cluster::mLambdaShort</a></div><div class="ttdeci">float mLambdaShort</div><div class="ttdoc">shower ellipse axes </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d50/DataFormats_2Detectors_2PHOS_2include_2DataFormatsPHOS_2Cluster_8h_source.html#l00080">Cluster.h:80</a></div></div>
<div class="ttc" id="classo2_1_1phos_1_1Geometry_html"><div class="ttname"><a href="../../d4/d6c/classo2_1_1phos_1_1Geometry.html">o2::phos::Geometry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d7f/PHOS_2base_2include_2PHOSBase_2Geometry_8h_source.html#l00023">Geometry.h:23</a></div></div>
<div class="ttc" id="GPUCommonLogger_8h_html_aea3d0edfe28fc0325c636b2b33f0527a"><div class="ttname"><a href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a></div><div class="ttdeci">#define LOG(type)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d5b/GPUCommonLogger_8h_source.html#l00028">GPUCommonLogger.h:28</a></div></div>
<div class="ttc" id="classo2_1_1phos_1_1FullCluster_html_a0923b72140704941d8993fd5da58a6e4"><div class="ttname"><a href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#a0923b72140704941d8993fd5da58a6e4">o2::phos::FullCluster::evalTime</a></div><div class="ttdeci">void evalTime()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d64/PHOS_2reconstruction_2src_2FullCluster_8cxx_source.html#l00235">FullCluster.cxx:235</a></div></div>
<div class="ttc" id="namespaceo2_1_1data__flow_html_a3a67fd76d9a0e56c332aebc06a41e8e8ad6e1b2dd08ee0161c09b9dffb4f99873"><div class="ttname"><a href="../../d1/df4/namespaceo2_1_1data__flow.html#a3a67fd76d9a0e56c332aebc06a41e8e8ad6e1b2dd08ee0161c09b9dffb4f99873">o2::data_flow::ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db0/TimeframeParser_8cxx_source.html#l00049">TimeframeParser.cxx:49</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a85b8f6c07fbc1fb5d77c2ae090f21995"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a85b8f6c07fbc1fb5d77c2ae090f21995">left</a></div><div class="ttdeci">GLint left</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l01979">glcorearb.h:1979</a></div></div>
<div class="ttc" id="classo2_1_1phos_1_1Cluster_html_a9c4840ce318d0e100fa940354fcc3bcf"><div class="ttname"><a href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a9c4840ce318d0e100fa940354fcc3bcf">o2::phos::Cluster::mMulDigit</a></div><div class="ttdeci">char mMulDigit</div><div class="ttdoc">Digit nultiplicity. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d50/DataFormats_2Detectors_2PHOS_2include_2DataFormatsPHOS_2Cluster_8h_source.html#l00071">Cluster.h:71</a></div></div>
<div class="ttc" id="classo2_1_1phos_1_1FullCluster_html_af521be4e9272437484559d7bb9dd3649"><div class="ttname"><a href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#af521be4e9272437484559d7bb9dd3649">o2::phos::FullCluster::purify</a></div><div class="ttdeci">void purify()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d64/PHOS_2reconstruction_2src_2FullCluster_8cxx_source.html#l00052">FullCluster.cxx:52</a></div></div>
<div class="ttc" id="classo2_1_1phos_1_1FullCluster_html_a640fcc0645425e05646f907af16b47a1"><div class="ttname"><a href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#a640fcc0645425e05646f907af16b47a1">o2::phos::FullCluster::evalElipsAxis</a></div><div class="ttdeci">void evalElipsAxis()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d64/PHOS_2reconstruction_2src_2FullCluster_8cxx_source.html#l00189">FullCluster.cxx:189</a></div></div>
<div class="ttc" id="classo2_1_1phos_1_1FullCluster_html_af2033e518123f22c061155b5adf9c75a"><div class="ttname"><a href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#af2033e518123f22c061155b5adf9c75a">o2::phos::FullCluster::evalCoreEnergy</a></div><div class="ttdeci">void evalCoreEnergy()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d64/PHOS_2reconstruction_2src_2FullCluster_8cxx_source.html#l00103">FullCluster.cxx:103</a></div></div>
<div class="ttc" id="CPV_2reconstruction_2src_2FullCluster_8cxx_html_ab0ae05a4170e25fd65298d94d86d335f"><div class="ttname"><a href="../../d9/d63/CPV_2reconstruction_2src_2FullCluster_8cxx.html#ab0ae05a4170e25fd65298d94d86d335f">ClassImp</a></div><div class="ttdeci">ClassImp(FullCluster)</div></div>
<div class="ttc" id="classo2_1_1phos_1_1FullCluster_html_a9acc167899424997098bfe7e17c89301"><div class="ttname"><a href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#a9acc167899424997098bfe7e17c89301">o2::phos::FullCluster::addDigit</a></div><div class="ttdeci">void addDigit(short digitAbsId, float energy, float time, int label, float scale)</div><div class="ttdoc">Method to add digit to a cluster. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d64/PHOS_2reconstruction_2src_2FullCluster_8cxx_source.html#l00028">FullCluster.cxx:28</a></div></div>
<div class="ttc" id="structo2_1_1phos_1_1PHOSSimParams_html_a9783f6ddc64c30e6e3c0a9ad55e9d691"><div class="ttname"><a href="../../d1/d8d/structo2_1_1phos_1_1PHOSSimParams.html#a9783f6ddc64c30e6e3c0a9ad55e9d691">o2::phos::PHOSSimParams::mClusteringThreshold</a></div><div class="ttdeci">float mClusteringThreshold</div><div class="ttdoc">Minimal energy of digit to start clustering (GeV) </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d62/PHOSSimParams_8h_source.html#l00056">PHOSSimParams.h:56</a></div></div>
<div class="ttc" id="classo2_1_1phos_1_1FullCluster_html_a37510fdb5997bab190e3e09173251c87"><div class="ttname"><a href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#a37510fdb5997bab190e3e09173251c87">o2::phos::FullCluster::getNumberOfLocalMax</a></div><div class="ttdeci">char getNumberOfLocalMax(gsl::span&lt; int &gt; maxAt) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d64/PHOS_2reconstruction_2src_2FullCluster_8cxx_source.html#l00277">FullCluster.cxx:277</a></div></div>
<div class="ttc" id="classo2_1_1phos_1_1Geometry_html_a5beceefc4ad5b551a86e46e3efe6d243"><div class="ttname"><a href="../../d4/d6c/classo2_1_1phos_1_1Geometry.html#a5beceefc4ad5b551a86e46e3efe6d243">o2::phos::Geometry::GetInstance</a></div><div class="ttdeci">static Geometry * GetInstance()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d7f/PHOS_2base_2include_2PHOSBase_2Geometry_8h_source.html#l00057">Geometry.h:57</a></div></div>
<div class="ttc" id="classo2_1_1phos_1_1FullCluster_html"><div class="ttname"><a href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html">o2::phos::FullCluster</a></div><div class="ttdoc">PHOS cluster implementation. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/PHOS_2reconstruction_2include_2PHOSReconstruction_2FullCluster_8h_source.html#l00027">FullCluster.h:27</a></div></div>
<div class="ttc" id="test__Algorithm_8cxx_html_a5216308b2bcc588018b96379974d290c"><div class="ttname"><a href="../../d2/d0e/test__Algorithm_8cxx.html#a5216308b2bcc588018b96379974d290c">max</a></div><div class="ttdeci">const size_t max</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0e/test__Algorithm_8cxx_source.html#l00040">test_Algorithm.cxx:40</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a9371a1f53f8067997cd15aaf657c62d0"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a9371a1f53f8067997cd15aaf657c62d0">label</a></div><div class="ttdeci">GLuint GLsizei const GLchar * label</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l02519">glcorearb.h:2519</a></div></div>
<div class="ttc" id="classFloat__t_html"><div class="ttname"><a href="../../d9/d7d/classFloat__t.html">Float_t</a></div></div>
<div class="ttc" id="structo2_1_1phos_1_1PHOSSimParams_html_aad6b7e6eb1d3ed7865071828c1798517"><div class="ttname"><a href="../../d1/d8d/structo2_1_1phos_1_1PHOSSimParams.html#aad6b7e6eb1d3ed7865071828c1798517">o2::phos::PHOSSimParams::mLocalMaximumCut</a></div><div class="ttdeci">float mLocalMaximumCut</div><div class="ttdoc">Minimal height of local maximum over neighbours. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d62/PHOSSimParams_8h_source.html#l00057">PHOSSimParams.h:57</a></div></div>
<div class="ttc" id="classo2_1_1phos_1_1Geometry_html_aaabcf52bf9adf70112937e889e6dc7e9"><div class="ttname"><a href="../../d4/d6c/classo2_1_1phos_1_1Geometry.html#aaabcf52bf9adf70112937e889e6dc7e9">o2::phos::Geometry::absIdToRelPosInModule</a></div><div class="ttdeci">static void absIdToRelPosInModule(short absId, float &amp;x, float &amp;z)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dab/PHOS_2base_2src_2Geometry_8cxx_source.html#l00115">Geometry.cxx:115</a></div></div>
<div class="ttc" id="classo2_1_1phos_1_1Geometry_html_a9f7c7e8696b8c8e0bd3821fb90ec7bc7"><div class="ttname"><a href="../../d4/d6c/classo2_1_1phos_1_1Geometry.html#a9f7c7e8696b8c8e0bd3821fb90ec7bc7">o2::phos::Geometry::absIdToModule</a></div><div class="ttdeci">static char absIdToModule(short absId)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dab/PHOS_2base_2src_2Geometry_8cxx_source.html#l00070">Geometry.cxx:70</a></div></div>
<div class="ttc" id="classo2_1_1phos_1_1Cluster_html_a8a215c88f201989a7abe3c4c1a089a36"><div class="ttname"><a href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a8a215c88f201989a7abe3c4c1a089a36">o2::phos::Cluster::mDispersion</a></div><div class="ttdeci">float mDispersion</div><div class="ttdoc">shower dispersion </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d50/DataFormats_2Detectors_2PHOS_2include_2DataFormatsPHOS_2Cluster_8h_source.html#l00081">Cluster.h:81</a></div></div>
<div class="ttc" id="namespaceo2_1_1phos_html"><div class="ttname"><a href="../../dd/d57/namespaceo2_1_1phos.html">o2::phos</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dbc/SimTraits_8h_source.html#l00120">SimTraits.h:120</a></div></div>
<div class="ttc" id="classo2_1_1phos_1_1Cluster_html_a43b9631e4fc7fe236e978f92b98802ca"><div class="ttname"><a href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a43b9631e4fc7fe236e978f92b98802ca">o2::phos::Cluster::mLocalPosZ</a></div><div class="ttdeci">float mLocalPosZ</div><div class="ttdoc">Center of gravity position in local module coordunates (z direction) </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d50/DataFormats_2Detectors_2PHOS_2include_2DataFormatsPHOS_2Cluster_8h_source.html#l00076">Cluster.h:76</a></div></div>
<div class="ttc" id="classo2_1_1phos_1_1Cluster_html_ac00abe4bf7af5cd9af6f621f79d67f56"><div class="ttname"><a href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#ac00abe4bf7af5cd9af6f621f79d67f56">o2::phos::Cluster::mLambdaLong</a></div><div class="ttdeci">float mLambdaLong</div><div class="ttdoc">shower ellipse axes </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d50/DataFormats_2Detectors_2PHOS_2include_2DataFormatsPHOS_2Cluster_8h_source.html#l00079">Cluster.h:79</a></div></div>
<div class="ttc" id="classo2_1_1phos_1_1Cluster_html_aed5d33f6e9bad82a629d584fe5e4dda4"><div class="ttname"><a href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#aed5d33f6e9bad82a629d584fe5e4dda4">o2::phos::Cluster::mModule</a></div><div class="ttdeci">char mModule</div><div class="ttdoc">Module number. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d50/DataFormats_2Detectors_2PHOS_2include_2DataFormatsPHOS_2Cluster_8h_source.html#l00072">Cluster.h:72</a></div></div>
<div class="ttc" id="classo2_1_1phos_1_1Geometry_html_aa5272e2f0bce58f2a1ead0108832223a"><div class="ttname"><a href="../../d4/d6c/classo2_1_1phos_1_1Geometry.html#aa5272e2f0bce58f2a1ead0108832223a">o2::phos::Geometry::areNeighbours</a></div><div class="ttdeci">static int areNeighbours(short absId1, short absId2)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dab/PHOS_2base_2src_2Geometry_8cxx_source.html#l00078">Geometry.cxx:78</a></div></div>
<div class="ttc" id="classo2_1_1phos_1_1Cluster_html_adccdf190b4baff75c15edd8acd8695ef"><div class="ttname"><a href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#adccdf190b4baff75c15edd8acd8695ef">o2::phos::Cluster::mFullEnergy</a></div><div class="ttdeci">float mFullEnergy</div><div class="ttdoc">full energy of a shower </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d50/DataFormats_2Detectors_2PHOS_2include_2DataFormatsPHOS_2Cluster_8h_source.html#l00077">Cluster.h:77</a></div></div>
<div class="ttc" id="classo2_1_1phos_1_1FullCluster_html_ada0d0b5bff07a255176975eb4c730146"><div class="ttname"><a href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#ada0d0b5bff07a255176975eb4c730146">o2::phos::FullCluster::evalAll</a></div><div class="ttdeci">void evalAll()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d64/PHOS_2reconstruction_2src_2FullCluster_8cxx_source.html#l00042">FullCluster.cxx:42</a></div></div>
<div class="ttc" id="PHOSSimParams_8h_html"><div class="ttname"><a href="../../df/d62/PHOSSimParams_8h.html">PHOSSimParams.h</a></div></div>
<div class="ttc" id="classo2_1_1phos_1_1Digit_html"><div class="ttname"><a href="../../df/dbc/classo2_1_1phos_1_1Digit.html">o2::phos::Digit</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d98/DataFormats_2Detectors_2PHOS_2include_2DataFormatsPHOS_2Digit_8h_source.html#l00027">Digit.h:27</a></div></div>
<div class="ttc" id="classo2_1_1phos_1_1Cluster_html"><div class="ttname"><a href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html">o2::phos::Cluster</a></div><div class="ttdoc">Contains PHOS cluster parameters. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d50/DataFormats_2Detectors_2PHOS_2include_2DataFormatsPHOS_2Cluster_8h_source.html#l00024">Cluster.h:24</a></div></div>
<div class="ttc" id="classo2_1_1phos_1_1Cluster_html_a1508b4fcbb5ab7848322fbea98e6fc6d"><div class="ttname"><a href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a1508b4fcbb5ab7848322fbea98e6fc6d">o2::phos::Cluster::mCoreEnergy</a></div><div class="ttdeci">float mCoreEnergy</div><div class="ttdoc">energy in a shower core </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d50/DataFormats_2Detectors_2PHOS_2include_2DataFormatsPHOS_2Cluster_8h_source.html#l00078">Cluster.h:78</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a0cdec8e97a75ee9458b23d152bf962d4"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a></div><div class="ttdeci">GLint GLenum GLint x</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00403">glcorearb.h:403</a></div></div>
<div class="ttc" id="classo2_1_1phos_1_1FullCluster_html_a54c9efc361435168df23b35578a61e12"><div class="ttname"><a href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#a54c9efc361435168df23b35578a61e12">o2::phos::FullCluster::BinarySearch</a></div><div class="ttdeci">std::vector&lt; Digit &gt;::const_iterator BinarySearch(const std::vector&lt; Digit &gt; *container, Digit &amp;element)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d64/PHOS_2reconstruction_2src_2FullCluster_8cxx_source.html#l00249">FullCluster.cxx:249</a></div></div>
<div class="ttc" id="classo2_1_1phos_1_1FullCluster_html_abf2956ac7fa4e3f82ad4201b5384f859"><div class="ttname"><a href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#abf2956ac7fa4e3f82ad4201b5384f859">o2::phos::FullCluster::evalDispersion</a></div><div class="ttdeci">void evalDispersion()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d64/PHOS_2reconstruction_2src_2FullCluster_8cxx_source.html#l00158">FullCluster.cxx:158</a></div></div>
<div class="ttc" id="SecondaryVertex_8h_html_a7effbf82c50caa2e6b11dd6c61317195"><div class="ttname"><a href="../../dd/ddf/SecondaryVertex_8h.html#a7effbf82c50caa2e6b11dd6c61317195">energy</a></div><div class="ttdeci">float energy(float px, float py, float pz, float mass)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/ddf/SecondaryVertex_8h_source.html#l00079">SecondaryVertex.h:79</a></div></div>
<div class="ttc" id="classo2_1_1phos_1_1FullCluster_html_a71f170b58ebf892db558c3427546dcd9"><div class="ttname"><a href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#a71f170b58ebf892db558c3427546dcd9">o2::phos::FullCluster::evalLocalPosition</a></div><div class="ttdeci">void evalLocalPosition()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d64/PHOS_2reconstruction_2src_2FullCluster_8cxx_source.html#l00125">FullCluster.cxx:125</a></div></div>
<div class="ttc" id="structo2_1_1phos_1_1PHOSSimParams_html_a42277a2d8bda7b98db54fece48459ce2"><div class="ttname"><a href="../../d1/d8d/structo2_1_1phos_1_1PHOSSimParams.html#a42277a2d8bda7b98db54fece48459ce2">o2::phos::PHOSSimParams::mNLMMax</a></div><div class="ttdeci">int mNLMMax</div><div class="ttdoc">Maximal number of local maxima in unfolding. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d62/PHOSSimParams_8h_source.html#l00062">PHOSSimParams.h:62</a></div></div>
<div class="ttc" id="qconfigoptions_8h_html_a2b8298cdaa115e10085952184e21fa2f"><div class="ttname"><a href="../../d8/de9/qconfigoptions_8h.html#a2b8298cdaa115e10085952184e21fa2f">threshold</a></div><div class="ttdeci">Run track merging Number of iterations to Number of iterations to Number of initial iterations excluded from const char Directory with events to Number of OMP threads to Show standalone event Enable tracking Run event generator Use way track fit Create OuterParam Process continuous timeframe data Factor to apply to all memory scalers Automatically register input memory buffers for the GPU Use FIFO realtime Trap on floating point exceptions Field strength of solenoid Bz in kGaus Override max time bin setting for continuous data with max time bin in time frame Apply Zero Suppression when loading digits and remove those below threshold</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/de9/qconfigoptions_8h_source.html#l00163">qconfigoptions.h:163</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a744fbed01658cb96bb8ba7e85a86d1dc"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a744fbed01658cb96bb8ba7e85a86d1dc">distance</a></div><div class="ttdeci">GLsizei GLsizei GLfloat distance</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l05506">glcorearb.h:5506</a></div></div>
<div class="ttc" id="classo2_1_1phos_1_1Cluster_html_a826275e7e1a2a0fbca59d716eea34651"><div class="ttname"><a href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a826275e7e1a2a0fbca59d716eea34651">o2::phos::Cluster::mTime</a></div><div class="ttdeci">float mTime</div><div class="ttdoc">Time of the digit with maximal energy deposition. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d50/DataFormats_2Detectors_2PHOS_2include_2DataFormatsPHOS_2Cluster_8h_source.html#l00082">Cluster.h:82</a></div></div>
<div class="ttc" id="glcorearb_8h_html_adb12a0d439f32ca388b2c806150cc54d"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#adb12a0d439f32ca388b2c806150cc54d">w</a></div><div class="ttdeci">GLubyte GLubyte GLubyte GLubyte w</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00852">glcorearb.h:852</a></div></div>
<div class="ttc" id="PHOS_2base_2include_2PHOSBase_2Geometry_8h_html"><div class="ttname"><a href="../../d7/d7f/PHOS_2base_2include_2PHOSBase_2Geometry_8h.html">Geometry.h</a></div></div>
<div class="ttc" id="GPUCommonAlgorithm_8h_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d0b/GPUCommonAlgorithm_8h_source.html#l00385">GPUCommonAlgorithm.h:385</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a5ffadbbacc6b89cf6218bc43b384d3fe"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a5ffadbbacc6b89cf6218bc43b384d3fe">right</a></div><div class="ttdeci">GLdouble GLdouble right</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l04077">glcorearb.h:4077</a></div></div>
<div class="ttc" id="classo2_1_1conf_1_1ConfigurableParamHelper_html_acd640717f419212c67fecff71d876d39"><div class="ttname"><a href="../../d7/d50/classo2_1_1conf_1_1ConfigurableParamHelper.html#acd640717f419212c67fecff71d876d39">o2::conf::ConfigurableParamHelper&lt; PHOSSimParams &gt;::Instance</a></div><div class="ttdeci">static const PHOSSimParams &amp; Instance()</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d6b/ConfigurableParamHelper_8h_source.html#l00073">ConfigurableParamHelper.h:73</a></div></div>
<div class="ttc" id="classo2_1_1phos_1_1Cluster_html_a828244098ee8b1061af96ccf457eb169"><div class="ttname"><a href="../../dd/d6c/classo2_1_1phos_1_1Cluster.html#a828244098ee8b1061af96ccf457eb169">o2::phos::Cluster::mLocalPosX</a></div><div class="ttdeci">float mLocalPosX</div><div class="ttdoc">Center of gravity position in local module coordunates (phi direction) </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d50/DataFormats_2Detectors_2PHOS_2include_2DataFormatsPHOS_2Cluster_8h_source.html#l00075">Cluster.h:75</a></div></div>
<div class="ttc" id="classo2_1_1phos_1_1FullCluster_html_ac81c4ef468069d8130d93db89045484c"><div class="ttname"><a href="../../dd/db5/classo2_1_1phos_1_1FullCluster.html#ac81c4ef468069d8130d93db89045484c">o2::phos::FullCluster::FullCluster</a></div><div class="ttdeci">FullCluster()=default</div></div>
<div class="ttc" id="DataFormats_2Detectors_2PHOS_2include_2DataFormatsPHOS_2Cluster_8h_html"><div class="ttname"><a href="../../d8/d50/DataFormats_2Detectors_2PHOS_2include_2DataFormatsPHOS_2Cluster_8h.html">Cluster.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_051dca18e802f8e9474f2e30d29c04e0.html">Detectors</a></li><li class="navelem"><a class="el" href="../../dir_cd3c152a7db0580c86a4c50ad0325149.html">PHOS</a></li><li class="navelem"><a class="el" href="../../dir_da16e9ad2b18bb132f2d9a9746692e88.html">reconstruction</a></li><li class="navelem"><a class="el" href="../../dir_44824022925402f34c59ab8ad8fd997a.html">src</a></li><li class="navelem"><a class="el" href="../../d3/d64/PHOS_2reconstruction_2src_2FullCluster_8cxx.html">FullCluster.cxx</a></li>
    <li class="footer">Generated on Thu Jun 4 2020 09:30:22 for Project by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
