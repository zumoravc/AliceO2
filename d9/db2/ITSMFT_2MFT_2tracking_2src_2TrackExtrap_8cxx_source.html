<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Project: /home/travis/build/AliceO2Group/AliceO2/Detectors/ITSMFT/MFT/tracking/src/TrackExtrap.cxx Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../o2_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d9/db2/ITSMFT_2MFT_2tracking_2src_2TrackExtrap_8cxx_source.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">TrackExtrap.cxx</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d9/db2/ITSMFT_2MFT_2tracking_2src_2TrackExtrap_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Copyright CERN and copyright holders of ALICE O2. This software is</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// distributed under the terms of the GNU General Public License v3 (GPL</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Version 3), copied verbatim in the file &quot;COPYING&quot;.</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// See http://alice-o2.web.cern.ch/license for full licensing information.</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// In applying this license CERN does not waive the privileges and immunities</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// granted to it by virtue of its status as an Intergovernmental Organization</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// or submit itself to any jurisdiction.</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/d52/ITSMFT_2MFT_2tracking_2include_2MFTTracking_2TrackExtrap_8h.html">MFTTracking/TrackExtrap.h</a>&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d5b/TrackParamMFT_8h.html">MFTTracking/TrackParamMFT.h</a>&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d6/d84/MathConstants_8h.html">CommonConstants/MathConstants.h</a>&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;TGeoGlobalMagField.h&gt;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;TGeoManager.h&gt;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;TGeoMaterial.h&gt;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;TGeoNode.h&gt;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;TGeoShape.h&gt;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;TMath.h&gt;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;FairMQLogger.h&gt;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">namespace </span><a class="code" href="../../d4/d7c/namespaceo2.html">o2</a></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;{</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword">namespace </span>mft</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;{</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">//__________________________________________________________________________</span></div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#a17d52e75c547fb0581cf87a4026e92d2">   35</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#a17d52e75c547fb0581cf87a4026e92d2">TrackExtrap::linearExtrapToZ</a>(<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html">TrackParamMFT</a>* trackParam, <span class="keywordtype">double</span> zEnd)</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;{</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordflow">if</span> (trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a4aa4b60b06c66f033aa59a17ec34a485">getZ</a>() == zEnd) {</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordflow">return</span>; <span class="comment">// nothing to be done if same z</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  }</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="comment">// Compute track parameters</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordtype">double</span> dZ = zEnd - trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a4aa4b60b06c66f033aa59a17ec34a485">getZ</a>();</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordtype">double</span> xSlope = trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a510daec4e44301e792a73eaf2098f52d">getPx</a>() / trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a1e651b9eb526f997ddb08e924539feb9">getPz</a>();</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordtype">double</span> ySlope = trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#ae3f1ef2242883530626f07700332890e">getPy</a>() / trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a1e651b9eb526f997ddb08e924539feb9">getPz</a>();</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#aefa990837c2904635dfaf40d0bb4880c">setX</a>(trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#aa03e0a4455a8663bb2038e138986cb34">getX</a>() + xSlope * dZ);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a4db85fccafaeb8eda2e99de70447c6d1">setY</a>(trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#aa4680f6d41dd79ffe669e0f1dcc2d1f7">getY</a>() + ySlope * dZ);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a13b8f759a46bccc224662e2949aa3509">setZ</a>(zEnd);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;}</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">//__________________________________________________________________________</span></div><div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#ac5c644732bfa0687e4b7559d898fa210">   54</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#ac5c644732bfa0687e4b7559d898fa210">TrackExtrap::linearExtrapToZCov</a>(<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html">TrackParamMFT</a>* trackParam, <span class="keywordtype">double</span> zEnd, <span class="keywordtype">bool</span> updatePropagator)</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;{</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordflow">if</span> (trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a4aa4b60b06c66f033aa59a17ec34a485">getZ</a>() == zEnd) {</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">return</span>; <span class="comment">// nothing to be done if same z</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  }</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="comment">// No need to propagate the covariance matrix if it does not exist</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordflow">if</span> (!trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#adf532289102d2a50febb706edf6e25d3">hasCovariances</a>()) {</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(WARNING) &lt;&lt; <span class="stringliteral">&quot;Covariance matrix does not exist&quot;</span>;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="comment">// Extrapolate linearly track parameters to &quot;zEnd&quot;</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#a17d52e75c547fb0581cf87a4026e92d2">linearExtrapToZ</a>(trackParam, zEnd);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  }</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="comment">// Compute track parameters</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keywordtype">double</span> dZ = zEnd - trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a4aa4b60b06c66f033aa59a17ec34a485">getZ</a>();</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordtype">double</span> xSlope = trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a510daec4e44301e792a73eaf2098f52d">getPx</a>() / trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a1e651b9eb526f997ddb08e924539feb9">getPz</a>();</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordtype">double</span> ySlope = trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#ae3f1ef2242883530626f07700332890e">getPy</a>() / trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a1e651b9eb526f997ddb08e924539feb9">getPz</a>();</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#aefa990837c2904635dfaf40d0bb4880c">setX</a>(trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#aa03e0a4455a8663bb2038e138986cb34">getX</a>() + xSlope * dZ);</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a4db85fccafaeb8eda2e99de70447c6d1">setY</a>(trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#aa4680f6d41dd79ffe669e0f1dcc2d1f7">getY</a>() + ySlope * dZ);</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a13b8f759a46bccc224662e2949aa3509">setZ</a>(zEnd);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="comment">// Calculate the jacobian related to the track parameters linear extrapolation to &quot;zEnd&quot;</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  TMatrixD jacob(5, 5);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  jacob.UnitMatrix();</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  jacob(0, 1) = dZ;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  jacob(2, 3) = dZ;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="comment">// Extrapolate track parameter covariances to &quot;zEnd&quot;</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  TMatrixD tmp(trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a2d7c0beb346712d52e02f31e333b5941">getCovariances</a>(), TMatrixD::kMultTranspose, jacob);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  TMatrixD tmp2(jacob, TMatrixD::kMult, tmp);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a0aa2f9b07e2b447ab54669d43a95738a">setCovariances</a>(tmp2);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="comment">// Update the propagator if required</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordflow">if</span> (updatePropagator) {</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a3be0f51077942099d99d3c6d9d856498">updatePropagator</a>(jacob);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  }</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;}</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">//__________________________________________________________________________</span></div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#aebaa710c219e74e0a1ec505cd5252fd4">   97</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#aebaa710c219e74e0a1ec505cd5252fd4">TrackExtrap::quadraticExtrapToZ</a>(<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html">TrackParamMFT</a>* trackParam, <span class="keywordtype">double</span> zEnd)</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;{</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordflow">if</span> (trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a4aa4b60b06c66f033aa59a17ec34a485">getZ</a>() == zEnd) {</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">return</span>; <span class="comment">// nothing to be done if same z</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  }</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="comment">// Compute track parameters</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordtype">double</span> dZ = (zEnd - trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a4aa4b60b06c66f033aa59a17ec34a485">getZ</a>());</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a98ac434677655cc8438bb72de2719f39">x0</a> = trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#aa03e0a4455a8663bb2038e138986cb34">getX</a>();</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#ae7f97ed6c9c8e502fcbc44c7cb8a8312">y0</a> = trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#aa4680f6d41dd79ffe669e0f1dcc2d1f7">getY</a>();</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordtype">double</span> phi0 = trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a2121cd0f6afba0233fc474b25f2fc1a5">getPhi</a>();</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordtype">double</span> cosphi0, sinphi0;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <a class="code" href="../../d0/d28/namespaceo2_1_1utils.html#a52ae26374f6142ee73fe7c3f79d86145">o2::utils::sincos</a>(phi0, sinphi0, cosphi0);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordtype">double</span> invtanl0 = 1.0 / trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a014e53ae748a2fff7e86247343ebf902">getTanl</a>();</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  ;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordtype">double</span> invqpt0 = trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#af06a7cd0f8f0d98a20e6249e8e803e35">getInvQPt</a>();</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keyword">auto</span> Hz = <a class="code" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#ad323a4841ccfe7e34e8b6cacf875d5c9">getSignBz</a>();</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordtype">double</span> k = <a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215">TMath::Abs</a>(<a class="code" href="../../d2/d3a/namespaceo2_1_1constants_1_1math.html#a2b949225a2d77538706c290b9c07ae8e">o2::constants::math::B2C</a> * <a class="code" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#ada1f82f0847fe881a1a2803d47190d6e">getBz</a>());</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a0788d3762d0c3c76e4c094d8078b4c27">n</a> = dZ * invtanl0;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordtype">double</span> theta = -invqpt0 * dZ * k * invtanl0;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keywordtype">double</span> deltax = n * cosphi0 - 0.5 * n * theta * Hz * sinphi0;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keywordtype">double</span> deltay = n * sinphi0 + 0.5 * n * theta * Hz * cosphi0;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a> = x0 + deltax;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a74d80fd479c0f6d0153c709949a089ef">y</a> = y0 + deltay;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordtype">double</span> phi = phi0 + theta;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#aefa990837c2904635dfaf40d0bb4880c">setX</a>(x);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a4db85fccafaeb8eda2e99de70447c6d1">setY</a>(y);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a13b8f759a46bccc224662e2949aa3509">setZ</a>(zEnd);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#aec47abdb398b20c51bea04d084af6d9b">setPhi</a>(phi);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;}</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">//__________________________________________________________________________</span></div><div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#a9c3d4f1fc76dd3037ee87d6db2262dc5">  134</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#a9c3d4f1fc76dd3037ee87d6db2262dc5">TrackExtrap::helixExtrapToZ</a>(<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html">TrackParamMFT</a>* trackParam, <span class="keywordtype">double</span> zEnd)</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;{</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="keywordflow">if</span> (trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a4aa4b60b06c66f033aa59a17ec34a485">getZ</a>() == zEnd) {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">return</span>; <span class="comment">// nothing to be done if same z</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="comment">// Compute track parameters</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordtype">double</span> dZ = (zEnd - trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a4aa4b60b06c66f033aa59a17ec34a485">getZ</a>());</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a98ac434677655cc8438bb72de2719f39">x0</a> = trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#aa03e0a4455a8663bb2038e138986cb34">getX</a>();</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#ae7f97ed6c9c8e502fcbc44c7cb8a8312">y0</a> = trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#aa4680f6d41dd79ffe669e0f1dcc2d1f7">getY</a>();</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordtype">double</span> px0 = trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a510daec4e44301e792a73eaf2098f52d">getPx</a>();</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordtype">double</span> py0 = trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#ae3f1ef2242883530626f07700332890e">getPy</a>();</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keywordtype">double</span> invtanl0 = 1.0 / trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a014e53ae748a2fff7e86247343ebf902">getTanl</a>();</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  ;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keywordtype">double</span> invqpt0 = trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#af06a7cd0f8f0d98a20e6249e8e803e35">getInvQPt</a>();</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keyword">auto</span> <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a72a15f0e985725c69b07bf03c3818782">q</a> = trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#afbb65a58afcbc2a5266297bf99022e0b">getCharge</a>();</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keyword">auto</span> Hz = <a class="code" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#ad323a4841ccfe7e34e8b6cacf875d5c9">getSignBz</a>();</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordtype">double</span> k = <a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215">TMath::Abs</a>(<a class="code" href="../../d2/d3a/namespaceo2_1_1constants_1_1math.html#a2b949225a2d77538706c290b9c07ae8e">o2::constants::math::B2C</a> * <a class="code" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#ada1f82f0847fe881a1a2803d47190d6e">getBz</a>());</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keyword">auto</span> invk = 1.0 / k;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordtype">double</span> theta = -invqpt0 * dZ * k * invtanl0;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordtype">double</span> costheta, sintheta;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <a class="code" href="../../d0/d28/namespaceo2_1_1utils.html#a52ae26374f6142ee73fe7c3f79d86145">o2::utils::sincos</a>(theta, sintheta, costheta);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keywordtype">double</span> deltax = Hz * py0 * invk * (1.0 - costheta) - px0 * <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a72a15f0e985725c69b07bf03c3818782">q</a> * invk * sintheta;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordtype">double</span> deltay = -Hz * px0 * invk * (1.0 - costheta) - py0 * <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a72a15f0e985725c69b07bf03c3818782">q</a> * invk * sintheta;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a> = x0 + deltax;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a74d80fd479c0f6d0153c709949a089ef">y</a> = y0 + deltay;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keywordtype">double</span> phi = trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a2121cd0f6afba0233fc474b25f2fc1a5">getPhi</a>() + theta;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#aefa990837c2904635dfaf40d0bb4880c">setX</a>(x);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a4db85fccafaeb8eda2e99de70447c6d1">setY</a>(y);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a13b8f759a46bccc224662e2949aa3509">setZ</a>(zEnd);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#aec47abdb398b20c51bea04d084af6d9b">setPhi</a>(phi);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;}</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">//__________________________________________________________________________</span></div><div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#ae2324f77141cbcc30a8e023a3a7f1313">  173</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#ae2324f77141cbcc30a8e023a3a7f1313">TrackExtrap::quadraticExtrapToZCov</a>(<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html">TrackParamMFT</a>* trackParam, <span class="keywordtype">double</span> zEnd, <span class="keywordtype">bool</span> updatePropagator)</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;{</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="comment">// Calculate the jacobian related to the track parameters extrapolated to &quot;zEnd&quot;</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keywordtype">double</span> dZ = (zEnd - trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a4aa4b60b06c66f033aa59a17ec34a485">getZ</a>());</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="keywordtype">double</span> phi0 = trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a2121cd0f6afba0233fc474b25f2fc1a5">getPhi</a>();</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordtype">double</span> tanl0 = trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a014e53ae748a2fff7e86247343ebf902">getTanl</a>();</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordtype">double</span> invtanl0 = 1.0 / tanl0;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keywordtype">double</span> invqpt0 = trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#af06a7cd0f8f0d98a20e6249e8e803e35">getInvQPt</a>();</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keywordtype">double</span> cosphi0, sinphi0;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <a class="code" href="../../d0/d28/namespaceo2_1_1utils.html#a52ae26374f6142ee73fe7c3f79d86145">o2::utils::sincos</a>(phi0, sinphi0, cosphi0);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keywordtype">double</span> k = <a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215">TMath::Abs</a>(<a class="code" href="../../d2/d3a/namespaceo2_1_1constants_1_1math.html#a2b949225a2d77538706c290b9c07ae8e">o2::constants::math::B2C</a> * <a class="code" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#ada1f82f0847fe881a1a2803d47190d6e">getBz</a>());</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a0788d3762d0c3c76e4c094d8078b4c27">n</a> = dZ * invtanl0;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d4/dc3/classfloat.html">m</a> = n * invtanl0;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordtype">double</span> theta = -invqpt0 * dZ * k * invtanl0;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keyword">auto</span> Hz = <a class="code" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#ad323a4841ccfe7e34e8b6cacf875d5c9">getSignBz</a>();</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <a class="code" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#aebaa710c219e74e0a1ec505cd5252fd4">quadraticExtrapToZ</a>(trackParam, zEnd);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="comment">// Calculate Jacobian</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  TMatrixD jacob(5, 5);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  jacob.UnitMatrix();</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  jacob(0, 2) = -n * theta * 0.5 * Hz * cosphi0 - n * sinphi0;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  jacob(0, 3) = Hz * m * theta * sinphi0 - m * cosphi0;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  jacob(0, 4) = k * m * 0.5 * Hz * dZ * sinphi0;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  jacob(1, 2) = -n * theta * 0.5 * Hz * sinphi0 + n * cosphi0;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  jacob(1, 3) = -Hz * m * theta * cosphi0 - m * sinphi0;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  jacob(1, 4) = -k * m * 0.5 * Hz * dZ * cosphi0;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  jacob(2, 3) = -theta * invtanl0;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  jacob(2, 4) = -k * <a class="code" href="../../dc/da3/glcorearb_8h.html#a0788d3762d0c3c76e4c094d8078b4c27">n</a>;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="comment">// Extrapolate track parameter covariances to &quot;zEnd&quot;</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  TMatrixD tmp(trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a2d7c0beb346712d52e02f31e333b5941">getCovariances</a>(), TMatrixD::kMultTranspose, jacob);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  TMatrixD tmp2(jacob, TMatrixD::kMult, tmp);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a0aa2f9b07e2b447ab54669d43a95738a">setCovariances</a>(tmp2);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="comment">// Update the propagator if required</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keywordflow">if</span> (updatePropagator) {</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a3be0f51077942099d99d3c6d9d856498">updatePropagator</a>(jacob);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  }</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;}</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">//__________________________________________________________________________</span></div><div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#a2be8d4b0655a03204007e725a0bd93c4">  216</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#a2be8d4b0655a03204007e725a0bd93c4">TrackExtrap::helixExtrapToZCov</a>(<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html">TrackParamMFT</a>* trackParam, <span class="keywordtype">double</span> zEnd, <span class="keywordtype">bool</span> updatePropagator)</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;{</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="comment">// Calculate the jacobian related to the track parameters extrapolated to &quot;zEnd&quot;</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keywordtype">double</span> dZ = (zEnd - trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a4aa4b60b06c66f033aa59a17ec34a485">getZ</a>());</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keywordtype">double</span> phi0 = trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a2121cd0f6afba0233fc474b25f2fc1a5">getPhi</a>();</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keywordtype">double</span> tanl0 = trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a014e53ae748a2fff7e86247343ebf902">getTanl</a>();</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="keywordtype">double</span> invtanl0 = 1.0 / tanl0;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="keywordtype">double</span> invqpt0 = trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#af06a7cd0f8f0d98a20e6249e8e803e35">getInvQPt</a>();</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keyword">auto</span> qpt0 = 1.0 / invqpt0;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="keywordtype">double</span> cosphi0, sinphi0;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <a class="code" href="../../d0/d28/namespaceo2_1_1utils.html#a52ae26374f6142ee73fe7c3f79d86145">o2::utils::sincos</a>(phi0, sinphi0, cosphi0);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="keywordtype">double</span> k = <a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215">TMath::Abs</a>(<a class="code" href="../../d2/d3a/namespaceo2_1_1constants_1_1math.html#a2b949225a2d77538706c290b9c07ae8e">o2::constants::math::B2C</a> * <a class="code" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#ada1f82f0847fe881a1a2803d47190d6e">getBz</a>());</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keywordtype">double</span> invk = 1.0 / k;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keywordtype">double</span> theta = -invqpt0 * dZ * k * invtanl0;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keywordtype">double</span> costheta, sintheta;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <a class="code" href="../../d0/d28/namespaceo2_1_1utils.html#a52ae26374f6142ee73fe7c3f79d86145">o2::utils::sincos</a>(theta, sintheta, costheta);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keyword">auto</span> Hz = <a class="code" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#ad323a4841ccfe7e34e8b6cacf875d5c9">getSignBz</a>();</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keyword">auto</span> L = qpt0 * qpt0 * invk;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keyword">auto</span> <a class="code" href="../../d4/d54/GPUReconstructionKernels_8h.html#ab0127665b2e65e79a1e2523951eb0dbd">N</a> = dZ * invtanl0 * qpt0;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keyword">auto</span> O = sintheta * cosphi0;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keyword">auto</span> <a class="code" href="../../db/d72/classP.html">P</a> = sinphi0 * costheta;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keyword">auto</span> R = sinphi0 * sintheta;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keyword">auto</span> <a class="code" href="../../d1/d6a/structS.html">S</a> = cosphi0 * costheta;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keyword">auto</span> Y = sinphi0 * qpt0 * invk;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keyword">auto</span> <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a77854b1fceea9fca2fa33736d20fae6a">X</a> = cosphi0 * qpt0 * invk;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keyword">auto</span> YC = Y * costheta;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="keyword">auto</span> YS = Y * sintheta;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="keyword">auto</span> XC = <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a77854b1fceea9fca2fa33736d20fae6a">X</a> * costheta;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="keyword">auto</span> XS = <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a77854b1fceea9fca2fa33736d20fae6a">X</a> * sintheta;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keyword">auto</span> T = qpt0 * costheta;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keyword">auto</span> U = qpt0 * sintheta;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="keyword">auto</span> V = qpt0;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a0788d3762d0c3c76e4c094d8078b4c27">n</a> = dZ * invtanl0;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d4/dc3/classfloat.html">m</a> = n * invtanl0;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="comment">// Extrapolate track parameters to &quot;zEnd&quot;</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <a class="code" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#a9c3d4f1fc76dd3037ee87d6db2262dc5">helixExtrapToZ</a>(trackParam, zEnd);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="comment">// Calculate Jacobian</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  TMatrixD jacob(5, 5);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  jacob.UnitMatrix();</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  jacob(0, 2) = Hz * <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a77854b1fceea9fca2fa33736d20fae6a">X</a> - Hz * XC + YS;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  jacob(0, 3) = Hz * R * m - <a class="code" href="../../d1/d6a/structS.html">S</a> * <a class="code" href="../../dc/da3/glcorearb_8h.html#a11941354c1d09e70ec63bde35fc79d4f">m</a>;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  jacob(0, 4) = -Hz * <a class="code" href="../../d4/d54/GPUReconstructionKernels_8h.html#ab0127665b2e65e79a1e2523951eb0dbd">N</a> * R + Hz * T * Y - Hz * V * Y + <a class="code" href="../../d4/d54/GPUReconstructionKernels_8h.html#ab0127665b2e65e79a1e2523951eb0dbd">N</a> * <a class="code" href="../../d1/d6a/structS.html">S</a> + U * <a class="code" href="../../d8/de9/qconfigoptions_8h.html#a77854b1fceea9fca2fa33736d20fae6a">X</a>;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  jacob(1, 2) = Hz * Y - Hz * YC - XS;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  jacob(0, 3) = -Hz * O * m - <a class="code" href="../../db/d72/classP.html">P</a> * <a class="code" href="../../dc/da3/glcorearb_8h.html#a11941354c1d09e70ec63bde35fc79d4f">m</a>;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  jacob(0, 4) = -Hz * <a class="code" href="../../d4/d54/GPUReconstructionKernels_8h.html#ab0127665b2e65e79a1e2523951eb0dbd">N</a> * O - Hz * T * X + Hz * V * X + <a class="code" href="../../d4/d54/GPUReconstructionKernels_8h.html#ab0127665b2e65e79a1e2523951eb0dbd">N</a> * <a class="code" href="../../db/d72/classP.html">P</a> + U * Y;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  jacob(2, 3) = -theta * invtanl0;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  jacob(2, 4) = -k * <a class="code" href="../../dc/da3/glcorearb_8h.html#a0788d3762d0c3c76e4c094d8078b4c27">n</a>;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="comment">// Extrapolate track parameter covariances to &quot;zEnd&quot;</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  TMatrixD tmp(trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a2d7c0beb346712d52e02f31e333b5941">getCovariances</a>(), TMatrixD::kMultTranspose, jacob);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  TMatrixD tmp2(jacob, TMatrixD::kMult, tmp);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a0aa2f9b07e2b447ab54669d43a95738a">setCovariances</a>(tmp2);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="comment">// Update the propagator if required</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keywordflow">if</span> (updatePropagator) {</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a3be0f51077942099d99d3c6d9d856498">updatePropagator</a>(jacob);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  }</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;}</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">//__________________________________________________________________________</span></div><div class="line"><a name="l00279"></a><span class="lineno"><a class="line" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#ac8a5a361cf5851926b1077d6c32a23d2">  279</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#ac8a5a361cf5851926b1077d6c32a23d2">TrackExtrap::extrapToZ</a>(<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html">TrackParamMFT</a>* trackParam, <span class="keywordtype">double</span> zEnd, <span class="keywordtype">bool</span> <a class="code" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#a06c8cdcb795e0a7faaa161e4fea15336">isFieldON</a>)</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;{</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="keywordflow">if</span> (!isFieldON) {</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <a class="code" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#a17d52e75c547fb0581cf87a4026e92d2">linearExtrapToZ</a>(trackParam, zEnd);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#aebaa710c219e74e0a1ec505cd5252fd4">quadraticExtrapToZ</a>(trackParam, zEnd);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  }</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;}</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">//__________________________________________________________________________</span></div><div class="line"><a name="l00294"></a><span class="lineno"><a class="line" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#a5a6002ae00dbbc4e5f397194b678f4b7">  294</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#a5a6002ae00dbbc4e5f397194b678f4b7">TrackExtrap::extrapToZCov</a>(<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html">TrackParamMFT</a>* trackParam, <span class="keywordtype">double</span> zEnd, <span class="keywordtype">bool</span> updatePropagator, <span class="keywordtype">bool</span> <a class="code" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#a06c8cdcb795e0a7faaa161e4fea15336">isFieldON</a>)</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;{</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="keyword">auto</span>&amp; mftTrackingParam = <a class="code" href="../../d7/d50/classo2_1_1conf_1_1ConfigurableParamHelper.html#acd640717f419212c67fecff71d876d39">MFTTrackingParam::Instance</a>();</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="keywordflow">if</span> (!isFieldON) { <span class="comment">// linear extrapolation if no magnetic field</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <a class="code" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#ac5c644732bfa0687e4b7559d898fa210">linearExtrapToZCov</a>(trackParam, zEnd, updatePropagator);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">// Extrapolate track parameters to &quot;zEnd&quot;</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordflow">switch</span> (mftTrackingParam.trackmodel) {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d4/d8c/namespaceo2_1_1mft.html#a184dac7fced8f4d6c3a220982569e3dfaf1d8a08762484deac3c72ddf105822a7">Helix</a>:</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <a class="code" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#a2be8d4b0655a03204007e725a0bd93c4">helixExtrapToZCov</a>(trackParam, zEnd, updatePropagator);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d4/d8c/namespaceo2_1_1mft.html#a184dac7fced8f4d6c3a220982569e3dfa0d0670aa035bffdac2d0600106e9b5b8">Quadratic</a>:</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <a class="code" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#ae2324f77141cbcc30a8e023a3a7f1313">quadraticExtrapToZCov</a>(trackParam, zEnd, updatePropagator);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    }</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  }</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;}</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">//__________________________________________________________________________</span></div><div class="line"><a name="l00321"></a><span class="lineno"><a class="line" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#a7394d9bdeb7de7379de3f938e1d36ea9">  321</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#a7394d9bdeb7de7379de3f938e1d36ea9">TrackExtrap::addMCSEffect</a>(<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html">TrackParamMFT</a>* trackParam, <span class="keywordtype">double</span> dZ, <span class="keywordtype">double</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a98ac434677655cc8438bb72de2719f39">x0</a>, <span class="keywordtype">bool</span> <a class="code" href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#a06c8cdcb795e0a7faaa161e4fea15336">isFieldON</a>)</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;{</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordtype">double</span> xSlope = trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a510daec4e44301e792a73eaf2098f52d">getPx</a>() / trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a1e651b9eb526f997ddb08e924539feb9">getPz</a>();</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keywordtype">double</span> ySlope = trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#ae3f1ef2242883530626f07700332890e">getPy</a>() / trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a1e651b9eb526f997ddb08e924539feb9">getPz</a>();</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="keywordtype">double</span> inverseMomentum = trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a3abfafea775118fac5adef2e227ba10b">getInverseMomentum</a>();</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="keywordtype">double</span> inverseTotalMomentum2 = inverseMomentum * inverseMomentum * (1.0 + ySlope * ySlope) /</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                                 (1.0 + ySlope * ySlope + xSlope * xSlope);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="comment">// Path length in the material</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="keywordtype">double</span> signedPathLength = dZ * TMath::Sqrt(1.0 + ySlope * ySlope + xSlope * xSlope);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keywordtype">double</span> pathLengthOverX0 = (x0 &gt; 0.) ? <a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215">TMath::Abs</a>(signedPathLength) / <a class="code" href="../../dc/da3/glcorearb_8h.html#a98ac434677655cc8438bb72de2719f39">x0</a> : <a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215">TMath::Abs</a>(signedPathLength);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="comment">// relativistic velocity</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="keywordtype">double</span> velo = 1.;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="comment">// Angular dispersion square of the track (variance) in a plane perpendicular to the trajectory</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keywordtype">double</span> theta02 = 0.0136 / velo * (1 + 0.038 * <a class="code" href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739ae557705aebad579817e10aa4fdcfaa00">TMath::Log</a>(pathLengthOverX0));</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  theta02 *= theta02 * inverseTotalMomentum2 * pathLengthOverX0;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="keywordtype">double</span> varCoor = (x0 &gt; 0.) ? signedPathLength * signedPathLength * theta02 / 3. : 0.;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="keywordtype">double</span> varSlop = theta02;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="keywordtype">double</span> covCorrSlope = (x0 &gt; 0.) ? signedPathLength * theta02 * 0.5 : 0.;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="comment">// Set MCS covariance matrix</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  TMatrixD newParamCov(trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a2d7c0beb346712d52e02f31e333b5941">getCovariances</a>());</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="comment">// Non bending plane    // FIXME: Update param coordinate system</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  newParamCov(0, 0) += varCoor;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  newParamCov(0, 1) += covCorrSlope;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  newParamCov(1, 0) += covCorrSlope;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  newParamCov(1, 1) += varCoor;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="comment">// Bending plane</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  newParamCov(2, 2) += varSlop;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  newParamCov(2, 3) += covCorrSlope;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  newParamCov(3, 2) += covCorrSlope;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  newParamCov(3, 3) += varSlop;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="comment">// Set momentum related covariances if B!=0</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="keywordflow">if</span> (isFieldON) {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="comment">// compute derivative d(q/Pxy) / dSlopeX and d(q/Pxy) / dSlopeY</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordtype">double</span> dqPxydSlopeX =</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      inverseMomentum * xSlope / (1. + xSlope * xSlope + ySlope * ySlope);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordtype">double</span> dqPxydSlopeY = -inverseMomentum * xSlope * xSlope * ySlope /</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                          (1. + ySlope * ySlope) /</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                          (1. + xSlope * xSlope + ySlope * ySlope);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="comment">// Inverse bending momentum (due to dependences with bending and non bending slopes)</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    newParamCov(4, 0) += dqPxydSlopeX * covCorrSlope;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    newParamCov(0, 4) += dqPxydSlopeX * covCorrSlope;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    newParamCov(4, 1) += dqPxydSlopeX * varSlop;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    newParamCov(1, 4) += dqPxydSlopeX * varSlop;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    newParamCov(4, 2) += dqPxydSlopeY * covCorrSlope;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    newParamCov(2, 4) += dqPxydSlopeY * covCorrSlope;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    newParamCov(4, 3) += dqPxydSlopeY * varSlop;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    newParamCov(3, 4) += dqPxydSlopeY * varSlop;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    newParamCov(4, 4) += (dqPxydSlopeX * dqPxydSlopeX + dqPxydSlopeY * dqPxydSlopeY) * varSlop;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  }</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="comment">// Set new covariances</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  trackParam-&gt;<a class="code" href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a0aa2f9b07e2b447ab54669d43a95738a">setCovariances</a>(newParamCov);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;}</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;} <span class="comment">// namespace mft</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;} <span class="comment">// namespace o2</span></div><div class="ttc" id="classo2_1_1mft_1_1TrackParamMFT_html_a2d7c0beb346712d52e02f31e333b5941"><div class="ttname"><a href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a2d7c0beb346712d52e02f31e333b5941">o2::mft::TrackParamMFT::getCovariances</a></div><div class="ttdeci">const TMatrixD &amp; getCovariances() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da7/TrackParamMFT_8cxx_source.html#l00138">TrackParamMFT.cxx:138</a></div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackParamMFT_html_adf532289102d2a50febb706edf6e25d3"><div class="ttname"><a href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#adf532289102d2a50febb706edf6e25d3">o2::mft::TrackParamMFT::hasCovariances</a></div><div class="ttdeci">Bool_t hasCovariances() const</div><div class="ttdoc">return kTRUE if the covariance matrix exist, kFALSE if not </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5b/TrackParamMFT_8h_source.html#l00095">TrackParamMFT.h:95</a></div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackExtrap_html_a2be8d4b0655a03204007e725a0bd93c4"><div class="ttname"><a href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#a2be8d4b0655a03204007e725a0bd93c4">o2::mft::TrackExtrap::helixExtrapToZCov</a></div><div class="ttdeci">void helixExtrapToZCov(TrackParamMFT *TrackParamMFT, double zEnd, bool updatePropagator)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db2/ITSMFT_2MFT_2tracking_2src_2TrackExtrap_8cxx_source.html#l00216">TrackExtrap.cxx:216</a></div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackParamMFT_html_aefa990837c2904635dfaf40d0bb4880c"><div class="ttname"><a href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#aefa990837c2904635dfaf40d0bb4880c">o2::mft::TrackParamMFT::setX</a></div><div class="ttdeci">void setX(Double_t x)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5b/TrackParamMFT_8h_source.html#l00050">TrackParamMFT.h:50</a></div></div>
<div class="ttc" id="namespaceo2_html"><div class="ttname"><a href="../../d4/d7c/namespaceo2.html">o2</a></div><div class="ttdoc">information complementary to a CCDB object (path, metadata, startTimeValidity, endTimeValidity etc) ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d24/BitstreamReader_8h_source.html#l00022">BitstreamReader.h:22</a></div></div>
<div class="ttc" id="qconfigoptions_8h_html_a72a15f0e985725c69b07bf03c3818782"><div class="ttname"><a href="../../d8/de9/qconfigoptions_8h.html#a72a15f0e985725c69b07bf03c3818782">q</a></div><div class="ttdeci">Visualize clusters only Timeframe settings Average distance in cm of events merged into Randomize distance around average distance of merged events Simulate correct bunch interactions instead of placing only the average number of events A value [n] sets TFlen for [n] collisions in Number of bunches per train Number of bunch trains Instantaneous interaction rate Do not simulate border Total number of collisions to be placed in the interior of all time Do not select random but walk over array of events in stride steps h q</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/de9/qconfigoptions_8h_source.html#l00040">qconfigoptions.h:40</a></div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackParamMFT_html_aa03e0a4455a8663bb2038e138986cb34"><div class="ttname"><a href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#aa03e0a4455a8663bb2038e138986cb34">o2::mft::TrackParamMFT::getX</a></div><div class="ttdeci">Double_t getX() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5b/TrackParamMFT_8h_source.html#l00049">TrackParamMFT.h:49</a></div></div>
<div class="ttc" id="GPUCommonLogger_8h_html_aea3d0edfe28fc0325c636b2b33f0527a"><div class="ttname"><a href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a></div><div class="ttdeci">#define LOG(type)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d5b/GPUCommonLogger_8h_source.html#l00028">GPUCommonLogger.h:28</a></div></div>
<div class="ttc" id="classP_html"><div class="ttname"><a href="../../db/d72/classP.html">P</a></div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackParamMFT_html_ae3f1ef2242883530626f07700332890e"><div class="ttname"><a href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#ae3f1ef2242883530626f07700332890e">o2::mft::TrackParamMFT::getPy</a></div><div class="ttdeci">Double_t getPy() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5b/TrackParamMFT_8h_source.html#l00069">TrackParamMFT.h:69</a></div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackParamMFT_html_a13b8f759a46bccc224662e2949aa3509"><div class="ttname"><a href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a13b8f759a46bccc224662e2949aa3509">o2::mft::TrackParamMFT::setZ</a></div><div class="ttdeci">void setZ(Double_t z)</div><div class="ttdoc">set Z coordinate (cm) </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5b/TrackParamMFT_8h_source.html#l00048">TrackParamMFT.h:48</a></div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackParamMFT_html_a1e651b9eb526f997ddb08e924539feb9"><div class="ttname"><a href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a1e651b9eb526f997ddb08e924539feb9">o2::mft::TrackParamMFT::getPz</a></div><div class="ttdeci">Double_t getPz() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5b/TrackParamMFT_8h_source.html#l00072">TrackParamMFT.h:72</a></div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackExtrap_html_a06c8cdcb795e0a7faaa161e4fea15336"><div class="ttname"><a href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#a06c8cdcb795e0a7faaa161e4fea15336">o2::mft::TrackExtrap::isFieldON</a></div><div class="ttdeci">const bool isFieldON()</div><div class="ttdoc">Return true if the field is switched ON. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d52/ITSMFT_2MFT_2tracking_2include_2MFTTracking_2TrackExtrap_8h_source.html#l00048">TrackExtrap.h:48</a></div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackExtrap_html_ada1f82f0847fe881a1a2803d47190d6e"><div class="ttname"><a href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#ada1f82f0847fe881a1a2803d47190d6e">o2::mft::TrackExtrap::getBz</a></div><div class="ttdeci">const float getBz() const</div><div class="ttdoc">Set the magnetic field for the MFT. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d52/ITSMFT_2MFT_2tracking_2include_2MFTTracking_2TrackExtrap_8h_source.html#l00045">TrackExtrap.h:45</a></div></div>
<div class="ttc" id="structS_html"><div class="ttname"><a href="../../d1/d6a/structS.html">S</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df1/cxx14-test-aggregate-initialization_8cxx_source.html#l00017">cxx14-test-aggregate-initialization.cxx:17</a></div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackParamMFT_html_afbb65a58afcbc2a5266297bf99022e0b"><div class="ttname"><a href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#afbb65a58afcbc2a5266297bf99022e0b">o2::mft::TrackParamMFT::getCharge</a></div><div class="ttdeci">Double_t getCharge() const</div><div class="ttdoc">return the charge (assumed forward motion) </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5b/TrackParamMFT_8h_source.html#l00079">TrackParamMFT.h:79</a></div></div>
<div class="ttc" id="ITSMFT_2MFT_2tracking_2include_2MFTTracking_2TrackExtrap_8h_html"><div class="ttname"><a href="../../dc/d52/ITSMFT_2MFT_2tracking_2include_2MFTTracking_2TrackExtrap_8h.html">TrackExtrap.h</a></div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackParamMFT_html_a4db85fccafaeb8eda2e99de70447c6d1"><div class="ttname"><a href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a4db85fccafaeb8eda2e99de70447c6d1">o2::mft::TrackParamMFT::setY</a></div><div class="ttdeci">void setY(Double_t y)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5b/TrackParamMFT_8h_source.html#l00053">TrackParamMFT.h:53</a></div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackExtrap_html_ac8a5a361cf5851926b1077d6c32a23d2"><div class="ttname"><a href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#ac8a5a361cf5851926b1077d6c32a23d2">o2::mft::TrackExtrap::extrapToZ</a></div><div class="ttdeci">bool extrapToZ(TrackParamMFT *TrackParamMFT, double zEnd, bool isFieldON=true)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db2/ITSMFT_2MFT_2tracking_2src_2TrackExtrap_8cxx_source.html#l00279">TrackExtrap.cxx:279</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a11941354c1d09e70ec63bde35fc79d4f"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a11941354c1d09e70ec63bde35fc79d4f">m</a></div><div class="ttdeci">const GLfloat * m</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l04066">glcorearb.h:4066</a></div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackParamMFT_html_a0aa2f9b07e2b447ab54669d43a95738a"><div class="ttname"><a href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a0aa2f9b07e2b447ab54669d43a95738a">o2::mft::TrackParamMFT::setCovariances</a></div><div class="ttdeci">void setCovariances(const TMatrixD &amp;covariances)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da7/TrackParamMFT_8cxx_source.html#l00149">TrackParamMFT.cxx:149</a></div></div>
<div class="ttc" id="glcorearb_8h_html_ae7f97ed6c9c8e502fcbc44c7cb8a8312"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#ae7f97ed6c9c8e502fcbc44c7cb8a8312">y0</a></div><div class="ttdeci">GLuint GLfloat GLfloat y0</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l05034">glcorearb.h:5034</a></div></div>
<div class="ttc" id="namespaceo2_1_1utils_html_a52ae26374f6142ee73fe7c3f79d86145"><div class="ttname"><a href="../../d0/d28/namespaceo2_1_1utils.html#a52ae26374f6142ee73fe7c3f79d86145">o2::utils::sincos</a></div><div class="ttdeci">void sincos(double ang, double &amp;s, double &amp;c)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d52/Common_2MathUtils_2include_2MathUtils_2Utils_8h_source.html#l00075">Utils.h:75</a></div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackParamMFT_html_a510daec4e44301e792a73eaf2098f52d"><div class="ttname"><a href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a510daec4e44301e792a73eaf2098f52d">o2::mft::TrackParamMFT::getPx</a></div><div class="ttdeci">Double_t getPx() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5b/TrackParamMFT_8h_source.html#l00066">TrackParamMFT.h:66</a></div></div>
<div class="ttc" id="namespaceo2_1_1mft_html_a184dac7fced8f4d6c3a220982569e3dfaf1d8a08762484deac3c72ddf105822a7"><div class="ttname"><a href="../../d4/d8c/namespaceo2_1_1mft.html#a184dac7fced8f4d6c3a220982569e3dfaf1d8a08762484deac3c72ddf105822a7">o2::mft::Helix</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d87/MFTTrackingParam_8h_source.html#l00031">MFTTrackingParam.h:31</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a0788d3762d0c3c76e4c094d8078b4c27"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a0788d3762d0c3c76e4c094d8078b4c27">n</a></div><div class="ttdeci">GLdouble n</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l01982">glcorearb.h:1982</a></div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackExtrap_html_a5a6002ae00dbbc4e5f397194b678f4b7"><div class="ttname"><a href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#a5a6002ae00dbbc4e5f397194b678f4b7">o2::mft::TrackExtrap::extrapToZCov</a></div><div class="ttdeci">void extrapToZCov(TrackParamMFT *TrackParamMFT, double zEnd, bool updatePropagator=false, bool isFieldON=true)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db2/ITSMFT_2MFT_2tracking_2src_2TrackExtrap_8cxx_source.html#l00294">TrackExtrap.cxx:294</a></div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackParamMFT_html_a2121cd0f6afba0233fc474b25f2fc1a5"><div class="ttname"><a href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a2121cd0f6afba0233fc474b25f2fc1a5">o2::mft::TrackParamMFT::getPhi</a></div><div class="ttdeci">Double_t getPhi() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5b/TrackParamMFT_8h_source.html#l00056">TrackParamMFT.h:56</a></div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackParamMFT_html"><div class="ttname"><a href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html">o2::mft::TrackParamMFT</a></div><div class="ttdoc">track parameters for internal use </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5b/TrackParamMFT_8h_source.html#l00034">TrackParamMFT.h:34</a></div></div>
<div class="ttc" id="qconfigoptions_8h_html_a77854b1fceea9fca2fa33736d20fae6a"><div class="ttname"><a href="../../d8/de9/qconfigoptions_8h.html#a77854b1fceea9fca2fa33736d20fae6a">X</a></div><div class="ttdeci">Visualize clusters only Timeframe settings Average distance in cm of events merged into Randomize distance around average distance of merged events Simulate correct bunch interactions instead of placing only the average number of events A value [n] sets TFlen for [n] collisions in Number of bunches per train Number of bunch trains Instantaneous interaction rate Do not simulate border Total number of collisions to be placed in the interior of all time Do not select random but walk over array of events in stride steps h QA settings const char Legend entries for data from comparison histogram files const char Store histograms in output root Do not run but just create PDFs from input root files Set cut for Q Compute the efficiency including impure tracks with fake contamination Maxmimum X(~radius) for reconstructed track position to take into accound for resolution QA in cm&quot;) AddOption(resPrimaries</div></div>
<div class="ttc" id="classfloat_html"><div class="ttname"><a href="../../d4/dc3/classfloat.html">float</a></div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackParamMFT_html_aa4680f6d41dd79ffe669e0f1dcc2d1f7"><div class="ttname"><a href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#aa4680f6d41dd79ffe669e0f1dcc2d1f7">o2::mft::TrackParamMFT::getY</a></div><div class="ttdeci">Double_t getY() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5b/TrackParamMFT_8h_source.html#l00052">TrackParamMFT.h:52</a></div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackExtrap_html_a17d52e75c547fb0581cf87a4026e92d2"><div class="ttname"><a href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#a17d52e75c547fb0581cf87a4026e92d2">o2::mft::TrackExtrap::linearExtrapToZ</a></div><div class="ttdeci">void linearExtrapToZ(TrackParamMFT *TrackParamMFT, double zEnd)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db2/ITSMFT_2MFT_2tracking_2src_2TrackExtrap_8cxx_source.html#l00035">TrackExtrap.cxx:35</a></div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackParamMFT_html_af06a7cd0f8f0d98a20e6249e8e803e35"><div class="ttname"><a href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#af06a7cd0f8f0d98a20e6249e8e803e35">o2::mft::TrackParamMFT::getInvQPt</a></div><div class="ttdeci">Double_t getInvQPt() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5b/TrackParamMFT_8h_source.html#l00062">TrackParamMFT.h:62</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a98ac434677655cc8438bb72de2719f39"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a98ac434677655cc8438bb72de2719f39">x0</a></div><div class="ttdeci">GLuint GLfloat x0</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l05034">glcorearb.h:5034</a></div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackExtrap_html_ad323a4841ccfe7e34e8b6cacf875d5c9"><div class="ttname"><a href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#ad323a4841ccfe7e34e8b6cacf875d5c9">o2::mft::TrackExtrap::getSignBz</a></div><div class="ttdeci">const int getSignBz() const</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d52/ITSMFT_2MFT_2tracking_2include_2MFTTracking_2TrackExtrap_8h_source.html#l00046">TrackExtrap.h:46</a></div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackParamMFT_html_a014e53ae748a2fff7e86247343ebf902"><div class="ttname"><a href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a014e53ae748a2fff7e86247343ebf902">o2::mft::TrackParamMFT::getTanl</a></div><div class="ttdeci">Double_t getTanl() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5b/TrackParamMFT_8h_source.html#l00059">TrackParamMFT.h:59</a></div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackParamMFT_html_aec47abdb398b20c51bea04d084af6d9b"><div class="ttname"><a href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#aec47abdb398b20c51bea04d084af6d9b">o2::mft::TrackParamMFT::setPhi</a></div><div class="ttdeci">void setPhi(Double_t phi)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5b/TrackParamMFT_8h_source.html#l00055">TrackParamMFT.h:55</a></div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackExtrap_html_a7394d9bdeb7de7379de3f938e1d36ea9"><div class="ttname"><a href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#a7394d9bdeb7de7379de3f938e1d36ea9">o2::mft::TrackExtrap::addMCSEffect</a></div><div class="ttdeci">void addMCSEffect(TrackParamMFT *TrackParamMFT, double dZ, double x0, bool isFieldON=true)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db2/ITSMFT_2MFT_2tracking_2src_2TrackExtrap_8cxx_source.html#l00321">TrackExtrap.cxx:321</a></div></div>
<div class="ttc" id="namespaceo2_1_1framework_html_ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215"><div class="ttname"><a href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739abefe0c00d6dfe8c719309ff450205215">o2::framework::Abs</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dc2/BasicOps_8h_source.html#l00031">BasicOps.h:31</a></div></div>
<div class="ttc" id="namespaceo2_1_1mft_html_a184dac7fced8f4d6c3a220982569e3dfa0d0670aa035bffdac2d0600106e9b5b8"><div class="ttname"><a href="../../d4/d8c/namespaceo2_1_1mft.html#a184dac7fced8f4d6c3a220982569e3dfa0d0670aa035bffdac2d0600106e9b5b8">o2::mft::Quadratic</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d87/MFTTrackingParam_8h_source.html#l00032">MFTTrackingParam.h:32</a></div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackParamMFT_html_a3be0f51077942099d99d3c6d9d856498"><div class="ttname"><a href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a3be0f51077942099d99d3c6d9d856498">o2::mft::TrackParamMFT::updatePropagator</a></div><div class="ttdeci">void updatePropagator(const TMatrixD &amp;propagator)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da7/TrackParamMFT_8cxx_source.html#l00206">TrackParamMFT.cxx:206</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a0cdec8e97a75ee9458b23d152bf962d4"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a></div><div class="ttdeci">GLint GLenum GLint x</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00403">glcorearb.h:403</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a74d80fd479c0f6d0153c709949a089ef"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a74d80fd479c0f6d0153c709949a089ef">y</a></div><div class="ttdeci">GLint y</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00270">glcorearb.h:270</a></div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackParamMFT_html_a4aa4b60b06c66f033aa59a17ec34a485"><div class="ttname"><a href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a4aa4b60b06c66f033aa59a17ec34a485">o2::mft::TrackParamMFT::getZ</a></div><div class="ttdeci">Double_t getZ() const</div><div class="ttdoc">return Z coordinate (cm) </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5b/TrackParamMFT_8h_source.html#l00046">TrackParamMFT.h:46</a></div></div>
<div class="ttc" id="namespaceo2_1_1framework_html_ac2569e9658701f4fc5b687da9dacb739ae557705aebad579817e10aa4fdcfaa00"><div class="ttname"><a href="../../dd/d8d/namespaceo2_1_1framework.html#ac2569e9658701f4fc5b687da9dacb739ae557705aebad579817e10aa4fdcfaa00">o2::framework::Log</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dc2/BasicOps_8h_source.html#l00029">BasicOps.h:29</a></div></div>
<div class="ttc" id="namespaceo2_1_1constants_1_1math_html_a2b949225a2d77538706c290b9c07ae8e"><div class="ttname"><a href="../../d2/d3a/namespaceo2_1_1constants_1_1math.html#a2b949225a2d77538706c290b9c07ae8e">o2::constants::math::B2C</a></div><div class="ttdeci">constexpr float B2C</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d84/MathConstants_8h_source.html#l00039">MathConstants.h:39</a></div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackExtrap_html_ac5c644732bfa0687e4b7559d898fa210"><div class="ttname"><a href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#ac5c644732bfa0687e4b7559d898fa210">o2::mft::TrackExtrap::linearExtrapToZCov</a></div><div class="ttdeci">void linearExtrapToZCov(TrackParamMFT *TrackParamMFT, double zEnd, bool updatePropagator)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db2/ITSMFT_2MFT_2tracking_2src_2TrackExtrap_8cxx_source.html#l00054">TrackExtrap.cxx:54</a></div></div>
<div class="ttc" id="TrackParamMFT_8h_html"><div class="ttname"><a href="../../d3/d5b/TrackParamMFT_8h.html">TrackParamMFT.h</a></div><div class="ttdoc">Definition of the MFT track parameters for internal use. </div></div>
<div class="ttc" id="classo2_1_1conf_1_1ConfigurableParamHelper_html_acd640717f419212c67fecff71d876d39"><div class="ttname"><a href="../../d7/d50/classo2_1_1conf_1_1ConfigurableParamHelper.html#acd640717f419212c67fecff71d876d39">o2::conf::ConfigurableParamHelper&lt; MFTTrackingParam &gt;::Instance</a></div><div class="ttdeci">static const MFTTrackingParam &amp; Instance()</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d6b/ConfigurableParamHelper_8h_source.html#l00073">ConfigurableParamHelper.h:73</a></div></div>
<div class="ttc" id="GPUReconstructionKernels_8h_html_ab0127665b2e65e79a1e2523951eb0dbd"><div class="ttname"><a href="../../d4/d54/GPUReconstructionKernels_8h.html#ab0127665b2e65e79a1e2523951eb0dbd">N</a></div><div class="ttdeci">unsigned long size int mode int iSlice int iSlice char nOutput int int char useOrigTrackParam int char char mergeMode int N</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d54/GPUReconstructionKernels_8h_source.html#l00046">GPUReconstructionKernels.h:46</a></div></div>
<div class="ttc" id="MathConstants_8h_html"><div class="ttname"><a href="../../d6/d84/MathConstants_8h.html">MathConstants.h</a></div><div class="ttdoc">useful math constants </div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackParamMFT_html_a3abfafea775118fac5adef2e227ba10b"><div class="ttname"><a href="../../d5/d4f/classo2_1_1mft_1_1TrackParamMFT.html#a3abfafea775118fac5adef2e227ba10b">o2::mft::TrackParamMFT::getInverseMomentum</a></div><div class="ttdeci">Double_t getInverseMomentum() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5b/TrackParamMFT_8h_source.html#l00076">TrackParamMFT.h:76</a></div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackExtrap_html_a9c3d4f1fc76dd3037ee87d6db2262dc5"><div class="ttname"><a href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#a9c3d4f1fc76dd3037ee87d6db2262dc5">o2::mft::TrackExtrap::helixExtrapToZ</a></div><div class="ttdeci">void helixExtrapToZ(TrackParamMFT *TrackParamMFT, double zEnd)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db2/ITSMFT_2MFT_2tracking_2src_2TrackExtrap_8cxx_source.html#l00134">TrackExtrap.cxx:134</a></div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackExtrap_html_aebaa710c219e74e0a1ec505cd5252fd4"><div class="ttname"><a href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#aebaa710c219e74e0a1ec505cd5252fd4">o2::mft::TrackExtrap::quadraticExtrapToZ</a></div><div class="ttdeci">void quadraticExtrapToZ(TrackParamMFT *TrackParamMFT, double zEnd)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db2/ITSMFT_2MFT_2tracking_2src_2TrackExtrap_8cxx_source.html#l00097">TrackExtrap.cxx:97</a></div></div>
<div class="ttc" id="classo2_1_1mft_1_1TrackExtrap_html_ae2324f77141cbcc30a8e023a3a7f1313"><div class="ttname"><a href="../../d8/d57/classo2_1_1mft_1_1TrackExtrap.html#ae2324f77141cbcc30a8e023a3a7f1313">o2::mft::TrackExtrap::quadraticExtrapToZCov</a></div><div class="ttdeci">void quadraticExtrapToZCov(TrackParamMFT *TrackParamMFT, double zEnd, bool updatePropagator)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db2/ITSMFT_2MFT_2tracking_2src_2TrackExtrap_8cxx_source.html#l00173">TrackExtrap.cxx:173</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_051dca18e802f8e9474f2e30d29c04e0.html">Detectors</a></li><li class="navelem"><a class="el" href="../../dir_1306292b77b40360479b729ac9ee7efe.html">ITSMFT</a></li><li class="navelem"><a class="el" href="../../dir_f39d1cd569ca2d16022b762a0e4a53c8.html">MFT</a></li><li class="navelem"><a class="el" href="../../dir_0a8d7fd788ce6274650fdef0765535ce.html">tracking</a></li><li class="navelem"><a class="el" href="../../dir_119633d0a87109267c245d44b982fe38.html">src</a></li><li class="navelem"><a class="el" href="../../d9/db2/ITSMFT_2MFT_2tracking_2src_2TrackExtrap_8cxx.html">TrackExtrap.cxx</a></li>
    <li class="footer">Generated on Thu Jun 4 2020 09:30:29 for Project by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
